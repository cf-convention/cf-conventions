<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      #142 (Coordinate Type: Ensemble)
     – CF Metadata
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="/trac/search" />
        <link rel="prev" href="./141.html" title="ticket #141" />
        <link rel="last" href="./176.html" title="ticket #176" />
        <link rel="help" href="/trac/wiki/TracGuide" />
        <link rel="alternate" href="./142?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" /><link rel="alternate" href="./142?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="./142?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" />
        <link rel="next" href="./143.html" title="ticket #143" />
        <link rel="start" href="/trac/wiki" />
        <link rel="stylesheet" href="/trac/chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="/trac/chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="./1.html" title="ticket #1" />
        <link rel="shortcut icon" href="/trac/chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="/trac/chrome/common/trac.ico" type="image/x-icon" />
    <style id="trac-noscript" type="text/css">.trac-noscript { display: none !important }</style>
      <link type="application/opensearchdescription+xml" rel="search" href="/trac/search/opensearch" title="Search CF Metadata" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="b8aeac20bf7fd49b63339caa";
      var comments_prefs={"comments_only":"false","comments_order":"oldest"};
    </script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/folding.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/wikitoolbar.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/resizer.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/auto_preview.js"></script>
    <script type="text/javascript">
      jQuery("#trac-noscript").remove();
      jQuery(document).ready(function($) {
        $(".trac-autofocus").focus();
        $(".trac-target-new").attr("target", "_blank");
        setTimeout(function() { $(".trac-scroll").scrollToTop() }, 1);
        $(".trac-disable-on-submit").disableOnSubmit();
      });
    </script>
    <script type="text/javascript" src="/trac/chrome/common/js/threaded_comments.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
      /*<![CDATA[*/
        $("#attachments").toggleClass("collapsed");
        $("#trac-up-attachments").click(function () {
          $("#attachments").removeClass("collapsed");
          return true;
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
        function setRevertHandler() {
          $("button.trac-revert").click(function() {
            var div = $("div", this);
            var field_name = div[0].id.substr(7);
            var field_value = div.text();
            var input = $("#propertyform *[name=field_" + field_name + "]");
            if (input.length > 0) {
              if (input.filter("input[type=radio]").length > 0) {
                input.val([field_value]);
              } else if (input.filter("input[type=checkbox]").length > 0) {
                input.val(field_value == "1" ? [field_value] : []);
              } else {
                input.val(field_value);
              }
            } else { // Special case for CC checkbox
              input = $("#propertyform input[name=cc_update]").val([]);
            }
            input.change();
            $(this).closest("li").remove();
            return false;
          });
        }
        setRevertHandler();
        var comment_focused = false;
        $("#comment").focus(function() { comment_focused = true; })
                     .blur(function() { comment_focused = false; });
        $("#propertyform").autoSubmit({preview: '1'}, function(data, reply) {
          var items = $(reply);
          // Update ticket box
          $("#ticket").replaceWith(items.filter('#ticket'));
          // Update changelog with original order
          $("#changelog").replaceWith(items.filter("#changelog"));
          // Reorder comments
          applyCommentsOrder(
            $('#prefs input[name="trac-comments-order"]:checked').val());
          // Show warning
          var new_changes = $("#changelog .trac-new");
          $("#trac-edit-warning").toggle(new_changes.length != 0);
          if (new_changes.length != 0)
            $("#changelog").parent().show().removeClass("collapsed");
          // Update view time
          $("#propertyform input[name='view_time']").replaceWith(items.filter("input[name='view_time']"));
          // Update preview
          var preview = $("#ticketchange").html(items.filter('#preview').children());
          var show_preview = preview.children().length != 0;
          $("#ticketchange").toggle(show_preview);
          setRevertHandler();
          // Collapse property form if comment editor has focus
          if (show_preview && comment_focused)
            $("#modify").parent().addClass("collapsed");
          // Execute scripts to load stylesheets
          items.filter("script").appendTo("head");
        }, "#ticketchange .trac-loading");
        $("#trac-comment-editor").autoSubmit({preview_comment: '1'}, function(data, reply) {
          var comment = $("#trac-comment-editor").next("div.comment").html(reply);
          comment.toggle(comment.children().length != 0);
        }, "#changelog .trac-loading");
        /*]]>*/
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://cf-trac.llnl.gov/trac"><img src="/trac/chrome/site/cf_logo.png" alt="CF Metadata Trac" height="80" width="400" /></a>
      </div>
      <form id="search" action="/trac/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="/trac/login">Login</a></li><li><a href="/trac/about">About Trac</a></li><li><a href="/trac/prefs">Preferences</a></li><li class="last"><a href="/trac/wiki/TracGuide">Help/Guide</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="/trac/query">View Tickets</a></li><li><a href="/trac/roadmap">Roadmap</a></li><li><a href="/trac/timeline">Timeline</a></li><li><a href="/trac/search">Search</a></li><li class="last"><a href="/trac/wiki">Wiki</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
        <ul>
          <li class="first"><span>&larr; <a class="prev" href="./141.html" title="ticket #141">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="./143.html" title="ticket #143">Next Ticket</a> &rarr;</span></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
        <div id="ticket" class="trac-content ">
  <div class="date">
    <p>Opened <a class="timeline" href="/trac/timeline?from=2015-08-17T06%3A28%3A47-07%3A00&amp;precision=second" title="See timeline at 08/17/15 06:28:47">6 years ago</a></p>
    <p>Last modified <a class="timeline" href="/trac/timeline?from=2016-03-09T10%3A25%3A28-08%3A00&amp;precision=second" title="See timeline at 03/09/16 10:25:28">5 years ago</a></p>
  </div>
  <h2>
    <a href="./142.html" class="trac-id">#142</a>
    <span class="trac-status">
      <a href="/trac/query?status=new">new</a>
    </span>
    <span class="trac-type">
      <a href="/trac/query?status=!closed&amp;type=enhancement">enhancement</a>
    </span>
  </h2>
  <h1 id="trac-ticket-title" class="searchable">
    <span class="summary">Coordinate Type: Ensemble</span>
  </h1>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable"><a href="/trac/query?status=!closed&amp;reporter=markh">markh</a></td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">cf-conventions@…</td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="/trac/query?status=!closed&amp;priority=medium">medium</a>
        </td>
        <th id="h_milestone" class="missing">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="missing milestone"></a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="/trac/query?status=!closed&amp;component=cf-conventions">cf-conventions</a>
        </td>
        <th id="h_version" class="missing">
          Version:
        </th>
        <td headers="h_version">
              <a href="/trac/query?status=!closed&amp;version="></a>
        </td>
    </tr><tr>
        <th id="h_keywords" class="missing">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
        <th id="h_cc" class="missing">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <a href="./142?action=diff&amp;version=43" class="lastmod trac-diff" title="2016-02-18 15:25:01.809349+00:00">
        (last modified by markh)
      </a>
    </h3>
    <div class="searchable">
      <h2 id="a1.Title">1. Title</h2>
<blockquote>
<p>
Ensemble Coordinates 
</p>
</blockquote>
<h2 id="a2.Moderator">2. Moderator</h2>
<blockquote>
<p>
TBC 
</p>
</blockquote>
<h2 id="a3.Requirement">3. Requirement</h2>
<blockquote>
<p>
The description of the dimension of a data variable which describes an ensemble of forecasts may involve a number of elements of metadata.
</p>
</blockquote>
<blockquote>
<p>
Coordinate variables and auxiliary coordinates describing an ensemble need to be able to be labelled as such.
</p>
</blockquote>
<blockquote>
<p>
It is useful to encapsulate information about the nature of the ensemble with the coordinate.  Current use cases for metadata standardisation are: the original size of the ensemble; the single-model or multi-model nature of the ensemble, the presence of an explicit control forecast as realization=0.
</p>
</blockquote>
<h2 id="a4.TechnicalProposal">4. Technical Proposal</h2>
<h4 id="a4.CoordinateTypes">4. Coordinate Types</h4>
<blockquote>
<p>
... The attribute axis may be attached to a coordinate variable <strong>or auxiliary coordinate variable</strong> and given one of the values X, Y, Z<strong>,</strong> <del>or</del> T <strong>. These labels</strong> <del>which</del> stand for a longitude, latitude, vertical, <del>or</del> time <strong>or ensemble</strong> axis respectively. ...
</p>
</blockquote>
<h4 id="a4.6EnsembleCoordinate">4.6 Ensemble Coordinate</h4>
<blockquote>
<p>
Variables representing an ensemble or collection of realizations shall have an attribute <tt>axis</tt> with a value <tt>E</tt>.  These variables are discrete, as described in section 4.5;  they do not represent continuous quantities. 
</p>
</blockquote>
<blockquote>
<p>
Ensemble variables have a number of optional standardised attributes available for use.
</p>
</blockquote>
<blockquote>
<p>
A data variable representing an ensemble will commonly have an ensemble coordinate with the standard name <tt>realization</tt>; this is not mandatory. The <tt>realization</tt> standard name is used to provide a unique identifying number to each ensemble member within the ensemble.
</p>
</blockquote>
<blockquote>
<p>
An ensemble coordinate providing a string label for each ensemble member within the ensemble may also be included, using the standard name <tt>ensemble_member_label</tt>.  An <tt>ensemble_member_label</tt> coordinate shall have unique values and missing values are not allowed.
</p>
</blockquote>
<blockquote>
<p>
An ensemble coordinate with the standard name <tt>realization</tt> or <tt>ensemble_member_label</tt> may include an attribute named <tt>ensemble_control_member</tt>.
</p>
</blockquote>
<blockquote>
<p>
This value provides a definition that one member of the ensemble is the control member and identifies this member.  This control member shall have the identified value within the ensemble coordinate's data.
</p>
</blockquote>
<blockquote>
<p>
The absence of this attribute shall be interpreted as a negative statement, explicitly stating that there is no control member identified within the ensemble: all members have equal status, no control member existed in the ensemble.
</p>
</blockquote>
<blockquote>
<p>
An ensemble coordinate may be identified as being from one model or multiple models by providing further variables identified as coordinates or auxiliary coordinates by the data variable.  All of these coordinates shall have an attribute <tt>axis</tt> with a value <tt>E</tt>.
</p>
</blockquote>
<blockquote>
<p>
The standard name's <tt>source</tt> and <tt>institution</tt> are used to identify the multiplicity of models which the ensemble is taken from, one other or both may be present.
</p>
</blockquote>
<blockquote>
<p>
Such coordinates may be scalar coordinate variables or they may be attached to the same dimension(s) as other ensemble coordinates referenced by a data variable.  Scalar coordinates are commonly used to define a single model ensemble; in this case, this is informationally equivalent to auxiliary coordinates with identical values.
</p>
</blockquote>
<blockquote>
<p>
The absence of such <tt>source</tt> and <tt>institution</tt> coordinates shall not be interpreted as a positive or negative statement.  No inference on the multiplicity of models which the ensemble is taken from shall be inferred from the absence of such coordinates.
</p>
</blockquote>
<h4 id="AppendixA">Appendix A</h4>
<blockquote>
<p>
| <strong><tt>ensemble_control_member</tt></strong> | D | C | ref:&lt;&lt;ensemble-coordinate&gt;&gt; | The identifier of the member of the ensemble which is the control member. |
</p>
</blockquote>
<h4 id="ConformanceDocument">Conformance Document</h4>
<h4 id="a4CoordinateTypes">4 Coordinate Types</h4>
<h5 id="Requirements:">Requirements:</h5>
<ul><li>The axis attribute may <del>only</del> be attached to a coordinate variable <strong>or auxiliary coordinate variable only</strong>.
</li><li>The only legal values of axis are X, Y, Z, <del>and</del> T<strong> and E</strong> (case insensitive).
</li><li>The axis attribute must be consistent with the coordinate type deduced from units and positive.
</li><li><del>The axis attribute is not allowed for auxiliary coordinate variables.</del>
</li><li><del>A data variable must not have more than one coordinate variable with a particular value of the axis attribute.</del>
</li></ul><h5 id="a4.6.2EnsembleControlMember">4.6.2  Ensemble Control Member ====</h5>
<h5 id="Requirements">Requirements</h5>
<ul><li>A variable may have an attribute <tt>ensemble_control_member</tt> only if it has an <tt>axis</tt> attribute of <tt>E</tt> and a standard_name of either <tt>realization</tt> or <tt>ensemble_member_label</tt>.
</li></ul><h2 id="a5.Benefits">5. Benefits</h2>
<blockquote>
<p>
Information regarding the nature of an ensemble is encoded in an ensemble coordinate, analogous to temporal coordinates.
</p>
</blockquote>
<blockquote>
<p>
Encoding of the presence of a control member and the single or multiple model nature of the ensemble is standardised. 
</p>
</blockquote>
<blockquote>
<p>
Future standardisation of ensemble characteristics has a model to follow.
</p>
</blockquote>
<h2 id="a6.StatusQuo">6. Status Quo</h2>
<blockquote>
<p>
At present there is no standardised way of capturing information or characteristics about an ensemble, all information is encoded ad hoc by data producers.
</p>
</blockquote>
<blockquote>
<p>
For example, the size of the ensemble can only be inferred from the length of a realization dimension.  If the ensemble is sliced, to leave only one member, the size of the ensemble is lost in the resulting data variable. This example is particularly problematic for conversion from CF to other data formats. 
</p>
</blockquote>

    </div>
  </div>
</div>
          

        <div>
          <div class="trac-noscript" style="position: relative">
            <form id="prefs" method="get" action="/trac/prefs" style="position: absolute; right: 0">
              <div id="trac-comments-order">
                <input type="radio" id="trac-comments-oldest" name="trac-comments-order" value="oldest" checked="checked" />
                <label for="trac-comments-oldest">Oldest first</label>
                <input type="radio" id="trac-comments-newest" name="trac-comments-order" value="newest" />
                <label for="trac-comments-newest">Newest first</label>
                <span id="trac-threaded-toggle" style="display: none">
                  <input type="radio" id="trac-comments-threaded" name="trac-comments-order" value="threaded" />
                  <label for="trac-comments-threaded">Threaded</label>
                </span>
              </div>
              <div>
                <input id="trac-comments-only-toggle" type="checkbox" />
                <label for="trac-comments-only-toggle">Comments only</label>
              </div>
            </form>
          </div>
          <h3 class="foldable">Change History <span class="trac-count">(48)</span></h3>
          <div id="changelog">
              <div class="change" id="trac-change-1-1439818346695826">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:1" class="cnum">
    <a href="#comment:1">comment:1</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-08-17T06%3A32%3A26-07%3A00&amp;precision=second" title="See timeline at 08/17/15 06:32:26">6 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
This ticket leads on from the mailing list discussion:
<a class="ext-link" href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2015/058424.html"><span class="icon">​</span>http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2015/058424.html</a>
and the 'next message (by thread)' postings
</p>
<p>
The historical discussion:
<a class="ext-link" href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2013/057010.html"><span class="icon">​</span>http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2013/057010.html</a>
and the 'next message (by thread)' postings
are also relevant
</p>

    </div>

              </div>
              <div class="change" id="trac-change-2-1439819357983513">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:2" class="cnum">
    <a href="#comment:2">comment:2</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-08-17T06%3A49%3A17-07%3A00&amp;precision=second" title="See timeline at 08/17/15 06:49:17">6 years ago</a> by mgschultz
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark,
</p>
<blockquote>
<p>
reads very well, I think. Only one suggestion: perhaps one should also try to standardize the "description" of the ensemble members? I guess, this would be a character variable with string length and ensemble size as dimensions. Would it make sense to suggest another optional attribute for the ensemble coordinate variable which points to this description variable?
</p>
</blockquote>
<p>
Best regards, Martin
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3-1439819377310745">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:3" class="cnum">
    <a href="#comment:3">comment:3</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-08-17T06%3A49%3A37-07%3A00&amp;precision=second" title="See timeline at 08/17/15 06:49:37">6 years ago</a> by mgschultz
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark,
</p>
<blockquote>
<p>
reads very well, I think. Only one suggestion: perhaps one should also try to standardize the "description" of the ensemble members? I guess, this would be a character variable with string length and ensemble size as dimensions. Would it make sense to suggest another optional attribute for the ensemble coordinate variable which points to this description variable?
</p>
</blockquote>
<p>
Best regards, Martin
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4-1439830291360277">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:4" class="cnum">
    <a href="#comment:4">comment:4</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:6" class="follow-up">↓ 6</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-08-17T09%3A51%3A31-07%3A00&amp;precision=second" title="See timeline at 08/17/15 09:51:31">6 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
Thanks for making this proposal. I didn't have the opportunity to comment in the email discussion because I was on holiday then.
</p>
<p>
I think you are right that ensemble axes need special recognition. We should also acknowledge that an ensemble axis is a special case of a discrete axis (CF sect 4.5). If we add a new section 4.6 for ensemble axes, that should be stated at the outset. Conversely, the ensemble axis should be added to the list of applications of discrete axes in sect 4.5.
</p>
<p>
When saying that an ensemble axis <em>must</em> have a standard name of <tt>realization</tt>, you are assuming it will have a coordinate variable. However, I don't think it needs to have one. The elements of an ensemble might be distinguished by a combination of auxiliary coordinate variables, and might not have any meaningful order, which is implied by a coordinate variable. However, I think it would be OK to say that a coordinate variable with a standard name of <tt>realization</tt> indicates it is an ensemble axis. I would say that units of 1 should not be required because dimensionless units are generally allowed not to be omitted. (Requiring them would be something for the "strict" variety of CF which has been proposed.) If there is no other standard name for an ensemble axis for the moment, then I don't think we need a value of the <tt>axis</tt> attribute, because the standard name alone will do the job of identifying it, and the <tt>axis</tt> is redundant. (This is a different situation from the spatial axes, which have various means of identification, inherited from COARDS, so the <tt>axis</tt> attribute is a useful extra clue.)
</p>
<p>
Apart from the realization number, ensemble members might be identified by string-valued auxiliary coordinate variables. It was proposed a long time ago, but not agreed, that we could introduce standard names of <tt>institution</tt> and <tt>source</tt> for such variables, with the same meanings as the attributes of those names. In the context of CMIP, <tt>experiment</tt> would also be a good standard name to have, while the realizations in CMIP are identified by strings e.g. <tt>r1i1p1</tt>, not numbers. Therefore it would be good to allow <tt>realization</tt> coordinates to be string-valued. I think it would be useful to say something about the use of auxiliary coordinate variables to describe ensemble members in this way.
</p>
<p>
About <tt>ensemble_size</tt>. In your ticket 108, we discussed a more general mechanism for recording the original size of a dimension in <tt>cell_methods</tt>, as Karl has reminded us on the email list. That ticket hasn't been concluded, and I guess you think <tt>cell_methods</tt> is inappropriate because you want the information to be recorded for subsetting as well as statistical operations. In the earlier discussion, I believe that your use-case for subsetting was the selection of a <em>single</em> ensemble member, which I thought could be regarded as a <tt>point</tt> cell method. Do you have a use-case for a selection of a subset of several ensemble members? Maybe that could be recorded as a cell method too. Consider a situation where you have 10 ensemble members, you select 5 of them, and then you compute the ensemble mean. I think that recording the size 5, which would naturally belong in cell methods, would be at least as useful as recording the original size 10. I wonder what you use the original ensemble size for? It also seems to me that any treatment of this kind could apply to any discrete axis, not just an ensemble axis.
</p>
<p>
The standard name of <tt>source</tt> would be appropriate for for a string_valued auxiliary coordinate variable that identifies the model (see CF sect 2.6.2). If we had that facility, I don't think you'd need the <tt>single_model_ensemble</tt> attribute. If they are all from the same model, it can be identified by a scalar coordinate of <tt>source</tt>; if they come from different models, there can be an auxiliary coordinate variable of <tt>source</tt> with the dimension of the ensemble size.
</p>
<p>
I haven't come across the idea behind the <tt>ensemble_control_member_0</tt> before. This sounds rather specific to a particular application. Is it in sufficiently widespread use that it requires a standard? What does the "control member" mean? In climate model ensembles that I deal with, all members are equivalent.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5-1439990438321369">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:5" class="cnum">
    <a href="#comment:5">comment:5</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-08-19T06%3A20%3A38-07%3A00&amp;precision=second" title="See timeline at 08/19/15 06:20:38">6 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
To meet my use cases I have focussed on numerical <tt>realization</tt> coordinates.
</p>
<p>
However, I have no particular focus on coordinate variables, this identification mechanism should work for auxiliary coordinates just as well.
</p>
<p>
It sounds like there is a desire to have a string based identification and perhaps derived identifiers from multiple sources.
These sound like valid use cases to me.
</p>
<p>
I suggest we generalise the proposal such that any coordinate can be used to describe an ensemble axis.
This would suggest the the standard_name <tt>realization</tt> is not a good way to identify this coordinate type.
</p>
<p>
The introduction to chapter 4 states:
<tt>The attribute axis may be attached to a coordinate variable and given one of the values X, Y, Z or T which stand for a longitude, latitude, vertical, or time axis respectively. </tt>
</p>
<p>
Would you like this to imply that <tt>axis</tt> should only be used on a coordinate variable?
(Appendix A does not place such a restriction)
(This is not part of the compliance check, afaics)
</p>
<p>
Would you like this to imply that a data variable will reference 1or0 coordinates with an <tt>axis</tt> attribute of a particular value, or would it be suitable to have a data variable referencing multiple coordinates
</p>
<p>
If neither of these restrictions apply, then we can add the 
<tt>axis = E</tt>
identifier to any coordinate or auxiliary coordinate variable and use this to handle ensemble coordinate typing.
</p>
<p>
this seems like a good solution to me
</p>
<p>
In light of this, I will reconsider the specification of a control member where the coordinate may not be numerical.
This is a required use case, and commonly delivered in WMO specific contexts for short range ensemble forecasts
</p>
<p>
Updates to follow
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6-1440764733285441">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:6" class="cnum">
    <a href="#comment:6">comment:6</a>
  </span>
        in reply to:
    <a href="#comment:4">↑ 4</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-08-28T05%3A25%3A33-07%3A00&amp;precision=second" title="See timeline at 08/28/15 05:25:33">6 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="./142#comment:4" title="Comment 4">jonathan</a>:
</p>
<blockquote class="citation">
<p>
In your ticket 108, we discussed a more general mechanism for recording the original size of a dimension in cell_methods, as Karl has reminded us on the email list. 
</p>
</blockquote>
<p>
<a class="new ticket" href="./108.html" title="enhancement: Defining a domain for a cell_method (new)">#108</a> is not aiming to store an original size; the intent of <a class="new ticket" href="./108.html" title="enhancement: Defining a domain for a cell_method (new)">#108</a> is to capture the domain, analogous to the 'interval' in cell_methods currently available, but in a richer fashion.  
In this scenario, the domain could store the realization numbers which were input to a statistical process, but this may not be the original size.
</p>
<p>
THese two pieces of information are independent.  
</p>
<p>
I may want to support a work flow which subsets 15 realisations out of the original 19, then calculates the mean and standard deviation of the remaining realisations.
</p>
<p>
In order to output this comprehensively, I would like to state that this is a mean of realisations (0,2,3,4,.....) from an ensemble originally formed of 19 members
</p>
<blockquote class="citation">
<p>
That ticket hasn't been concluded, and I guess you think cell_methods is inappropriate because you want the information to be recorded for subsetting as well as statistical operations.
</p>
</blockquote>
<p>
This is the case.  More generally, the ensemble size is information about the coordinate, not about the data variable directly, and not about statitics calculated over the ensemble dimension, so cell_methods appears to me to be the wrong place to store this information.
</p>
<p>
I am more comfortable looking for analogies with space and time coordinates, such as calendar definitions for ways to define this metadata in a controlled manner.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7-1440780784562068">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:7" class="cnum">
    <a href="#comment:7">comment:7</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:8" class="follow-up">↓ 8</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-08-28T09%3A53%3A04-07%3A00&amp;precision=second" title="See timeline at 08/28/15 09:53:04">6 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
Yes, I agree that <tt>axis="E"</tt> would a better way to identify an ensemble axis than depending on a particular standard name. As originally introduced, the axis attribute was intended for coordinate variables, not auxiliary coordinate variables, but we've agreed a ticket which allows it for aux coord vars too. As you say, <tt>axis="E"</tt> could be attached to any of the aux coord vars, or the coord var (if there is one), of an ensemble axis.
</p>
<blockquote class="citation">
<blockquote>
<p>
I may want to support a work flow which subsets 15 realisations out of the original 19, then calculates the mean and standard deviation of the remaining realisations. In order to output this comprehensively, I would like to state that this is a mean of realisations (0,2,3,4,.....) from an ensemble originally formed of 19 members 
</p>
</blockquote>
</blockquote>
<p>
OK. I too am more comfortable looking for analogies with spatiotemporal coordinates, and you can imagine that there might be need to record the original dimension of other axes before a selection was made. Therefore I think it would be good to use an attribute which didn't say "ensemble" in its name.
</p>
<p>
Although I appreciate this doesn't feel quite like cell methods, there <em>is</em> an relationship, I suggest, since cell methods has the idea that each cell represents variation within itself, and therefore allows the original spacing of the data to be recorded. By an extension, you could regard a selection of the points along an axis as an operation e.g. a <tt>sample</tt> operation, which maps the original full range of variation into a smaller number of cells. Then you put e.g. <tt>cell_methods="ensemble: sample (dimension: original_ensemble) ensemble: mean"</tt>. This would use a new cell method, instead of a new attribute. In your case, dimension <tt>ensemble=15</tt> and <tt>original_ensemble=19</tt>.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8-1440921650850290">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:8" class="cnum">
    <a href="#comment:8">comment:8</a>
  </span>
        in reply to:
    <a href="#comment:7">↑ 7</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-08-30T01%3A00%3A50-07%3A00&amp;precision=second" title="See timeline at 08/30/15 01:00:50">6 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Correction to my last posting. I didn't get the final paragraph quite right. In your example, the ensemble originally had 19 members, of which you selected a subset of 15, and then you computed e.g. the mean of them. So finally the ensemble axis has size 1, because it's been collapsed, but you may want to record the size it had before collapse, and before sampling. This could be done by using <tt>cell_methods</tt> to list these as consecutive operations, with an extension to record the dimension before each one: <tt>cell_methods="ensemble: sample (dimension: full_ensemble) ensemble: mean (dimension: sub_ensemble)"</tt>, where dimensions <tt>full_ensemble=19</tt>, <tt>sub_ensemble=15</tt> and <tt>ensemble=1</tt>.
</p>
<p>
Cheers, Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9-1443083311011080">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:9" class="cnum">
    <a href="#comment:9">comment:9</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-09-24T01%3A28%3A31-07%3A00&amp;precision=second" title="See timeline at 09/24/15 01:28:31">6 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-description">
      <strong class="trac-field-description">Description</strong>
        modified (<a href="./142?action=diff&amp;version=9">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      <p>
It looks from the comments like we are in agreement about the use of axis=E to define that a coordinate is an ensemble coordinate.  It also looks like there are good reasons not to rely on a standard name.
</p>
<p>
I am  updating the summary to reflect this.
</p>
<p>
There is still discussion about how to capture associated metadata, further consideration is needed on this aspect.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10-1445349524213459">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:10" class="cnum">
    <a href="#comment:10">comment:10</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-10-20T06%3A58%3A44-07%3A00&amp;precision=second" title="See timeline at 10/20/15 06:58:44">6 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
The outstanding question of how to capture coordinate level metadata is still outstanding.
</p>
<p>
regarding 'size of ensemble':
</p>
<ul><li>Jonathan has pointed highlighted that it is plausible to address this as an extension to cell methods.
</li><li>I have pointed proposed that this is captured as a an attribute on an ensemble coordinate
</li></ul><p>
Both of these appear reasonable interpretations
</p>
<p>
The other two use cases I have to address to meet my uers' needs are:
</p>
<ul><li>single model ensemble (boolean)
</li><li>ensemble control member (value)
</li></ul><p>
Neither of these elements seem to fit the Cell Methods paradigm at all well.  
</p>
<p>
With this in mind I think it is preferable to encapsulate all the ensemble coordinate metadata as named attributes on the ensemble coordinate, rather than extending cell methods to meet this use case and still requiring extra attributes.
</p>
<p>
Please may people share thoughts on why there is benefit in extending cell methods to enable 'original ensemble size' to be encoded there, when it is still necessary to define new limited scope attributes to address the use cases I have provided?
</p>
<p>
If we do not identify strong benefit from the cell methods approach, I think we should use defined name attributes for all these cases.
</p>
<p>
thank you
mark
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11-1445542823283081">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:11" class="cnum">
    <a href="#comment:11">comment:11</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-10-22T12%3A40%3A23-07%3A00&amp;precision=second" title="See timeline at 10/22/15 12:40:23">6 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
Thanks for your posting. I would say that <tt>cell_methods</tt> offers  fairly natural way to encode <em>more</em> useful information than a simple attribute for the original ensemble size would do (as in my example above), and that there's no need to link this to your other two proposals, which don't belong in <tt>cell_methods</tt>, I agree. I commented above on these other two issues.
</p>
<p>
Rather than a new <tt>single_model_ensemble</tt> attribute, the <tt>source</tt> attribute could be used to identify the model. If there is just one model, there's just one word. If the ensemble has several models, it would be a list of words. Alternatively, you could have a string-valued auxiliary coordinate variable to record the model for each ensemble member.
</p>
<p>
I haven't come across the idea behind the <tt>ensemble_control_member_0</tt> before. What does the "control member" mean? In climate model ensembles that I deal with, all members are equivalent. You mention that it is used in WMO contexts. Please could you give an example to illustrate the use case?
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12-1446117966213451">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:12" class="cnum">
    <a href="#comment:12">comment:12</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-10-29T04%3A26%3A06-07%3A00&amp;precision=second" title="See timeline at 10/29/15 04:26:06">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
An ensemble control member is a deterministic forecast within the ensemble.  There are no perturbations or stochastic physics applied to this member.  It is generally stable through the development of the ensemble configuration.
</p>
<p>
Numerous models make a scientific decision to provide a control member as a distinct member of the ensemble, in these cases there is value in explicitly identifying this member.  It is a member of the ensemble, it is not separate from it.
</p>
<p>
The Met Office GloSea ensemble makes a scientific decision not to have a control member, all members within the ensemble are perturbed, there is no control.
</p>
<p>
Other models contributing to the ECMWF S2S project
<a class="ext-link" href="https://software.ecmwf.int/wiki/display/S2S/"><span class="icon">​</span>https://software.ecmwf.int/wiki/display/S2S/</a>
explicitly include a control member and label that member as the control as part of their data submission.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13-1446118006745191">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:13" class="cnum">
    <a href="#comment:13">comment:13</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-10-29T04%3A26%3A46-07%3A00&amp;precision=second" title="See timeline at 10/29/15 04:26:46">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-description">
      <strong class="trac-field-description">Description</strong>
        modified (<a href="./142?action=diff&amp;version=13">diff</a>)
    </li>
  </ul>

              </div>
              <div class="change" id="trac-change-14-1446136791975783">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:14" class="cnum">
    <a href="#comment:14">comment:14</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:15" class="follow-up">↓ 15</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-10-29T09%3A39%3A51-07%3A00&amp;precision=second" title="See timeline at 10/29/15 09:39:51">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
OK, I understand about the ensemble control member. Thanks. That information about its purpose would be useful to include in your next. I think the <tt>ensemble_control_member</tt> attribute should be allowed only if <tt>axis="E"</tt> is present.  How is the member identified? For instance, is it an index within the ensemble dimension?
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-15-1446561297822779">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:15" class="cnum">
    <a href="#comment:15">comment:15</a>
  </span>
        in reply to:
    <a href="#comment:14">↑ 14</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-11-03T06%3A34%3A57-08%3A00&amp;precision=second" title="See timeline at 11/03/15 06:34:57">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="./142#comment:14" title="Comment 14">jonathan</a>:
</p>
<blockquote class="citation">
<p>
I think the <tt>ensemble_control_member</tt> attribute should be allowed only if <tt>axis="E"</tt> is present.  
</p>
</blockquote>
<p>
I agree, this attribute is only valid if for a variable with <tt>axis="E"</tt> set.
</p>
<blockquote class="citation">
<p>
How is the member identified? For instance, is it an index within the ensemble dimension?
</p>
</blockquote>
<p>
I propose the value of the coordinate which identifies the control is the value of the attribute.  So, if there is a coordinate where the control member is identified by a realization value of zero, the coordinate would be:
</p>
<pre class="wiki">int realization(realization) ;
    realization:axis = "E" ;
    realization:ensemble_control_member = 0 ;
</pre>
    </div>

              </div>
              <div class="change" id="trac-change-16-1446568252291400">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:16" class="cnum">
    <a href="#comment:16">comment:16</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:17" class="follow-up">↓ 17</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-11-03T08%3A30%3A52-08%3A00&amp;precision=second" title="See timeline at 11/03/15 08:30:52">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
As I mentioned above, realizations might be identified by strings (as in CMIP) rather than numbers, which means that we couldn't specify the data type of <tt>ensemble_control_member</tt>. However, if it were an index within the ensemble dimension, it would definitely be a number.
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-17-1446724359797672">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:17" class="cnum">
    <a href="#comment:17">comment:17</a>
  </span>
        in reply to:
    <a href="#comment:16">↑ 16</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-11-05T03%3A52%3A39-08%3A00&amp;precision=second" title="See timeline at 11/05/15 03:52:39">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="./142#comment:16" title="Comment 16">jonathan</a>:
</p>
<blockquote class="citation">
<p>
As I mentioned above, realizations might be identified by strings (as in CMIP) rather than numbers, which means that we couldn't specify the data type of <tt>ensemble_control_member</tt>. However, if it were an index within the ensemble dimension, it would definitely be a number.
</p>
</blockquote>
<p>
The data type of the attribute shall be consistent with the data type of the coordinate it is attached to.
</p>
<p>
Specifying the index is troublesome, as any change to the coordinate, in order, by subseting, or anything similar breaks the link
</p>
<p>
This approach is too fragile, in my view.  Specifying the coordinate's value is safer.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-18-1447093798827531">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:18" class="cnum">
    <a href="#comment:18">comment:18</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:19" class="follow-up">↓ 19</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-11-09T10%3A29%3A58-08%3A00&amp;precision=second" title="See timeline at 11/09/15 10:29:58">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
Most CF attributes have a defined data type (string or numeric), though there are a few whose type depends on the variable viz. <tt>_FillValue</tt>, <tt>missing_value</tt>, <tt>flag_masks</tt>, <tt>flag_values</tt>. I agree that what you suggest would work, since the purpose of the attribute is to compare with the values in the variable to find the one which matches.
</p>
<p>
Another possibility occurs to me, which would avoid defining an attribute altogether - I'm sure you've noticed I tend to prefer not to define new machinery if we can make use of something we have! You could define a standard name such as <tt>ensemble_control_binary_mask</tt>, for an auxiliary coordinate variable which is 1 for the ensemble control member and 0 for the others. This would be perhaps even more robust, because it would survive subsetting and permutation of the ensemble axis, since all auxiliary coordinate variables have to be transformed consistently by such operations. If you deleted the ensemble control member from the ensemble, you would not have to remember to zap the attribute, since the 1 element would vanish from the mask at the same time.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-19-1447175223791686">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:19" class="cnum">
    <a href="#comment:19">comment:19</a>
  </span>
        in reply to:
    <a href="#comment:18">↑ 18</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-11-10T09%3A07%3A03-08%3A00&amp;precision=second" title="See timeline at 11/10/15 09:07:03">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="./142#comment:18" title="Comment 18">jonathan</a>:
</p>
<blockquote class="citation">
<p>
Another possibility occurs to me, which would avoid defining an attribute altogether - I'm sure you've noticed I tend to prefer not to define new machinery if we can make use of something we have! You could define a standard name such as <tt>ensemble_control_binary_mask</tt>, for an auxiliary coordinate variable which is 1 for the ensemble control member and 0 for the others. 
</p>
</blockquote>
<p>
I can see what you are suggesting here and I can see that it would be functional.
</p>
<p>
I find the approach less clear than defining a particular coordinate value for the variable to provide this labelling function.
I do not consider the 'control member' to be a masking operation, this seems like an odd fit to me.
</p>
<blockquote class="citation">
<p>
This would be perhaps even more robust, because it would survive subsetting and permutation of the ensemble axis, since all auxiliary coordinate variables have to be transformed consistently by such operations. If you deleted the ensemble control member from the ensemble, you would not have to remember to zap the attribute, since the 1 element would vanish from the mask at the same time.
</p>
</blockquote>
<p>
There is no need to remove such an attribute after operations, it is still valid, even if a lookup into the coordinate array returns false, due to subset operations.  It still carries information in this case, that there was a control member defined.
</p>
<pre class="wiki">char realization(realization):
    realization:axis = "E" ;
    realization:ensemble_control_member = "a" ;
</pre><p>
is useful information, even when the only values in the array in the particular data set are
</p>
<pre class="wiki">realisation: ("c", "f")
</pre><p>
I think this information is metadata about the coordinate: we are describing the coordinate, stating that there is a value which carries extra meaning, if it is present.
</p>
<p>
Encapsulating this information within the variable makes sense to me.  I think it is well worth the price of adding one bespoke attribute to the convention.
</p>
<p>
mark
</p>

    </div>

              </div>
              <div class="change" id="trac-change-20-1447175277561607">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:20" class="cnum">
    <a href="#comment:20">comment:20</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-11-10T09%3A07%3A57-08%3A00&amp;precision=second" title="See timeline at 11/10/15 09:07:57">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
similarly, the absence of this attribute on an ensemble coordinate explicitly states that there was no control member in the ensemble, which is also useful information.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-21-1447176926218684">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:21" class="cnum">
    <a href="#comment:21">comment:21</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-11-10T09%3A35%3A26-08%3A00&amp;precision=second" title="See timeline at 11/10/15 09:35:26">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
OK then for <tt>ensemble_control_member</tt>, thanks. My comments still stand regarding <tt>cell_methods</tt> and the indication of the number of models involved.
</p>
<p>
Best wishes and thanks
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-22-1447319445220953">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:22" class="cnum">
    <a href="#comment:22">comment:22</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-11-12T01%3A10%3A45-08%3A00&amp;precision=second" title="See timeline at 11/12/15 01:10:45">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I think the suggestion about using <tt>source</tt> to provide the required information on number of models in the ensemble makes good sense.  I think this will alleviate the need for a bespoke attribute
</p>
<p>
I will consider the wording for describing this and update the proposed text accordingly
</p>

    </div>

              </div>
              <div class="change" id="trac-change-23-1448992722145218">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:23" class="cnum">
    <a href="#comment:23">comment:23</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-12-01T09%3A58%3A42-08%3A00&amp;precision=second" title="See timeline at 12/01/15 09:58:42">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I have reviewed <a class="new ticket" href="./108.html" title="enhancement: Defining a domain for a cell_method (new)">#108</a>, which has been suggested in context with the use of a CellMethod to store the size of the original ensemble.
</p>
<p>
It is my view that <a class="new ticket" href="./108.html" title="enhancement: Defining a domain for a cell_method (new)">#108</a> needs significant revision if it is to be adopted to meet its current use case. More importantly it is aiming at a different use case so I don't think it is relevant without significant rethink.
</p>
<p>
To use a CellMethod to define the number of members an ensemble had when it was created, CF would need new CellMethod syntax. It is not clear to me that this is generally useful.  I am wary of extending CellMethod's syntax only to meet this use case.
</p>
<p>
The 'number of members in the original ensemble' information is information about the ensemble coordinate.  It is not information directly about the data variable.  It is not information related to a 'cell'.
</p>
<p>
<a class="ext-link" href="http://cf-metadata.github.io/#_data_representative_of_cells"><span class="icon">​</span>http://cf-metadata.github.io/#_data_representative_of_cells</a>
states:  
</p>
<pre class="wiki">When gridded data does not represent the point values of a field but instead represents some 
characteristic of the field within cells of finite "volume," a complete description of the variable 
should include metadata that describes the domain or extent of each cell, and the characteristic of 
the field that the cell values represent.
</pre><p>
In this case, the gridded data may well be representing the point values of the field.  Commonly there will be no 'cells of finite volume' for these data sets.
</p>
<p>
This information is about the ensemble coordinate.  it is only relevant to the data variable through the ensemble coordinate.  Keeping this information on the ensemble coordinate variable seems like a useful encapsulation of information.
</p>
<p>
As such, I reiterate my view that CF should encode the number of members an ensemble originally contained as an optional numerical attribute, specifically named for the purpose and only valid when attached to an ensemble coordinate.
</p>
<p>
I think this is a localised and sensible way to address the requirement to store this metadata interoperably.
</p>
<p>
Please may contributors with a preference for a CellMethods approach detail reasons why they feel this is a preferred solution to having a defined, limited scope,  attribute?
</p>
<p>
thank you
mark
</p>

    </div>

              </div>
              <div class="change" id="trac-change-24-1449073248213276">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:24" class="cnum">
    <a href="#comment:24">comment:24</a>
  </span>
          <span>follow-ups:</span>
    <a href="#comment:25" class="follow-up">↓ 25</a>
    <a href="#comment:26" class="follow-up">↓ 26</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-12-02T08%3A20%3A48-08%3A00&amp;precision=second" title="See timeline at 12/02/15 08:20:48">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
You are right that using <tt>cell_methods</tt> for this would be a generalisation. In fact the opening of sect 7, which you quote, is already too restrictive, in talking about "volume" (even with quotation marks), given that operations can be applied to any single or combination of coordinate axes. We should probably rewrite it anyway! In general, <tt>cell_methods</tt> indicates how the data you have represents the cells (hence the title of the section). I think it is plausible to regard taking a subset of the points within the cell, in order to represent the cell, as a cell method, and that is what you are doing when extracting an sub-ensemble. The minimum or the maximum, which are existing cell methods, are particular subsets (of size one) to represent the cell. The sample operation might also be performed on axes with continuous coordinate variables, taking every Nth point for example.
</p>
<p>
The advantages that I see of introducing a <tt>sample</tt> method with a <tt>dimension</tt> comment are (a) it meets your use case of recording that a subset has been extracted, and recording how big the full set was - both of these sorts of metadata may be useful in other ways too, (b) it allows you to record multiple subsetting, which your use-case needs (see comment 7 above) - you may want to know both the original size (19) and the number of members used to compute the mean (15), (c) it allows you to record when this subsetting occurred, in relation to other statistical reductions which might have been applied, (d) it doesn't require any new attributes, just an extension of an existing one.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-25-1449158613742149">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:25" class="cnum">
    <a href="#comment:25">comment:25</a>
  </span>
        in reply to:
    <a href="#comment:24">↑ 24</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-12-03T08%3A03%3A33-08%3A00&amp;precision=second" title="See timeline at 12/03/15 08:03:33">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="./142#comment:24" title="Comment 24">jonathan</a>:
</p>
<p>
thank you for your considered response
</p>
<p>
If we were to adopt this approach, what changes would be required to Cell Methods?
</p>
<ol><li>Would we have to change the Cell Methods preamble to highlight its wider utility?
</li><li>What syntax would be added to Cell Methods to enable the storage of the size of a collection prior to an operation
<ul><li>note: this is different from the 'domain' discussion in <a class="new ticket" href="./108.html" title="enhancement: Defining a domain for a cell_method (new)">#108</a>, which is focussed on storing the values which were used from a coordinate which has been aggregated, not the size of that coordinate.
</li></ul></li><li>Would <tt>subset</tt> be an explicit operation for a cell method?
<ul><li>If so, would this be a true subset (&lt; but not &lt;=)
</li></ul></li><li>I do not expect to have a <tt>dimension</tt> in my file of length <tt>ensemble_size</tt>; in general I just have the number
</li></ol><p>
By example, How would I write the metadata from:
</p>
<ol><li>1 GRIB2 message (ensemble 7 of a collection of size 19)?
</li><li>19 GRIB2 messages (ensembles 0-18 of size 19)
</li></ol><p>
thank you
mark
</p>

    </div>

              </div>
              <div class="change" id="trac-change-26-1449158723832240">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:26" class="cnum">
    <a href="#comment:26">comment:26</a>
  </span>
        in reply to:
    <a href="#comment:24">↑ 24</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-12-03T08%3A05%3A23-08%3A00&amp;precision=second" title="See timeline at 12/03/15 08:05:23">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="./142#comment:24" title="Comment 24">jonathan</a>:
</p>
<p>
a minor detail point
</p>
<blockquote class="citation">
<p>
(b) it allows you to record multiple subsetting, which your use-case needs (see comment 7 above) - you may want to know both the original size (19) and the number of members used to compute the mean (15)
</p>
</blockquote>
<p>
I do not need this for my use case.  The only number I need to store here is 19, not 15.
</p>
<p>
Providing this capability goes beyond my requirements
</p>

    </div>

              </div>
              <div class="change" id="trac-change-27-1449162918051288">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:27" class="cnum">
    <a href="#comment:27">comment:27</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:28" class="follow-up">↓ 28</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-12-03T09%3A15%3A18-08%3A00&amp;precision=second" title="See timeline at 12/03/15 09:15:18">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<ol><li>I haven't drafted exact words (I could help with that if we decide to do it this way) but I don't think it would be a large change. I think the general idea of cell methods is to record how the value given for each cell represents the range of values which may occur within the extent of the cell. This idea applies to all the non-default methods (mean, minimum, etc.) while for <tt>point</tt> and <tt>sum</tt> there is only one value under consideration, so the idea is irrelevant.
</li></ol><ol start="2"><li>My suggestion is a standardised comment <tt>dimension:</tt> <em>dimension</em> in <tt>()</tt> after the cell method to record the dimension as it was before the operation.
</li></ol><ol start="3"><li>I suggested <tt>sample</tt> but it could be <tt>subset</tt> - I think that would also be OK for continuous axes. I don't think the question of &lt; or &lt;= can be answered in general; it's just a subset of the elements that the axis previously had. What do you mean by "explicit"?
</li></ol><ol start="4"><li>It's OK to store a number in a dimension, isn't it? A scalar variable could be used instead, but a dimension has the additional possibility that you <em>could</em> use it to preserve coordinate variables or auxiliary coordinate variables of the axis as it was before the subset was taken. I know you don't need it for your case, but it's good to have the option.
</li></ol><p>
I'm not sure that I have understood your example - sorry. If you have a dimension <tt>full</tt> (=19) and take some subset of it, so you now have an ensemble with dimension <tt>sub</tt> (which could be 1 or 19 or anything between) the cell method entry would be <tt>sub: subset (dimension: full)</tt>.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-28-1449223107241363">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:28" class="cnum">
    <a href="#comment:28">comment:28</a>
  </span>
        in reply to:
    <a href="#comment:27">↑ 27</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-12-04T01%3A58%3A27-08%3A00&amp;precision=second" title="See timeline at 12/04/15 01:58:27">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="./142#comment:27" title="Comment 27">jonathan</a>:
</p>
<ol start="3"><li><a class="ext-link" href="http://cf-metadata.github.io/#appendix-cell-methods"><span class="icon">​</span>appendixE</a>: table E1 lists the current cell_method names.  These are descriptions of the numerical process carried out on the values, point, sum, mean ....
<ul><li>subset and sample are quite different in character. I don't think they fit in table E1 very well
</li><li>are these 'operations' just represented as 'point' cell_method instances?
</li></ul></li></ol><ol start="4"><li>dimensions are used to define the size of variables and the size of variables changes, leading to changes in dimension.  The value in this case is constant, it is an attribute of the ensemble coordinate.  Storing it as a dimension is an indirection step which doesn't feel required and increases the risk of inconsistency.  I prefer storing the explicit numerical value.
</li></ol>
    </div>

              </div>
              <div class="change" id="trac-change-29-1449245544112953">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:29" class="cnum">
    <a href="#comment:29">comment:29</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-12-04T08%3A12%3A24-08%3A00&amp;precision=second" title="See timeline at 12/04/15 08:12:24">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
I suppose we just feel differently about these things, so we'll have to see what others think. For my part, I think that taking a subset of the points in a cell is not radically different from taking a single one, such as the maximum or the minimum, which are special subsets. The facility of recording the size before the operation of cell methods would be generally useful; for example, to calculate a standard error from a standard deviation you need to know how big the sample was from which the statistic was calculated. If the single number has no purpose other than this, storing it in a dimension (rather than a scalar coordinate or in text in the attribute) is perhaps unnecessary machinery, but I don't see what inconsistency it would cause if nothing uses this dimension. On the other hand, it would be positively useful if you wanted to keep some auxiliary coordinate variables for the full sample, which I can imagine being valuable for ensembles. I know that this is anticipating a use-case which has not been raised, but at the time when we have a free choice about how to do things to meet an existing use-case, it's sensible to choose an approach which offers future possibilities. We could offer the alternatives of encoding the number as text in the <tt>cell_methods</tt>, or naming a dimension in the <tt>cell_methods</tt>. This would not be a difficulty for parsing since dimension names must begin with a letter.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-30-1449650917592254">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:30" class="cnum">
    <a href="#comment:30">comment:30</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2015-12-09T00%3A48%3A37-08%3A00&amp;precision=second" title="See timeline at 12/09/15 00:48:37">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
On further thought, I agree with you about the dimension. For your use-case, you don't need to keep old coordinates, so you don't need a dimension, and it's sufficient to give the size explicitly in the <tt>cell_methods</tt>. Your use case could be something like <tt>ensemble: subset (dimension: 19) ensemble: mean (dimension: 15)</tt> to indicate that first a subset of 15 was taken from 19, then the 15 were averaged. If you're not interested in noting that the mean was of only a subset, you could just put <tt>ensemble: mean (dimension: 19)</tt> to record the original full size. The dimension <tt>ensemble=1</tt> is for the resulting axis after all this processing. If subsequently there is a use-case for recording coordinates as they were before <tt>cell_methods</tt> were applied, it would be an obvious and easy extension to put a dimension name instead of the number.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-31-1451916990529613">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:31" class="cnum">
    <a href="#comment:31">comment:31</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-01-04T06%3A16%3A30-08%3A00&amp;precision=second" title="See timeline at 01/04/16 06:16:30">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-description">
      <strong class="trac-field-description">Description</strong>
        modified (<a href="./142?action=diff&amp;version=31">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      <p>
I have updated this proposal to take account of source and institution information for model multiplicity definition.  
</p>
<p>
I have also added a short section on ensemble labelling, including a proposed new standard name: <tt>ensemble_member_label</tt>, canonical unit <em> (a string value is expected) for providing string labels for ensemble members.
</em></p>
<p>
I remain worried by the approach under discussion for identifying original ensemble size using cell methods.  I think that this information, in the context of my use case, is information about the coordinate variable, not the data variable.
</p>
<p>
Given the lack of agreement on this topic, I have removed it completely from this proposal.  It is an additive change, which ever route is adopted. I propose we evaluate this ticket without that detail;  we can return to it later if the rest of this proposal is deemed suitable.
</p>
<p>
Does this updated proposal have sufficient merit that it may be adopted?
Are there remaining areas of concern?
</p>
<p>
thank you
</p>
<p>
markh
</p>

    </div>

              </div>
              <div class="change" id="trac-change-32-1451929928573467">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:32" class="cnum">
    <a href="#comment:32">comment:32</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:35" class="follow-up">↓ 35</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-01-04T09%3A52%3A08-08%3A00&amp;precision=second" title="See timeline at 01/04/16 09:52:08">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
Please could you write the proposal in a form which shows exactly the text changes you'd like to make the conventions and conformance documents i.e. which sections to be modified (including Appendix A, I guess), where and how?
</p>
<p>
Many thanks
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-33-1452530223355781">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:33" class="cnum">
    <a href="#comment:33">comment:33</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-01-11T08%3A37%3A03-08%3A00&amp;precision=second" title="See timeline at 01/11/16 08:37:03">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
All of the text in the proposal in 4. Technical Proposal is new text
</p>
<p>
There's one line to add to Appendix A
</p>
<p>
| <strong><tt>ensemble_control_member</tt></strong>
| D
| C
| &lt;&lt;ensemble-coordinate&gt;&gt;
| The identifier of the member of the ensemble which is the control member.
</p>
<p>
I'll get the conformance doc updates up next
</p>

    </div>

              </div>
              <div class="change" id="trac-change-34-1452616905789385">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:34" class="cnum">
    <a href="#comment:34">comment:34</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-01-12T08%3A41%3A45-08%3A00&amp;precision=second" title="See timeline at 01/12/16 08:41:45">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
What I mean is, the change should be described as a proposal for how the text should be changed exactly e.g. In section N, after the Nth paragraph, insert the following: ... and so on.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-35-1452766765662986">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:35" class="cnum">
    <a href="#comment:35">comment:35</a>
  </span>
        in reply to:
    <a href="#comment:32">↑ 32</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-01-14T02%3A19%3A25-08%3A00&amp;precision=second" title="See timeline at 01/14/16 02:19:25">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="./142#comment:32" title="Comment 32">jonathan</a>:
</p>
<blockquote class="citation">
<p>
Dear Mark
</p>
<p>
Please could you write the proposal in a form which shows exactly the text changes you'd like to make the conventions and conformance documents i.e. which sections to be modified (including Appendix A, I guess), where and how?
</p>
<p>
Many thanks
</p>
<p>
Jonathan
</p>
</blockquote>
<p>
I have prepared a pull request
</p>
<p>
<a class="ext-link" href="https://github.com/cf-convention/cf-conventions/pull/65"><span class="icon">​</span>https://github.com/cf-convention/cf-conventions/pull/65</a>
</p>
<p>
This does not include the conformance document changes as this document is not yet under source control, I have a separate PR for that
</p>
<p>
<a class="ext-link" href="https://github.com/cf-convention/cf-conventions/pull/64"><span class="icon">​</span>https://github.com/cf-convention/cf-conventions/pull/64</a>
</p>
<p>
which will be followed by a couple of details to make this easier
</p>
<p>
Does this get close to the information you are looking for?
</p>
<p>
mark
</p>

    </div>

              </div>
              <div class="change" id="trac-change-36-1452791846910469">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:36" class="cnum">
    <a href="#comment:36">comment:36</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-01-14T09%3A17%3A26-08%3A00&amp;precision=second" title="See timeline at 01/14/16 09:17:26">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
It's not as easy to appreciate as if you would write down in this ticket what change is proposed and where. We might change to using <a class="missing wiki">GitHub?</a> in that kind of way, but we decided to postpone thinking about that until we get to CF 1.7 and more of us have some familiarity with it. For the moment, I would appreciate it if we could stick to the current procedure, which we have used for a long time as you know, namely to spell out the proposed change explicitly in the trac ticket. It has the advantage that it's easy to review the entire discussion and the versions of text under consideration in one place.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-37-1452852623268378">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:37" class="cnum">
    <a href="#comment:37">comment:37</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:38" class="follow-up">↓ 38</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-01-15T02%3A10%3A23-08%3A00&amp;precision=second" title="See timeline at 01/15/16 02:10:23">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-description">
      <strong class="trac-field-description">Description</strong>
        modified (<a href="./142?action=diff&amp;version=37">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      <h1 id="NewContent">New Content</h1>
<h2 id="Conventions">Conventions</h2>
<h4 id="a4.6EnsembleCoordinate">4.6 Ensemble Coordinate</h4>
<blockquote>
<p>
Variables representing an ensemble or collection of realizations shall have an attribute <tt>axis</tt> with a value <tt>E</tt>.  These variables are discrete, as described in section 4.5;  they do not represent continuous quantities. 
</p>
</blockquote>
<blockquote>
<p>
Ensemble variables have a number of optional standardised attributes available for use.  Further bespoke attributes to describe the ensemble in project specific ways are always allowed.
</p>
</blockquote>
<h5 id="a4.6.1IdentifyingMembers">4.6.1 Identifying Members</h5>
<blockquote>
<p>
A data variable representing an ensemble will commonly have an ensemble coordinate with the standard name <tt>realization</tt>; this is not mandatory. The <tt>realization</tt> standard name is used to provide a unique identifying number to each ensemble member within the ensemble.
</p>
</blockquote>
<blockquote>
<p>
An ensemble coordinate providing a string label for each ensemble member within the ensemble may also be included.  The standard name <tt>ensemble_member_label</tt> is proposed (canonical unit = <em> (string expected)); this name is not yet approved as a standard_name.  An <tt>ensemble_member_label</tt> shall have unique values and missing values are not allowed.
</em></p>
</blockquote>
<h5 id="a4.6.2EnsembleControlMember">4.6.2  Ensemble Control Member ====</h5>
<blockquote>
<p>
An ensemble coordinate with the standard name <tt>realization</tt> or <tt>ensemble_member_label</tt> may include an attribute named <tt>ensemble_control_member</tt>.
</p>
</blockquote>
<blockquote>
<p>
This value provides a definition that one member of the ensemble is the control member and identifies this member.  This control member shall have the identified value within the ensemble coordinate's data.
</p>
</blockquote>
<blockquote>
<p>
The absence of this attribute shall be interpreted as a negative statement, explicitly stating that there is no control member identified within the ensemble.
</p>
</blockquote>
<h4 id="a4.6.3SingleorMultipleModelEnsemble">4.6.3 Single or Multiple Model Ensemble  =</h4>
<blockquote>
<p>
An ensemble coordinate may be identified as being from one model or multiple models by providing further variables identified as coordinates or auxiliary coordinates by the data variable.  All of these coordinates shall have an attribute <tt>axis</tt> with a value <tt>E</tt>.
</p>
</blockquote>
<blockquote>
<p>
The standard name's <tt>source</tt> and <tt>institution</tt> are used to identify the multiplicity of models which the ensemble is taken from, one other or both may be present.
</p>
</blockquote>
<blockquote>
<p>
Such coordinates may be scalar coordinate variables or they may be attached to the same dimension(s) as other ensemble coordinates referenced by a data variable.  Scalar coordinates are commonly used to define a single model ensemble; in this case, this is informationally equivalent to auxiliary coordinates with identical values.
</p>
</blockquote>
<blockquote>
<p>
The absence of such <tt>source</tt> and <tt>institution</tt> coordinates shall not be interpreted as a positive or negative statement.  No inference on the multiplicity of models which the ensemble is taken from shall be inferred from the absence of such coordinates.
</p>
</blockquote>
<h4 id="AppendixA">Appendix A</h4>
<blockquote>
<p>
| <strong><tt>ensemble_control_member</tt></strong> | D | C | ref:&lt;&lt;ensemble-coordinate&gt;&gt; | The identifier of the member of the ensemble which is the control member. |
</p>
</blockquote>
<h2 id="ConformanceDocument">Conformance Document</h2>
<h4 id="a4CoordinateTypes">4 Coordinate Types</h4>
<h5 id="Requirements:">Requirements:</h5>
<ul><li>The axis attribute may <del>only</del> be attached to a coordinate variable <strong>or auxiliary coordinate variable only</strong>.
</li><li>The only legal values of axis are X, Y, Z, <del>and</del> T<strong> and E</strong> (case insensitive).
</li><li>The axis attribute must be consistent with the coordinate type deduced from units and positive.
</li><li><del>The axis attribute is not allowed for auxiliary coordinate variables.</del>
</li><li><del>A data variable must not have more than one coordinate variable with a particular value of the axis attribute.</del>
</li></ul><h5 id="a4.6.2EnsembleControlMember1">4.6.2  Ensemble Control Member ====</h5>
<h5 id="Requirements">Requirements</h5>
<ul><li>A variable may have an attribute <tt>ensemble_control_member</tt> only if it has an <tt>axis</tt> attribute of <tt>E</tt> and a standard_name of either <tt>realization</tt> or <tt>ensemble_member_label</tt>.
</li></ul>
    </div>

              </div>
              <div class="change" id="trac-change-38-1452852665571972">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:38" class="cnum">
    <a href="#comment:38">comment:38</a>
  </span>
        in reply to:
    <a href="#comment:37">↑ 37</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-01-15T02%3A11%3A05-08%3A00&amp;precision=second" title="See timeline at 01/15/16 02:11:05">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I hope <a class="ticket" href="./142#comment:37" title="Comment 37">37</a> is helpful
</p>

    </div>

              </div>
              <div class="change" id="trac-change-39-1453298719119781">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:39" class="cnum">
    <a href="#comment:39">comment:39</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:41" class="follow-up">↓ 41</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-01-20T06%3A05%3A19-08%3A00&amp;precision=second" title="See timeline at 01/20/16 06:05:19">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
Thanks for writing out the proposed changes explicitly. That's very helpful. I think the proposal is generally fine. I have a few comments.
</p>
<ul><li>A modification is also needed to the second para of preamble of sect 4.5. Replace the sentence starting "The attribute <tt>axis</tt>" with "The attribute <tt>axis</tt> may be attached to a coordinate variable and given one of the values X, Y, Z, T or E, which stand for a longitude, latitude, vertical, time or ensemble axis respectively."
</li></ul><ul><li>Maybe a better title for sect 4.6 would be "Ensemble axis", like following sect 4.5 and the text in the previous bullet? It's not obvious to me what "ensemble coordinate" means. It's not like the phrase "longitude coordinate", which means a value of longitude; "ensemble" does not have a value. Elsewhere in the text I think you mean "ensemble coordinate variable".
</li></ul><ul><li>You propose to allow a given value of <tt>axis</tt> attribute to appear more than once for a given data variable. The reason we currently prohibit that is to reduce the possibility of inconsistency. I guess you to want to allow it for <tt>axis="E"</tt> particularly because there may well be no (Unidata) coordinate variable and you'd like to attach it to all the aux coord vars. I would suggest an alternative: let's keep the existing prohibition, so that <tt>axis="E"</tt> is allowed only once, and allow it only to be attached only to a coordinate variable of <tt>realization</tt> or a string-valued aux coord var of <tt>ensemble_member_label</tt>. That means, to identify it as an ensemble axis by the definition of 4.6, one or both of these kinds of coordinate must be provided (which would probably be a good thing) and that you know where to find the <tt>axis</tt> attribute if you want it.
</li></ul><ul><li>The first para of 4.6 seems a bit confused to me because it's talking about both data and coordinate variables without distinction.
</li></ul><ul><li>I don't think the statement about bespoke attributes is necessary because there is a general statement about this applying to the whole of CF in sect 2.6.
</li></ul><ul><li>Since the text is quite short, I think subsubsections aren't necessary - you could just use paragraphs instead.
</li></ul><ul><li>I'm not sure what you mean by the absence of the ensemble_control_member att. Since this att identifies the ensemble control member, omitting it obviously means that no control member has been identified - there's no need to state that. I suppose you mean that omitting implies that there <em>is</em> no control member i.e. all members have equal status.
</li></ul><p>
Considering all the above, I suggest a subsection 4.6 as follows:
</p>
<blockquote>
<p>
Data variables representing an ensemble or collection of realizations shall have an ensemble axis. This is a discrete axis, as described in section 4.5. Various attributes are available for use with ensemble axes, as described in this section.
</p>
</blockquote>
<blockquote>
<p>
An ensemble axis can optionally have a coordinate variable with the standard name <tt>realization</tt>, used to provide a unique identifying number to each member of the ensemble. A string-valued auxiliary coordinate variable of the ensemble axis may also be included with the standard name <tt>ensemble_member_label</tt>. Unlike other auxiliary coordinate variables, this variable must have a unique value for each element and missing values are not allowed. To indicate the ensemble axis, either the <tt>realization</tt> or the <tt>ensemble_member_label</tt> variable may have an <tt>axis</tt> attribute with the value E.
</p>
</blockquote>
<blockquote>
<p>
A <tt>realization</tt> or <tt>ensemble_member_label</tt> variable with attribute <tt>axis="E"</tt> can optionally have an <tt>ensemble_control_member</tt> attribute, whose presence indicates that one member of the ensemble is the control member and whose value is the <tt>realization</tt> or the <tt>ensemble_member_label</tt> of the control member. The absence of this attribute implies that the ensemble has no control member.
</p>
</blockquote>
<blockquote>
<p>
An ensemble may be described as being from one model or from multiple models by providing string-valued auxiliary coordinates with standard_name <tt>source</tt> and <tt>institution</tt>. Such variables can have the ensemble dimension or they can be scalars, indicating a single-model ensemble (equivalent to a variable with the ensemble dimension in which all values are equal). The absence of these variables does not imply anything about the number of models involved in the ensemble.
</p>
</blockquote>
<p>
The text doesn't have to state that ensemble_member_label, source and institution are not yet defined standard_names. If this proposal is agreed, the standard_names should be proposed and I expect they will be approved too.
</p>
<p>
Best wishes and thanks
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-40-1455785743028296">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:40" class="cnum">
    <a href="#comment:40">comment:40</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-02-18T00%3A55%3A43-08%3A00&amp;precision=second" title="See timeline at 02/18/16 00:55:43">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-description">
      <strong class="trac-field-description">Description</strong>
        modified (<a href="./142?action=diff&amp;version=40">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      <p>
i have modified the proposal addressing the majority of the points raised by <a class="ticket" href="./142#comment:39" title="Comment 39">jonathan</a>
</p>

    </div>

              </div>
              <div class="change" id="trac-change-41-1455786380872593">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:41" class="cnum">
    <a href="#comment:41">comment:41</a>
  </span>
        in reply to:
    <a href="#comment:39">↑ 39</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-02-18T01%3A06%3A20-08%3A00&amp;precision=second" title="See timeline at 02/18/16 01:06:20">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="./142#comment:39" title="Comment 39">jonathan</a>:
</p>
<blockquote class="citation">
<ul><li>You propose to allow a given value of <tt>axis</tt> attribute to appear more than once for a given data variable. The reason we currently prohibit that is to reduce the possibility of inconsistency. I guess you to want to allow it for <tt>axis="E"</tt> particularly because there may well be no (Unidata) coordinate variable and you'd like to attach it to all the aux coord vars. I would suggest an alternative: let's keep the existing prohibition, so that <tt>axis="E"</tt> is allowed only once, and allow it only to be attached only to a coordinate variable of <tt>realization</tt> or a string-valued aux coord var of <tt>ensemble_member_label</tt>. That means, to identify it as an ensemble axis by the definition of 4.6, one or both of these kinds of coordinate must be provided (which would probably be a good thing) and that you know where to find the <tt>axis</tt> attribute if you want it.
</li></ul></blockquote>
<p>
I have not addressed this point.  The ability to have multiple variables: coordinate variables,  auxiliary coordinate variables and scalar coordinate variables identified as ensemble coordinates from a data variable's point of view is intrinsic to the proposal details.
</p>
<p>
In a number of cases, these will define a number of degrees of freedom the ensemble may well not be a single 'axis'
</p>
<p>
This proposal is noticeably diminished by that change
</p>
<p>
What drives the desire to keep this restriction please?
</p>
<blockquote>
<p>
'The reason we currently prohibit that is to reduce the possibility of inconsistency.'
</p>
</blockquote>
<p>
does not appear a strong driver to me.  What kind of inconsistency is feared?
</p>
<p>
 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-42-1455805051544431">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:42" class="cnum">
    <a href="#comment:42">comment:42</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-02-18T06%3A17%3A31-08%3A00&amp;precision=second" title="See timeline at 02/18/16 06:17:31">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
Where is your currently proposed text? Is it different from the version I suggested in my last comment? The text at the start of this ticket is quite different from that. The changes I proposed above were intended to improve logic and clarity. Maybe I did not succeed in those aims!
</p>
<p>
The potential inconsistency is that if there are various coordinate or 1D auxiliary coordinate variables for a particular dimension all with <tt>axis</tt> attributes, these attributes might have different values. That could happen in your case too for the ensemble axis. That is why I made my alternative suggestion that <tt>axis</tt> should be allowed only on <tt>realization</tt> or <tt>ensemble_member_label</tt> variables, and not on both or on any other variables. That prevents inconsistency, and also means you have to include <tt>realization</tt> or <tt>ensemble_member_label</tt> to define an ensemble axis, which seems to me a good thing. What's the particular need to label other coordinate or auxiliary coordinate variables with <tt>axis="E"</tt>? We don't do this for any other kind of axis.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-43-1455809101809349">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:43" class="cnum">
    <a href="#comment:43">comment:43</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-02-18T07%3A25%3A01-08%3A00&amp;precision=second" title="See timeline at 02/18/16 07:25:01">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-description">
      <strong class="trac-field-description">Description</strong>
        modified (<a href="./142?action=diff&amp;version=43">diff</a>)
    </li>
  </ul>
    <div class="comment searchable">
      <p>
Hello Jonathan
</p>
<p>
I have not adopted the text you proposed straight away.  I have included a set of updates in the ticket summary which pick up the uncontentious points, from my point of view.
</p>
<p>
There are material changes in the text you propose which I want to discuss further and I felt it was easier for me to be able to contrast between the proposal I have raised and your suggested alterations by doing this.
</p>
<p>
It is not clear to me why the limitation on the use of the axes attribute exists.  I don't see what problems occur by having multiple variables with an axis attribute of E.  This is metadata about a coordinate (| aux coord | scalar coord), it is an 'Ensemble coordinate'.
</p>
<p>
With this in mind, I think I do disagree with changing the title of the section to Ensemble Axis.  The aim here is to define one or more ensemble coordinate (| aux coord | scalar coord) instances. 
</p>
<p>
thank you for your continued interest 
mark
</p>

    </div>

              </div>
              <div class="change" id="trac-change-44-1455810168539061">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:44" class="cnum">
    <a href="#comment:44">comment:44</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-02-18T07%3A42%3A48-08%3A00&amp;precision=second" title="See timeline at 02/18/16 07:42:48">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Wow, the 'change description' diffs render awfully in the email notification, yet they come through very nicely to the trac interface, with diff links and so on.
</p>
<p>
It seems to me quite a quandry which communication mechanism to pander to; I am sure I can't please everybody
</p>

    </div>

              </div>
              <div class="change" id="trac-change-45-1456233837851804">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:45" class="cnum">
    <a href="#comment:45">comment:45</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-02-23T05%3A23%3A57-08%3A00&amp;precision=second" title="See timeline at 02/23/16 05:23:57">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Hello Jonathan
</p>
<p>
Please may you provide some more information on the value of the constraints:
</p>
<ul><li>The axis attribute is not allowed for auxiliary coordinate variables.
</li><li>A data variable must not have more than one coordinate variable with a particular value of the axis attribute. 
</li></ul><p>
and how these could be altered by the changes under discussion here?
</p>
<p>
thank you
mark
</p>

    </div>

              </div>
              <div class="change" id="trac-change-46-1457085982497227">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:46" class="cnum">
    <a href="#comment:46">comment:46</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-03-04T02%3A06%3A22-08%3A00&amp;precision=second" title="See timeline at 03/04/16 02:06:22">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
The <tt>axis</tt> attribute is allowed on auxiliary coordinate variables. (It didn't used to be.) The reason for the prohibition on there being more than one occurrence of any particular value of <tt>axis</tt> attribute for a given data variable is that they might be inconsistent. For example, you might have one-dimensional (not auxiliary) coordinate variables for two different dimensions, both having <tt>axis="X"</tt>. This would probably be a mistake, and it's easy to identify such mistakes by not allowing <tt>X</tt> (or any other value) to appear more than once. Of course, several 1D auxiliary coordinate variables for the same dimension all having <tt>axis="E"</tt> would not be a mistake, but it's more complicated to formulate the rule to identify mistakes if we allow repetition under some circumstances, especially as some auxiliary coordinate variables are multi-dimensional, and also allowed to have an <tt>axis</tt> attribute.
</p>
<p>
You might feel this is excessively prohibitive, but it does keep things simple. I feel that there is no great advantage to be allowed to label many coord or aux coord vars as <tt>E</tt>. If any one of them is labelled like that, it identifies the axis, and I propose that the labelled variable should have one of two possible standard names - that also will make an ensemble axis easier to identify in practice, I think.
</p>
<p>
I suggest changing the name of the section because I don't think "ensemble coordinate" is a meaningful phrase. An ensemble is a <em>collection</em> of realisations. It's the realisations which have coords and aux coords to distinguish them, not the ensemble. However, I think "ensemble axis" makes sense because the axis is a property of the entire ensemble.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-47-1457532254997449">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:47" class="cnum">
    <a href="#comment:47">comment:47</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-03-09T06%3A04%3A14-08%3A00&amp;precision=second" title="See timeline at 03/09/16 06:04:14">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Hello Jonathan
</p>
<p>
thank you for your response, I understand more now.
</p>
<blockquote class="citation">
<p>
The axis attribute is allowed on auxiliary coordinate variables. (It didn't used to be.)
</p>
</blockquote>
<p>
I don't believe that this allowance is written into the conformance document yet.
</p>
<p>
I think I follow your explanation. 
</p>
<p>
Is it your intent to state that:
</p>
<ul><li>A data variable shall have one coordinate or auxiliary coordinate variable for each allowed axis value in the set (x, y, z, t, e), or zero; never many.
</li></ul><p>
?
</p>
<p>
thank you
</p>
<p>
mark
</p>

    </div>

              </div>
              <div class="change" id="trac-change-48-1457547928414730">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:48" class="cnum">
    <a href="#comment:48">comment:48</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-03-09T10%3A25%3A28-08%3A00&amp;precision=second" title="See timeline at 03/09/16 10:25:28">5 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Mark
</p>
<p>
The preamble of section 5 says "If an axis attribute is attached to an auxiliary coordinate variable, it can be used by applications in the same way the axis attribute attached to a coordinate variable is used. However, it is not permissible for a data variable to have both a coordinate variable and an auxiliary coordinate variable, or more than one of either type of variable, having an axis attribute with any given value e.g. there must be no more than one axis attribute for X for any data variable." This appears in section 4 of the conformance document, however, which is confusing. Moreover, that section is out of date, as you say, because it only allows the axis attribute on coord vars (not aux coord vars). We should update the conformance document with a defect ticket, I suppose. After updating, one of the requirements would read, "A data variable must not have more than one coordinate variable or auxiliary coordinate variable with a particular value of the axis attribute."
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="/trac/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="./142?format=rss" class="rss">RSS Feed</a>
        </li><li>
          <a rel="nofollow" href="./142?format=csv" class="csv">Comma-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="./142?format=tab" class="tab">Tab-delimited Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="https://trac.edgewall.org/"><img src="/trac/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="/trac/about"><strong>Trac 1.0.20</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the CF Metadata home page at<br /><a href="http://cf-convention.github.io">http://cf-convention.github.io</a><br><font color="#0000ff" size="3"><b>The CF Metadata Trac issue tracker is read-only and will soon be shut down permanently</b></font></p>
    </div>
  </body>
</html>
