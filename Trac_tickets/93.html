<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      #93 (Two new dimensionless vertical coordinate specifications for s coordinate ocean models)
     – CF Metadata
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="/trac/search" />
        <link rel="prev" href="./92.html" title="ticket #92" />
        <link rel="last" href="./176.html" title="ticket #176" />
        <link rel="help" href="/trac/wiki/TracGuide" />
        <link rel="alternate" href="./93?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" /><link rel="alternate" href="./93?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="./93?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" />
        <link rel="next" href="./94.html" title="ticket #94" />
        <link rel="start" href="/trac/wiki" />
        <link rel="stylesheet" href="/trac/chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="/trac/chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="./1.html" title="ticket #1" />
        <link rel="shortcut icon" href="/trac/chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="/trac/chrome/common/trac.ico" type="image/x-icon" />
    <style id="trac-noscript" type="text/css">.trac-noscript { display: none !important }</style>
      <link type="application/opensearchdescription+xml" rel="search" href="/trac/search/opensearch" title="Search CF Metadata" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="1ef5c0fc31a4d36940fa4843";
      var comments_prefs={"comments_only":"false","comments_order":"oldest"};
    </script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/folding.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/wikitoolbar.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/resizer.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/auto_preview.js"></script>
    <script type="text/javascript">
      jQuery("#trac-noscript").remove();
      jQuery(document).ready(function($) {
        $(".trac-autofocus").focus();
        $(".trac-target-new").attr("target", "_blank");
        setTimeout(function() { $(".trac-scroll").scrollToTop() }, 1);
        $(".trac-disable-on-submit").disableOnSubmit();
      });
    </script>
    <script type="text/javascript" src="/trac/chrome/common/js/threaded_comments.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
      /*<![CDATA[*/
        $("#attachments").toggleClass("collapsed");
        $("#trac-up-attachments").click(function () {
          $("#attachments").removeClass("collapsed");
          return true;
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
        function setRevertHandler() {
          $("button.trac-revert").click(function() {
            var div = $("div", this);
            var field_name = div[0].id.substr(7);
            var field_value = div.text();
            var input = $("#propertyform *[name=field_" + field_name + "]");
            if (input.length > 0) {
              if (input.filter("input[type=radio]").length > 0) {
                input.val([field_value]);
              } else if (input.filter("input[type=checkbox]").length > 0) {
                input.val(field_value == "1" ? [field_value] : []);
              } else {
                input.val(field_value);
              }
            } else { // Special case for CC checkbox
              input = $("#propertyform input[name=cc_update]").val([]);
            }
            input.change();
            $(this).closest("li").remove();
            return false;
          });
        }
        setRevertHandler();
        var comment_focused = false;
        $("#comment").focus(function() { comment_focused = true; })
                     .blur(function() { comment_focused = false; });
        $("#propertyform").autoSubmit({preview: '1'}, function(data, reply) {
          var items = $(reply);
          // Update ticket box
          $("#ticket").replaceWith(items.filter('#ticket'));
          // Update changelog with original order
          $("#changelog").replaceWith(items.filter("#changelog"));
          // Reorder comments
          applyCommentsOrder(
            $('#prefs input[name="trac-comments-order"]:checked').val());
          // Show warning
          var new_changes = $("#changelog .trac-new");
          $("#trac-edit-warning").toggle(new_changes.length != 0);
          if (new_changes.length != 0)
            $("#changelog").parent().show().removeClass("collapsed");
          // Update view time
          $("#propertyform input[name='view_time']").replaceWith(items.filter("input[name='view_time']"));
          // Update preview
          var preview = $("#ticketchange").html(items.filter('#preview').children());
          var show_preview = preview.children().length != 0;
          $("#ticketchange").toggle(show_preview);
          setRevertHandler();
          // Collapse property form if comment editor has focus
          if (show_preview && comment_focused)
            $("#modify").parent().addClass("collapsed");
          // Execute scripts to load stylesheets
          items.filter("script").appendTo("head");
        }, "#ticketchange .trac-loading");
        $("#trac-comment-editor").autoSubmit({preview_comment: '1'}, function(data, reply) {
          var comment = $("#trac-comment-editor").next("div.comment").html(reply);
          comment.toggle(comment.children().length != 0);
        }, "#changelog .trac-loading");
        /*]]>*/
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://cf-trac.llnl.gov/trac"><img src="/trac/chrome/site/cf_logo.png" alt="CF Metadata Trac" height="80" width="400" /></a>
      </div>
      <form id="search" action="/trac/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="/trac/login">Login</a></li><li><a href="/trac/about">About Trac</a></li><li><a href="/trac/prefs">Preferences</a></li><li class="last"><a href="/trac/wiki/TracGuide">Help/Guide</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="/trac/query">View Tickets</a></li><li><a href="/trac/roadmap">Roadmap</a></li><li><a href="/trac/timeline">Timeline</a></li><li><a href="/trac/search">Search</a></li><li class="last"><a href="/trac/wiki">Wiki</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
        <ul>
          <li class="first"><span>&larr; <a class="prev" href="./92.html" title="ticket #92">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="./94.html" title="ticket #94">Next Ticket</a> &rarr;</span></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
        <div id="ticket" class="trac-content ">
  <div class="date">
    <p>Opened <a class="timeline" href="/trac/timeline?from=2012-08-09T07%3A14%3A26-07%3A00&amp;precision=second" title="See timeline at 08/09/12 07:14:26">9 years ago</a></p>
    <p>Closed <a class="timeline" href="/trac/timeline?from=2016-03-08T09%3A54%3A19-08%3A00&amp;precision=second" title="See timeline at 03/08/16 09:54:19">5 years ago</a></p>
  </div>
  <h2>
    <a href="./93.html" class="trac-id">#93</a>
    <span class="trac-status">
      <a href="/trac/query?status=closed">closed</a>
    </span>
    <span class="trac-type">
      <a href="/trac/query?status=!closed&amp;type=enhancement">enhancement</a>
    </span>
    <span class="trac-resolution">
      (<a href="/trac/query?status=closed&amp;resolution=fixed">fixed</a>)
    </span>
  </h2>
  <h1 id="trac-ticket-title" class="searchable">
    <span class="summary">Two new dimensionless vertical coordinate specifications for s coordinate ocean models</span>
  </h1>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable"><a href="/trac/query?status=!closed&amp;reporter=rsignell">rsignell</a></td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">cf-conventions@…</td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="/trac/query?status=!closed&amp;priority=low">low</a>
        </td>
        <th id="h_milestone" class="missing">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="missing milestone"></a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="/trac/query?status=!closed&amp;component=cf-conventions">cf-conventions</a>
        </td>
        <th id="h_version" class="missing">
          Version:
        </th>
        <td headers="h_version">
              <a href="/trac/query?status=!closed&amp;version="></a>
        </td>
    </tr><tr>
        <th id="h_keywords" class="missing">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
        <th id="h_cc" class="missing">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <h2 id="a1.Title">1. Title</h2>
<p>
Two new dimensionless vertical coordinates to support ocean models
</p>
<h2 id="a2.Moderator">2. Moderator</h2>
<p>
Rich Signell
</p>
<h2 id="a3.Requirement">3. Requirement</h2>
<p>
The ocean modeling community needs two additional vertical coordinate specifications to allow modern s-coordinate model output to be CF-compliant and allow more general specification of  s-coordinate model output for future development.
</p>
<h2 id="a4.InitialStatementofTechnicalProposal">4. Initial Statement of Technical Proposal</h2>
<p>
The existing ocean_s_coordinate dimensionless vertical coordinate specification in CF is limited to a specific vertical stretching function and set of control parameters, while modern versions of ROMS allow for more flexible specification.  Additional of these two new generalized vertical coordinate specifications would allow output from existing ROMS-derived models (and other s coordinate models) to be CF-compliant, as well as allowing more flexibility for future s_coordinate model developers and users to write and read CF-compliant model output. 
</p>
<p>
Here are the proposed additions to Appendix D.  Dimensionless Vertical Coordinates
</p>
<p>
<strong>Ocean s-coordinate, generic form 1</strong>
</p>
<pre class="wiki">   standard_name = "ocean_s_coordinate_g1"
</pre><blockquote>
<p>
Definition: 
</p>
<pre class="wiki">   z(n,k,j,i) = S(k,j,i) + eta(n,j,i) * (1 + S(k,j,i) / depth(j,i))

    where S(k,j,i) = depth_c * s(k) + (depth(j,i) - depth_c) * C(k)
</pre></blockquote>
<p>
and where z(n,k,j,i) is the height, positive upwards, relative to
ocean datum (e.g. mean sea level) at gridpoint (n,k,j,i);
eta(n,j,i) is the height of the ocean surface, positive upwards,
relative to ocean datum at gridpoint (n,j,i); s(k) is the
dimensionless coordinate at vertical gridpoint (k) with a
range of -1 &lt;= s(k) &lt;= 0, s(0) corresponds to eta(n,j,i) whereas
s(-1) corresponds to depth(j,i); C(k) is the dimensionless vertical
coordinate stretching function at gridpoint (k) with a range of
-1 &lt;= C(k) &lt;= 0, C(0) corresponds to eta(n,j,i) whereas
C(-1) corresponds to depth(j,i); and the constant depth_c,
(positive value), is a critical depth controlling the stretching.
</p>
<p>
The format for the formula_terms attribute is
</p>
<pre class="wiki">formula_terms = "s: var1 C: var2 eta: var3 depth: var4 depth_c: var5"
</pre><p>
<strong>Ocean s-coordinate, generic form 2</strong>
</p>
<pre class="wiki">   standard_name = "ocean_s_coordinate_g2"
</pre><blockquote>
<p>
Definition: 
</p>
<pre class="wiki">   z(n,k,j,i) = eta(n,j,i) + (eta(n,j,i) + depth(j,i)) * S(k,j,i)

    where S(k,j,i) = (depth_c * s(k) + depth(j,i) * C(k)) / (depth_c + depth(j,i))
</pre></blockquote>
<p>
and where z(n,k,j,i) is the height, positive upwards, relative to
ocean datum (e.g. mean sea level) at gridpoint (n,k,j,i);
eta(n,j,i) is the height of the ocean surface, positive upwards,
relative to ocean datum at gridpoint (n,j,i); s(k) is the
dimensionless coordinate at vertical gridpoint (k) with a
range of -1 &lt;= s(k) &lt;= 0, s(0) corresponds to eta(n,j,i) whereas
s(-1) corresponds to depth(j,i); C(k) is the dimensionless vertical
coordinate stretching function at gridpoint (k) with a range of
-1 &lt;= C(k) &lt;= 0, C(0) corresponds to eta(n,j,i) whereas
C(-1) correspond to depth(j,i); and the constant depth_c,
(positive value) is a critical depth controlling the stretching.
</p>
<p>
The format for the formula_terms attribute is
</p>
<pre class="wiki">formula_terms = "s: var1 C: var2 eta: var3 depth: var4 depth_c: var5"
</pre><h2 id="a5.Benefits">5. Benefits</h2>
<blockquote>
<p>
The oceanographic community, especially those producing or consuming products from s coordinate models (e.g. variants and derivatives of the Regional Ocean Modeling System (ROMS)) would benefit from the addition of these two new dimensionless vertical coordinate specifications.   These two new coordinates have been exercised in the Unidata Common Data Model and the Unidata NetCDF-Java Library for the last two years.   It's time to add them officially to the CF Conventions. 
</p>
</blockquote>
<h2 id="a6.StatusQuo">6. Status Quo</h2>
<blockquote>
<p>
The only option currently to store modern ROMS results as CF compliant would be to write the entire Z field as a 4D array.
</p>
</blockquote>

    </div>
  </div>
</div>
          

        <div>
          <div class="trac-noscript" style="position: relative">
            <form id="prefs" method="get" action="/trac/prefs" style="position: absolute; right: 0">
              <div id="trac-comments-order">
                <input type="radio" id="trac-comments-oldest" name="trac-comments-order" value="oldest" checked="checked" />
                <label for="trac-comments-oldest">Oldest first</label>
                <input type="radio" id="trac-comments-newest" name="trac-comments-order" value="newest" />
                <label for="trac-comments-newest">Newest first</label>
                <span id="trac-threaded-toggle" style="display: none">
                  <input type="radio" id="trac-comments-threaded" name="trac-comments-order" value="threaded" />
                  <label for="trac-comments-threaded">Threaded</label>
                </span>
              </div>
              <div>
                <input id="trac-comments-only-toggle" type="checkbox" />
                <label for="trac-comments-only-toggle">Comments only</label>
              </div>
            </form>
          </div>
          <h3 class="foldable">Change History <span class="trac-count">(9)</span></h3>
          <div id="changelog">
              <div class="change" id="trac-change-1-1347290638000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:1" class="cnum">
    <a href="#comment:1">comment:1</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2012-09-10T08%3A23%3A58-07%3A00&amp;precision=second" title="See timeline at 09/10/12 08:23:58">9 years ago</a> by rsignell
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Summary: There have been no comments on this proposal since I posted it one month ago, so there don't appear to be any issues.
</p>
<p>
The next step according to: 
<a class="ext-link" href="http://cf-pcmdi.llnl.gov/governance/governance-rules"><span class="icon">​</span>http://cf-pcmdi.llnl.gov/governance/governance-rules</a>
is to provide an example dataset and wait 3 more weeks.  So here is an example dataset, and with links to visualization in the IDV (to prove that this specification is already working correctly in Unidata's NetCDF-Java and in the Unidata Integrated Data Viewer:
</p>
<p>
Example dataset:  May be obtained via OPeNDAP or HTTPServer server download at this location:
<a class="ext-link" href="http://geoport.whoi.edu/thredds/catalog/examples/catalog.html?dataset=examples/coawst_g1.nc"><span class="icon">​</span>http://geoport.whoi.edu/thredds/catalog/examples/catalog.html?dataset=examples/coawst_g1.nc</a>
(e.g. wget  <a class="ext-link" href="http://geoport.whoi.edu/thredds/fileServer/examples/coawst_g1.nc"><span class="icon">​</span>http://geoport.whoi.edu/thredds/fileServer/examples/coawst_g1.nc</a>)
</p>
<p>
Example 3D view of the temperature field from dataset above in Unidata's Integrated Data Viewer (<a class="ext-link" href="http://www.unidata.ucar.edu/software/idv/"><span class="icon">​</span>http://www.unidata.ucar.edu/software/idv/</a>), showing that the new vertical coordinate specification is being correctly represented: <a class="ext-link" href="https://docs.google.com/open?id=0BzAHlPEEP_ujUE5zcG03VkVLY1k"><span class="icon">​</span>https://docs.google.com/open?id=0BzAHlPEEP_ujUE5zcG03VkVLY1k</a>
</p>
<p>
If you want to test yourself, download the IDV, download the bundle URL below, and load this bundle in IDV: 
<a class="ext-link" href="https://docs.google.com/open?id=0BzAHlPEEP_ujaDZnWGIwampJckU"><span class="icon">​</span>https://docs.google.com/open?id=0BzAHlPEEP_ujaDZnWGIwampJckU</a>
This bundle accesses the OPeNDAP link, so you don't need to download the NetCDF file to visualize the data in IDV.
</p>
<ul><li>Rich Signell
</li></ul>
    </div>

              </div>
              <div class="change" id="trac-change-2-1347353749000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:2" class="cnum">
    <a href="#comment:2">comment:2</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2012-09-11T01%3A55%3A49-07%3A00&amp;precision=second" title="See timeline at 09/11/12 01:55:49">9 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Rich
</p>
<p>
Thanks for this proposal. It needs a moderator, and according to the rules it needs at least three people in favour of it. I'm happy to support it in principle, and it would be good to hear from others in support.
</p>
<p>
I have some comments, though. Apologies for being slow: I was on holiday. I don't follow the description of the formulae. By "s(0)" do you mean "s=0", and similarly for other conditions? It appears that s and C must be linked in some way; you get eta, for instance, by imposing conditions on both s and C. Would it be better, therefore, to state them as simultaneous conditions, rather than describing the conditions for s and C separately? Having said that, it have to admit that I may have misunderstood it completely. If s=0 and C=0 in the first case, for example, then S=0 and z=eta/depth, not eta. What have I done wrong? Or perhaps that is what is supposed to happen? If so, maybe you could start by saying that the resulting coordinate is a fraction of the local depth.
</p>
<p>
Thanks
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3-1347371374000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:3" class="cnum">
    <a href="#comment:3">comment:3</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2012-09-11T06%3A49%3A34-07%3A00&amp;precision=second" title="See timeline at 09/11/12 06:49:34">9 years ago</a> by rsignell
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Jonathan,
Yes, s(0) means "at s = 0", and s(-1) means "at s = -1".   Both "s" and "C" are functions that have a valid_range [-1,0].   "s" has uniform spacing with values determined by the number of layers and the position of the variable within the layer.   For example, if the model has 5 layers, the "w" vertical velocity component (and other variables located at the interfaces between the layers) will have a vertical coordinate "s" variable with values [-1.0 -0.8 -0.6 -0.4 -0.2 -0.0].  The "u" and "v" horizontal velocity components (and other variables located in the middle of the layers) will have a different "s" variable with values [-0.9 -0.7 -0.5 -0.3 -0.1].    The "C" function, meanwhile, is free to be any monotonic function with values in the range [-1.0 0], and is used to control the stretching (more resolution near the surface, near the bottom, etc).    I have made a plot of these functions for the test file I provided at: <a class="ext-link" href="http://www.screencast.com/t/2nodlugvo"><span class="icon">​</span>http://www.screencast.com/t/2nodlugvo</a>
</p>
<p>
Based on this information, can you suggest language for the CF conventions doc that would make this more clear to you (and others)?
</p>
<p>
-Rich
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4-1347447419000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:4" class="cnum">
    <a href="#comment:4">comment:4</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2012-09-12T03%3A56%3A59-07%3A00&amp;precision=second" title="See timeline at 09/12/12 03:56:59">9 years ago</a> by rsignell
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Jonathan,
You mentioned that I needed a moderator for this ticket.   I have been playing the role of moderator for this ticket because it seems like the natural thing to do, and don't want to bug others to do a job that I feel I should be doing myself. 
</p>
<p>
Reading the rules again at:
<a class="ext-link" href="http://cf-pcmdi.llnl.gov/governance/governance-rules"><span class="icon">​</span>http://cf-pcmdi.llnl.gov/governance/governance-rules</a>
it doesn't seem to explicitly exclude the proposer from being the moderator as well.   The important thing, it would seem is to reconcile the differences of opinion enough to get at least three folks to support for it, including at least two members of the conventions committee.   Do you (or others) see this the same way, or do you feel it's important that the proposer be barred from the moderator role? 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5-1347452982000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:5" class="cnum">
    <a href="#comment:5">comment:5</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2012-09-12T05%3A29%3A42-07%3A00&amp;precision=second" title="See timeline at 09/12/12 05:29:42">9 years ago</a> by russ
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I support the proposal.  If an alternate moderator is needed, I also volunteer to serve in that role.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6-1348992975000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:6" class="cnum">
    <a href="#comment:6">comment:6</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2012-09-30T01%3A16%3A15-07%3A00&amp;precision=second" title="See timeline at 09/30/12 01:16:15">9 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Rich
</p>
<p>
Thanks for your explanations. To avoid my initial misunderstandings, I would say:
</p>
<p>
where z(n,k,j,i) is the height, positive upwards, relative to ocean datum (e.g. mean sea level) at gridpoint (n,k,j,i); eta(n,j,i) is the height of the ocean surface, positive upwards, relative to ocean datum at gridpoint (n,j,i); depth(j,i) is the distance from ocean datum to sea floor (positive value) at gridpoint (j,i); s(k) is the dimensionless coordinate at vertical gridpoint (k); C(k) is the dimensionless vertical coordinate stretching function at gridpoint (k); and the constant depth_c, (positive value), is a critical depth controlling the stretching. s(k) and C(k) are both monotonic functions of k in the range -1 to 0; both s and C equal -1 at the sea floor, where z=depth, and both equal 0 at the sea surface, where z=eta. At intermediate depths their values are unrelated.
</p>
<p>
It's the same words in both cases, isn't it, but different formulae. The above isn't very different from what you said, and I hope it's correct.
</p>
<p>
This proposal also implies that two new standard_names are needed (for the two new types of s coordinate). I suggest it would be helpful to propose those to the email list, as otherwise they might not get picked up.
</p>
<p>
I note that the datum is not defined, and the same formulae might be applied to eta and depth wrt geoid or wrt mean sea level, for example. I suppose that is OK. The standard_names of the components would distinguish the datum, but it would depend on software that computed the dimensional coordinate using it in a way which was consistent with the datum.
</p>
<p>
Regarding moderators, that's probably a subject for a different ticket. You are right, the rules don't say that the proposer can't be the moderator, but I've always assumed it, as it seems good practice to me. It can be hard to be completely objective about one's own proposal. That is absolutely not a comment on your conduct of this ticket!
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7-1349102295000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:7" class="cnum">
    <a href="#comment:7">comment:7</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2012-10-01T07%3A38%3A15-07%3A00&amp;precision=second" title="See timeline at 10/01/12 07:38:15">9 years ago</a> by rsignell
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Jonathan,
As per your suggestion, I'll submit these vertical coordinate standard names "ocean_s_coordinate_g1" and "ocean_s_coordinate_g2" to the standard_name list.   And your suggestioned rewording of the description is fine with me.  So here is my modified proposal with rewording:
</p>
<p>
Proposed additions to:
<strong>Appendix D. Dimensionless Vertical Coordinates</strong>
</p>
<p>
<strong>Ocean s-coordinate, generic form 1</strong>
</p>
<pre class="wiki">   standard_name = "ocean_s_coordinate_g1"
</pre><p>
Definition:
</p>
<pre class="wiki">   z(n,k,j,i) = S(k,j,i) + eta(n,j,i) * (1 + S(k,j,i) / depth(j,i))

    where S(k,j,i) = depth_c * s(k) + (depth(j,i) - depth_c) * C(k)
</pre><p>
and where z(n,k,j,i) is the height, positive upwards, relative to ocean datum (e.g. mean sea level) at gridpoint (n,k,j,i); eta(n,j,i) is the height of the ocean surface, positive upwards, relative to ocean datum at gridpoint (n,j,i); depth(j,i) is the distance from ocean datum to sea floor (positive value) at gridpoint (j,i); s(k) is the dimensionless coordinate at vertical gridpoint (k); C(k) is the dimensionless vertical coordinate stretching function at gridpoint (k); and the constant depth_c, (positive value), is a critical depth controlling the stretching. s(k) and C(k) are both monotonic functions of k in the range -1 to 0; both s and C equal -1 at the sea floor, where z=depth, and both equal 0 at the sea surface, where z=eta. At intermediate depths their values are unrelated.
</p>
<p>
The format for the formula_terms attribute is
</p>
<pre class="wiki">formula_terms = "s: var1 C: var2 eta: var3 depth: var4 depth_c: var5"
</pre><p>
<strong>Ocean s-coordinate, generic form 2</strong>
</p>
<pre class="wiki">   standard_name = "ocean_s_coordinate_g2"
</pre><p>
Definition:
</p>
<pre class="wiki">   z(n,k,j,i) = eta(n,j,i) + (eta(n,j,i) + depth(j,i)) * S(k,j,i)

    where S(k,j,i) = (depth_c * s(k) + depth(j,i) * C(k)) / (depth_c + depth(j,i))
</pre><p>
and where z(n,k,j,i) is the height, positive upwards, relative to ocean datum (e.g. mean sea level) at gridpoint (n,k,j,i); eta(n,j,i) is the height of the ocean surface, positive upwards, relative to ocean datum at gridpoint (n,j,i); depth(j,i) is the distance from ocean datum to sea floor (positive value) at gridpoint (j,i); s(k) is the dimensionless coordinate at vertical gridpoint (k); C(k) is the dimensionless vertical coordinate stretching function at gridpoint (k); and the constant depth_c, (positive value), is a critical depth controlling the stretching. s(k) and C(k) are both monotonic functions of k in the range -1 to 0; both s and C equal -1 at the sea floor, where z=depth, and both equal 0 at the sea surface, where z=eta. At intermediate depths their values are unrelated.
</p>
<p>
The format for the formula_terms attribute is
</p>
<pre class="wiki">formula_terms = "s: var1 C: var2 eta: var3 depth: var4 depth_c: var5"
</pre>
    </div>

              </div>
              <div class="change" id="trac-change-8-1351760757000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:8" class="cnum">
    <a href="#comment:8">comment:8</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2012-11-01T02%3A05%3A57-07%3A00&amp;precision=second" title="See timeline at 11/01/12 02:05:57">8 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Since Rich, Russ and I support this and no-one has commented for more than three weeks, I think we can conclude that this proposal is accepted (regardless of who is the moderator!). It should therefore be included in the next version of CF. Rich is already named as an author of CF. Thanks, Rich.
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9-1457459659541107">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:9" class="cnum">
    <a href="#comment:9">comment:9</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2016-03-08T09%3A54%3A19-08%3A00&amp;precision=second" title="See timeline at 03/08/16 09:54:19">5 years ago</a> by markh
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-resolution">
      <strong class="trac-field-resolution">Resolution</strong>
        set to <em>fixed</em>
    </li><li class="trac-field-status">
      <strong class="trac-field-status">Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      <p>
closed by
<a class="ext-link" href="https://github.com/cf-convention/cf-conventions/pull/62"><span class="icon">​</span>https://github.com/cf-convention/cf-conventions/pull/62</a>
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="/trac/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="./93?format=rss" class="rss">RSS Feed</a>
        </li><li>
          <a rel="nofollow" href="./93?format=csv" class="csv">Comma-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="./93?format=tab" class="tab">Tab-delimited Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="https://trac.edgewall.org/"><img src="/trac/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="/trac/about"><strong>Trac 1.0.20</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the CF Metadata home page at<br /><a href="http://cf-convention.github.io">http://cf-convention.github.io</a><br><font color="#0000ff" size="3"><b>The CF Metadata Trac issue tracker is read-only and will soon be shut down permanently</b></font></p>
    </div>
  </body>
</html>
