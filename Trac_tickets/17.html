<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      #17 (Remove ambiguity in cell_methods, especially means over subgrid areas)
     – CF Metadata
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="/trac/search" />
        <link rel="prev" href="./16.html" title="ticket #16" />
        <link rel="last" href="./176.html" title="ticket #176" />
        <link rel="help" href="/trac/wiki/TracGuide" />
        <link rel="alternate" href="./17?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" /><link rel="alternate" href="./17?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="./17?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" />
        <link rel="next" href="./18.html" title="ticket #18" />
        <link rel="start" href="/trac/wiki" />
        <link rel="stylesheet" href="/trac/chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="/trac/chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="./1.html" title="ticket #1" />
        <link rel="shortcut icon" href="/trac/chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="/trac/chrome/common/trac.ico" type="image/x-icon" />
    <style id="trac-noscript" type="text/css">.trac-noscript { display: none !important }</style>
      <link type="application/opensearchdescription+xml" rel="search" href="/trac/search/opensearch" title="Search CF Metadata" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="b8aeac20bf7fd49b63339caa";
      var comments_prefs={"comments_only":"false","comments_order":"oldest"};
    </script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/folding.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/wikitoolbar.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/resizer.js"></script>
      <script type="text/javascript" charset="utf-8" src="/trac/chrome/common/js/auto_preview.js"></script>
    <script type="text/javascript">
      jQuery("#trac-noscript").remove();
      jQuery(document).ready(function($) {
        $(".trac-autofocus").focus();
        $(".trac-target-new").attr("target", "_blank");
        setTimeout(function() { $(".trac-scroll").scrollToTop() }, 1);
        $(".trac-disable-on-submit").disableOnSubmit();
      });
    </script>
    <script type="text/javascript" src="/trac/chrome/common/js/threaded_comments.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
      /*<![CDATA[*/
        $("#attachments").toggleClass("collapsed");
        $("#trac-up-attachments").click(function () {
          $("#attachments").removeClass("collapsed");
          return true;
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
        function setRevertHandler() {
          $("button.trac-revert").click(function() {
            var div = $("div", this);
            var field_name = div[0].id.substr(7);
            var field_value = div.text();
            var input = $("#propertyform *[name=field_" + field_name + "]");
            if (input.length > 0) {
              if (input.filter("input[type=radio]").length > 0) {
                input.val([field_value]);
              } else if (input.filter("input[type=checkbox]").length > 0) {
                input.val(field_value == "1" ? [field_value] : []);
              } else {
                input.val(field_value);
              }
            } else { // Special case for CC checkbox
              input = $("#propertyform input[name=cc_update]").val([]);
            }
            input.change();
            $(this).closest("li").remove();
            return false;
          });
        }
        setRevertHandler();
        var comment_focused = false;
        $("#comment").focus(function() { comment_focused = true; })
                     .blur(function() { comment_focused = false; });
        $("#propertyform").autoSubmit({preview: '1'}, function(data, reply) {
          var items = $(reply);
          // Update ticket box
          $("#ticket").replaceWith(items.filter('#ticket'));
          // Update changelog with original order
          $("#changelog").replaceWith(items.filter("#changelog"));
          // Reorder comments
          applyCommentsOrder(
            $('#prefs input[name="trac-comments-order"]:checked').val());
          // Show warning
          var new_changes = $("#changelog .trac-new");
          $("#trac-edit-warning").toggle(new_changes.length != 0);
          if (new_changes.length != 0)
            $("#changelog").parent().show().removeClass("collapsed");
          // Update view time
          $("#propertyform input[name='view_time']").replaceWith(items.filter("input[name='view_time']"));
          // Update preview
          var preview = $("#ticketchange").html(items.filter('#preview').children());
          var show_preview = preview.children().length != 0;
          $("#ticketchange").toggle(show_preview);
          setRevertHandler();
          // Collapse property form if comment editor has focus
          if (show_preview && comment_focused)
            $("#modify").parent().addClass("collapsed");
          // Execute scripts to load stylesheets
          items.filter("script").appendTo("head");
        }, "#ticketchange .trac-loading");
        $("#trac-comment-editor").autoSubmit({preview_comment: '1'}, function(data, reply) {
          var comment = $("#trac-comment-editor").next("div.comment").html(reply);
          comment.toggle(comment.children().length != 0);
        }, "#changelog .trac-loading");
        /*]]>*/
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://cf-trac.llnl.gov/trac"><img src="/trac/chrome/site/cf_logo.png" alt="CF Metadata Trac" height="80" width="400" /></a>
      </div>
      <form id="search" action="/trac/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="/trac/login">Login</a></li><li><a href="/trac/about">About Trac</a></li><li><a href="/trac/prefs">Preferences</a></li><li class="last"><a href="/trac/wiki/TracGuide">Help/Guide</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="/trac/query">View Tickets</a></li><li><a href="/trac/roadmap">Roadmap</a></li><li><a href="/trac/timeline">Timeline</a></li><li><a href="/trac/search">Search</a></li><li class="last"><a href="/trac/wiki">Wiki</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
        <ul>
          <li class="first"><span>&larr; <a class="prev" href="./16.html" title="ticket #16">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="./18.html" title="ticket #18">Next Ticket</a> &rarr;</span></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
        <div id="ticket" class="trac-content ">
  <div class="date">
    <p>Opened <a class="timeline" href="/trac/timeline?from=2007-10-23T01%3A41%3A07-07%3A00&amp;precision=second" title="See timeline at 10/23/07 01:41:07">14 years ago</a></p>
    <p>Closed <a class="timeline" href="/trac/timeline?from=2008-10-21T14%3A53%3A18-07%3A00&amp;precision=second" title="See timeline at 10/21/08 14:53:18">13 years ago</a></p>
  </div>
  <h2>
    <a href="./17.html" class="trac-id">#17</a>
    <span class="trac-status">
      <a href="/trac/query?status=closed">closed</a>
    </span>
    <span class="trac-type">
      <a href="/trac/query?status=!closed&amp;type=enhancement">enhancement</a>
    </span>
    <span class="trac-resolution">
      (<a href="/trac/query?status=closed&amp;resolution=fixed">fixed</a>)
    </span>
  </h2>
  <h1 id="trac-ticket-title" class="searchable">
    <span class="summary">Remove ambiguity in cell_methods, especially means over subgrid areas</span>
  </h1>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable"><a href="/trac/query?status=!closed&amp;reporter=jonathan">jonathan</a></td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner">cf-conventions@…</td>
    </tr>
    <tr>
        <th id="h_priority">
          Priority:
        </th>
        <td headers="h_priority">
              <a href="/trac/query?status=!closed&amp;priority=medium">medium</a>
        </td>
        <th id="h_milestone" class="missing">
          Milestone:
        </th>
        <td headers="h_milestone">
              <a class="missing milestone"></a>
        </td>
    </tr><tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="/trac/query?status=!closed&amp;component=cf-conventions">cf-conventions</a>
        </td>
        <th id="h_version" class="missing">
          Version:
        </th>
        <td headers="h_version">
              <a href="/trac/query?status=!closed&amp;version="></a>
        </td>
    </tr><tr>
        <th id="h_keywords" class="missing">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
        <th id="h_cc" class="missing">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
    </h3>
    <div class="searchable">
      <h2 id="a1.Title">1. Title</h2>
<p>
Remove ambiguity about statistics described by <tt>cell_methods</tt>, especially
means over subgrid areas
</p>
<h2 id="a2.Moderator">2. Moderator</h2>
<p>
Karl Taylor
</p>
<h2 id="a3.Requirement">3. Requirement</h2>
<p>
To indicate the portion of a cell over which a statistic has been calculated,
in situations where there is a need to distinguish between statistics
calculated for the same quantity over different portions of the cell, or where
the quantity might be considered to be undefined over some portion of the
cell. The statistic is usually a mean or a sum. The situation most often
arises with cells in the horizontal, where the "portions" are different types
of surface that don't have defined geographical boundaries. Some examples:
</p>
<ol><li><tt>sea_ice_thickness</tt> averaged over the area of sea ice, the area of sea, or
</li></ol><p>
the entire area of the cell including land. These can all be written as A/B,
where A is the total volume of sea ice in the cell, and B is the area of sea
ice, the area of sea or the area of the cell.
</p>
<ol start="2"><li><tt>surface_upward_sensible_heat_flux</tt> averaged over different surface types
</li></ol><p>
within the cell e.g. land, sea, land ice, forest. These might similarly be
written as A/B, A (in W) being the area-integral of the flux applying to the
given surface type, and B (in m2) either the area occupied by that type, or
the cell area.  Alternatively, this means the flux (W m-2) is expressed either
per unit area of the particular surface type, or per unit area of the grid
cell. When the values for different types are given per unit area of the cell,
the sum of these values over all types is the mean for the cell as a whole.
</p>
<ol start="3"><li><tt>surface_temperature</tt> averaged over different surface types within the
</li></ol><p>
cell.  This is only likely to be given as a average value for each surface
type i.e.  formally where B is the area of that type e.g. the temperature is
300 K over the land portion of the cell, 310 K over the forest portion.
</p>
<h2 id="a4.InitialStatementofTechnicalProposal">4. Initial Statement of Technical Proposal</h2>
<p>
In the standard_name guidelines, this issue is partly addressed by using
<tt>where</tt>-phrases. However, this approach is unclear and inadequate. It can't
indicate, for instance, whether the sensible heat flux applying to the land
portion of the box is expressed per unit area of land or per unit area of the
cell. The present proposal follows the one made on the email list in December
2006 <a class="ext-link" href="http://www.cgd.ucar.edu/pipermail/cf-metadata/2006/001449.html"><span class="icon">​</span>http://www.cgd.ucar.edu/pipermail/cf-metadata/2006/001449.html</a>. Following
our discussion in Paris in June 2007, the proposal extends the use of
<tt>cell_methods</tt> and coordinates to indicate subgrid variation more precisely,
and eliminates <tt>where</tt>-phrases from standard names.
</p>
<ol><li>If there is no <tt>cell_methods</tt> specified, the default interpretation for an
</li></ol><p>
intensive quantity is "point", which means a local value in area or an
instantaneous value in time, and "sum" for an extensive quantity, meaning the
sum over area or time in the cell. No change is proposed to this: it is
unproblematic, because point values and integrals do not involve dividing by
anything. It is undefined what value should be given if the quantity does not
exist e.g. for sea_ice_thickness where there is no sea ice, the value could be
zero or missing, as either would make sense for a point value.
</p>
<ol start="2"><li>Delete the existing standard names with where-phrases, making them aliases
</li></ol><p>
of names without the where-phrases. There are only nine of them at present:
</p>
<pre class="wiki">precipitation_flux_onto_canopy_where_land
surface_net_downward_radiative_flux_where_land
surface_snow_thickness_where_sea_ice
surface_temperature_where_land
surface_temperature_where_open_sea
surface_temperature_where_snow
surface_upward_sensible_heat_flux_where_sea
water_evaporation_flux_from_canopy_where_land
water_evaporation_flux_where_sea_ice
</pre><ol start="3"><li>Define a new <tt>standard_name</tt> of <tt>area_type</tt>, whose values could be any of
</li></ol><p>
the <tt>surface_cover</tt> types as well as any distinctions of horizontal area which
are not surface types, such as "cloud". It is not proposed to standardise the values of <tt>area_type</tt> at present, but they could be standardised later.
</p>
<ol start="4"><li>To provide for greater use of string-valued auxiliary coordinate variables,
</li></ol><p>
especially string-valued scalar coordinate variables:
</p>
<ul><li>To the end of the first paragraph of 6.1, append: Other purposes for string identifiers are also described in Section 6.1.1, "Geographic Regions", and Section 7.3.3, "Statistics applying to portions of cells".
</li></ul><ul><li>To the end of the second paragraph of 6.1, append: If a character variable has only one dimension (the length of the string), it is regarded as a string-valued scalar coordinate variable, analogous to a numeric scalar coordinate variable (Section 5.7).
</li></ul><ul><li>Modify the section on 6.1 in the conformance document to read: A variable of character type that is named by a coordinates attribute is a label variable. This variable must have one or two dimensions. The trailing (CDL order) or sole dimension is for the maximum string length. If there are two dimensions, the leading dimension (CDL order) must match one of those of the data variable.
</li></ul><ol start="5"><li>A <tt>cell_methods</tt> entry is generically of the form "<em>name</em>: [<em>name</em>:
</li></ol><p>
...]  <em>method</em>" (see CF 7.3), where <em>name</em>s are the names of dimensions,
scalar coordinate variables, or standard_names. Horizontal area-means are
indicated by "<em>lat</em>: <em>lon</em>: <tt>mean</tt>", if <em>lat</em> and <em>lon</em> are the
latitude and longitude dimensions. I propose to introduce a special <em>name</em>
of <tt>area</tt> to indicate horizontal area, so an area-mean can be written "<tt>area</tt>:
<tt>mean</tt>". This is more obvious and convenient.
</p>
<p>
To do this, modify the paragraph in 7.3 beginning "If a data value is
representative of variation over a combination of axes" by changing "a
longitude-latitude gridbox would have" to "... could have", and appending the
following:
</p>
<blockquote>
<p>
To indicate variation over horizontal area, a special name of <tt>area</tt> is permitted as an alternative to specifying a combination of dimensions. The common case of an area-mean in longitude-latitude gridboxes can thus be shown by <tt>cell_methods="area: mean"</tt>. If they are not longitude and latitude, the horizontal coordinate variables can be identified with <tt>axis</tt> attributes of <tt>X</tt> and <tt>Y</tt> (see Chapter 4, <em>Coordinate Types</em>).
</p>
</blockquote>
<ol start="6"><li>Since CF 7.3 on <em>Cell methods</em> is quite long, I propose
</li></ol><ul><li>To rename 7.3 as <em>Statistical variation within cells</em>. This title would explain more of what it is about and parallels the title of 7.4 on <em>Climatological statistics</em>.
</li></ul><ul><li>To insert subsection headings of 7.3.1 <em>Statistics for more than one axis</em> starting with the paragraph "If more than one ...", 7.3.2 <em>Recording the spacing of the original data and other information</em> starting "To indicate more precisely" and 7.3.4 <em>Use of standard names in cell methods</em> starting "The convention of specifying". (A new subsection on portions of cells will be inserted as 7.3.3 between the second and third existing subsections.)
</li></ul><ol start="7"><li>Insert a new subsection in CF 7.3 entitled <em>Statistics applying to
</em></li></ol><p>
portions of cells<em> before the paragraph beginning "The convention of
specifying", as follows:
</em></p>
<blockquote>
<p>
By default, the statistical method indicated by <tt>cell_methods</tt> is assumed to have been evaluated over the entire cell. Sometimes it is necessary to evaluate different values of a quantity for different portions of a cell. To indicate this, one of two conventions may be used.
</p>
</blockquote>
<blockquote>
<p>
The first convention is the more general. In this convention, a string-valued coordinate variable or string-valued scalar coordinate variable (see Section 6.1, "Labels") indicates the portion of the cell.  Variables with <tt>standard_names</tt> of <tt>land_cover</tt>, <tt>surface_cover</tt> or <tt>area_type</tt> are suitable. With this approach, a coordinate variable with dimension greater than one would allow values of a quantity to be given for various area types in one data variable, as is often needed in land surface models for example, since they deal with many types within each surface gridbox. In this convention, the <tt>cell_methods</tt> entry is of the form "<em>name</em>: <em>method</em>" as usual, where <em>name</em> could be <tt>area</tt>, but the statistical <em>method</em> applies to the selected portion of the cell only e.g. a mean over the sea-ice area.
</p>
</blockquote>
<blockquote>
<p>
The second convention is a shorthand for the commonest cases. In this convention, a <tt>cell_methods</tt> entry may be given of the form "<em>name</em>: <em>method</em> where <em>type</em>", in which <em>type</em> may be <tt>land</tt>, <tt>sea</tt>, <tt>sea_ice</tt>, or <tt>open_sea</tt> (sea area not occupied by sea ice). The phrase "where <em>type</em>" should be interpreted as exactly equivalent to supplying a scalar or size-one coordinate variable of <tt>area_type</tt> with value <em>type</em>.
</p>
</blockquote>
<blockquote>
<p>
Example. Means over land and sea.
</p>
</blockquote>
<pre class="wiki">dimensions:
  lat=73;
  lon=96;
  maxlen=20;
  lc2=2;
variables:
  float surface_temperature(lat,lon);
    surface_temperature:cell_methods="area: mean where land";
  float surface_upward_sensible_heat_flux(lc2,lat,lon);
    surface_upward_sensible_heat_flux:coordinates="land_cover2";
    surface_upward_sensible_heat_flux:cell_methods="area: mean";
  char land_cover2(lc2,maxlen);
data:
  land_cover2="land","sea";
</pre><blockquote>
<p>
In any case, other coordinate variables may also implicitly restrict the portion of the cell considered by the statistical method. For example, the horizontal area of the ocean decreases with increasing depth. An area-mean as a function of depth in the ocean is therefore formed over different areas at different depths. This is not indicated explicitly in <tt>cell_methods</tt>. As described in Section 7.3.4 "Use of standard names in cell methods", a labeled axis of <tt>region</tt> may restrict the portion of a latitude-longitude gridbox to be considered.
</p>
</blockquote>
<blockquote>
<p>
If the <em>method</em> is <tt>mean</tt>, the <tt>cell_methods</tt> entry may be further supplemented by the phrase "over <em>type</em>", where <em>type</em> can be <tt>land</tt>, <tt>sea</tt> or <tt>all</tt>, and <tt>all</tt> means the entire area of the cell. A <tt>cell_methods</tt> entry of the form "mean where <em>type1</em> over <em>type2</em>" indicates the mean is calculated by summing over the <em>type1</em> portion of the cell and dividing by the area of the <em>type2</em> portion. A <tt>cell_methods</tt> entry of the form "mean over <em>type</em>" indicates the mean is calculated by summing over the entire cell and dividing by the area of the <em>type</em> portion.
</p>
</blockquote>
<blockquote>
<p>
Example. Thickness of sea-ice and snow on sea-ice averaged over sea area.
</p>
</blockquote>
<pre class="wiki">variables:
  float snow_thickness(lat,lon);
    snow_thickness:cell_methods="area: mean where sea_ice over sea";
    snow_thickness:standard_name="lwe_thickness_of_surface_snow_amount";
    snow_thickness:units="m";
  float sea_ice_thickness(lat,lon);
    sea_ice_thickness:cell_methods="area: mean over sea";
    sea_ice_thickness:standard_name="sea_ice_thickness";
    sea_ice_thickness:units="m";
</pre><blockquote>
<p>
In the case of sea-ice thickness, it makes no difference to include "where sea_ice", since the sum over all sea area of sea-ice thickness is obviously the same as the sum over sea-ice area only. In the case of snow thickness, the "where" phrase does make a difference; it excludes snow on land from the average. Omitting the "over" phrase would mean that both quantities would be averages over the entire cell, not just the sea area.
</p>
</blockquote>
<ol start="8"><li>Modify the first bullet of the section on 7.3 in the conformance document
</li></ol><p>
as follows:
</p>
<blockquote>
<p>
The type of the <tt>cell_methods</tt> attribute is a string whose value is one or more blank separated word lists, each with the form
</p>
</blockquote>
<blockquote>
<p>
dim1: [dim2: [dim3: ...] ] method [where type1] [over type2] [within|over days|years] [(comment)]
</p>
</blockquote>
<blockquote>
<p>
where brackets indicate optional words. The valid values for <tt>dim1 [dim2 [dim3 ...] ]</tt> are dimension names of the associated variable, valid standard names, or the word <tt>area</tt>. The valid values of <tt>method</tt> are contained in Appendix D. The valid values for <tt>type1</tt> are <tt>land</tt>, <tt>sea</tt>, <tt>sea_ice</tt>, or <tt>open_sea</tt>. The valid values for <tt>type2</tt> are <tt>land</tt>, <tt>sea</tt> and <tt>all</tt>. When the method refers to a climatological time axis, the suffixes for <tt>within</tt> and <tt>over</tt> may be appended.
</p>
</blockquote>
<h2 id="a5.Benefits">5. Benefits</h2>
<p>
These clarifications will particularly benefit those providing or using data
from models, when it is important to be clear exactly how area-means have been
calculated. The current standard is unclear.
</p>
<h2 id="a6.StatusQuo">6. Status Quo</h2>
<p>
The necessary clarification could be recorded as a comment in () in the
<tt>cell_methods</tt>. This is not usually done, and even if it were done, generic
applications could not use it to distinguish the possibilities as it is not
standardised. For the CMIP3 database, PCMDI described how means should be
calculated e.g. whether sea ice thickness is calculated as the mean over sea
ice area or some other area; the prescription was not recorded in the netCDF
data produced, which is therefore not self-describing.
</p>

    </div>
  </div>
</div>
          
    <div id="attachments">
        <h3 class="foldable">Attachments <span class="trac-count">(1)</span></h3>
        <div class="attachments">
          <dl class="attachments">
              <dt>
    <a href="./attachments/cell_methods_june19.pdf" title="View attachment">cell_methods_june19.pdf</a><a href="./attachments/cell_methods_june19.pdf" class="trac-rawlink" title="Download">​</a>
       (<span title="53212 bytes">52.0 KB</span>) -
      added by <em>taylor13</em> <a class="timeline" href="/trac/timeline?from=2008-06-19T11%3A19%3A04-07%3A00&amp;precision=second" title="See timeline at 06/19/08 11:19:04">13 years ago</a>.
  </dt>
              <dd>
                <a class="closed ticket" href="./17.html" title="enhancement: Remove ambiguity in cell_methods, especially means over subgrid areas (closed: fixed)">#17</a> cell_methods text changes (word format)
              </dd>
          </dl>
          <p>
            Download all attachments as: <a rel="nofollow" href="/trac/zip-attachment/ticket/17/">.zip</a>
          </p>
          
        </div>
    </div>

        <div>
          <div class="trac-noscript" style="position: relative">
            <form id="prefs" method="get" action="/trac/prefs" style="position: absolute; right: 0">
              <div id="trac-comments-order">
                <input type="radio" id="trac-comments-oldest" name="trac-comments-order" value="oldest" checked="checked" />
                <label for="trac-comments-oldest">Oldest first</label>
                <input type="radio" id="trac-comments-newest" name="trac-comments-order" value="newest" />
                <label for="trac-comments-newest">Newest first</label>
                <span id="trac-threaded-toggle" style="display: none">
                  <input type="radio" id="trac-comments-threaded" name="trac-comments-order" value="threaded" />
                  <label for="trac-comments-threaded">Threaded</label>
                </span>
              </div>
              <div>
                <input id="trac-comments-only-toggle" type="checkbox" />
                <label for="trac-comments-only-toggle">Comments only</label>
              </div>
            </form>
          </div>
          <h3 class="foldable">Change History <span class="trac-count">(37)</span></h3>
          <div id="changelog">
              <div class="change" id="trac-change-1-1193135227000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:1" class="cnum">
    <a href="#comment:1">comment:1</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2007-10-23T03%3A27%3A07-07%3A00&amp;precision=second" title="See timeline at 10/23/07 03:27:07">14 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-summary">
      <strong class="trac-field-summary">Summary</strong>
        changed from <em>Remove ambiguity in by cell_methods, especially means over subgrid areas</em> to <em>Remove ambiguity in cell_methods, especially means over subgrid areas</em>
    </li>
  </ul>

              </div>
              <div class="change" id="trac-change-2-1196792174000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:2" class="cnum">
    <a href="#comment:2">comment:2</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:3" class="follow-up">↓ 3</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2007-12-04T10%3A16%3A14-08%3A00&amp;precision=second" title="See timeline at 12/04/07 10:16:14">13 years ago</a> by russ
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I believe "The valid values of <tt>method</tt> are contained in Appendix D." should be changed to reference Appendix E instead.
</p>
<p>
I'm not sure what change is being described in "8. Modify the first bullet of the section on 7.3 in the conformance document as follows:".  The first bullet I see in section 7.3 is 
</p>
<pre class="wiki">If the cell coordinate range cannot be precisely defined. For example, the Levitus ocean climatology uses any data that exists. It is a time mean but the time range is not well defined, so cannot be stated.
</pre><p>
Is it really intended to delete this bullet and instead substitute the three paragraphs starting "The type of the cell_methods attribute is a string whose value ..."?  If so, the substitute text does not seem to fit with the text preceding the bullet, which says "There are two reasons for doing this."
</p>
<p>
If the problems above are fixed, I approve these suggested changes.  They seem complex, but clarify the intended use of cell_methods.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3-1196793032000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:3" class="cnum">
    <a href="#comment:3">comment:3</a>
  </span>
        in reply to:
    <a href="#comment:2">↑ 2</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2007-12-04T10%3A30%3A32-08%3A00&amp;precision=second" title="See timeline at 12/04/07 10:30:32">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Russ
</p>
<p>
Thanks for looking at this proposal.
</p>
<blockquote class="citation">
<p>
I believe "The valid values of <tt>method</tt> are contained in Appendix D." should be changed to reference Appendix E instead.
</p>
</blockquote>
<p>
You are right. The conformance document currently says D, but it should be E.
</p>
<blockquote class="citation">
<p>
I'm not sure what change is being described in "8. Modify the first bullet of the section on 7.3 in the conformance document as follows:".
</p>
</blockquote>
<p>
This part of the proposal (item 8) is dealing with changes to the <em>conformance</em> document <a class="ext-link" href="http://cf-pcmdi.llnl.gov/conformance/requirements_recommendations/"><span class="icon">​</span>http://cf-pcmdi.llnl.gov/conformance/requirements_recommendations/</a>, not the CF <em>standard</em> document. Item 8 is changes to the conformance document to make it consistent with the modified standard document. I hope that answers your concern.
</p>
<blockquote class="citation">
<p>
If the problems above are fixed, I approve these suggested changes.
</p>
</blockquote>
<p>
Thanks.
</p>
<blockquote class="citation">
<p>
They seem complex, but clarify the intended use of cell_methods.
</p>
</blockquote>
<p>
They are complex to describe as a change, but I suspect they will not look so complicated when in place in the documents.
</p>
<p>
Cheers
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4-1196799835000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:4" class="cnum">
    <a href="#comment:4">comment:4</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2007-12-04T12%3A23%3A55-08%3A00&amp;precision=second" title="See timeline at 12/04/07 12:23:55">13 years ago</a> by russ
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Yes that addresses my concerns, thanks.
</p>
<p>
I'm embarrassed to admit, I wasn't even aware of the existence of the
"CF Conformance Requirements and Recommendations" document.  Now that
I've looked at it, it seems useful.  We should consider including a
link to it from our Conventions page in addition to the link to the CF
Conventions document.
</p>
<p>
--Russ
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5-1196992244000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:5" class="cnum">
    <a href="#comment:5">comment:5</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:6" class="follow-up">↓ 6</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2007-12-06T17%3A50%3A44-08%3A00&amp;precision=second" title="See timeline at 12/06/07 17:50:44">13 years ago</a> by taylor13
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I generally support this change to the convention.  There are a few items that I hope others will provide input on before we move forward:
</p>
<p>
1) With regard to 4.3 in the original ticket posting:  I'm a little confused.  It says "area_type, whose values could be any of ...."   Do you mean "area_type *which identifies variables* whose values could be any ..."?
</p>
<p>
2) The proposed new title for section 7.3 "Statistical variation within cells" is more descriptive than "Cell methods", but it seems inappropriate to characterize a "mean", which may be the most common cell method, as a "variation within cells".  Would one of the following be more accurate?  a) "Statistics characterizing cell quantity", or b) "Characterization of quantity within cells", or c) "Characterization of cell quantity".
</p>
<p>
3) In 4.7 of the the original ticket posting:  Concerning the second convention, I think "cloud" should be one of the allowable "types" along with land, sea, sea_ice, and open_sea.  I've seen, for example, model output with cloud water averaged over the entire grid cell and just over the cloud covered portion of the grid cell. This is common enough to warrant not having to define a scalar dimension (following the first convention in this section).
</p>
<p>
4) I think it would be helpful in the Example to expand on the description:  Mean surface temperature over land and sensible heat flux over land and sea. In any case, perhaps the variable name "land_cover2" should be renamed "land_sea" and land_sea should have a standard name attribute with the value "surface_cover" (not "land_cover").
</p>
<p>
5) In the paragraph following the first example, it would be helpful to mention that although "This is not indicated explicitly in cell_methods", the information can be stored by the use of bounds attached to scalar coordinates for longitude and latitude.
</p>
<p>
6)  In the paragraph following the first example, I am confused by the statement beginning "As described in Section 7.3.4 ...."  I also think we need to work on section 7.3 itself because it took me a long time to figure out what the point was, even though I knew this at one time (a few years ago).
</p>
<p>
7)  I think we should add to the "types" allowed in the "over type" construction the following: open_sea, sea_ice, and cloud.  Also, we should note that if the "over type" suffix is omitted, it is assumed to be over the area specified in the "where type" specification.
</p>
<p>
8)  How would one specify "over cloud-free land"?
</p>
<p>
Thanks to you all for you patience.  I hope to soon contribute to improving some of the parts I found confusing, rather than just saying they were confusing, but this is all for now.
</p>
<p>
Karl
</p>

    </div>

              </div>
              <div class="change" id="trac-change-6-1197542855000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:6" class="cnum">
    <a href="#comment:6">comment:6</a>
  </span>
        in reply to:
    <a href="#comment:5">↑ 5</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2007-12-13T02%3A47%3A35-08%3A00&amp;precision=second" title="See timeline at 12/13/07 02:47:35">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Karl
</p>
<p>
Thanks for your comments and support.
</p>
<blockquote class="citation">
<p>
1) With regard to 4.3 in the original ticket posting:  I'm a little confused.  It says "area_type, whose values could be any of ...."   Do you mean "area_type *which identifies variables* whose values could be any ..."?
</p>
</blockquote>
<p>
This is the bit that says, "Define a new <tt>standard_name</tt> of <tt>area_type</tt>, whose values could be any of the <tt>surface_cover</tt> types." What I meant is that a variable (probably a coordinate variable) whose standard name is <tt>area_type</tt> may have any of the values that a variable whose standard name is <tt>surface_type</tt> could have, such as <tt>sea</tt>, <tt>sea_ice</tt>, <tt>land</tt>, <tt>vegetation</tt>, <tt>forest</tt>, <tt>broadleaf_tree</tt>. The possible values aren't standardised at present, as I commented. <tt>area_type</tt> is proposed to be more general than <tt>surface_type</tt>, because it could also be used for distinctions of horizontal area which are not surface types, such as <tt>cloud</tt>.
</p>
<blockquote class="citation">
<p>
2) The proposed new title for section 7.3 "Statistical variation within cells" is more descriptive than "Cell methods", but it seems inappropriate to characterize a "mean", which may be the most common cell method, as a "variation within cells".  Would one of the following be more accurate?  a) "Statistics characterizing cell quantity", or b) "Characterization of quantity within cells", or c) "Characterization of cell quantity".
</p>
</blockquote>
<p>
The whole of CF 7 is entitled "Data representative of cells", so maybe we could call 7.3 "Statistical methods" (a bit clearer than the current "Cell methods"). "Mean" is certainly a statistic.
</p>
<blockquote class="citation">
<p>
3) In 4.7 of the the original ticket posting:  Concerning the second convention, I think "cloud" should be one of the allowable "types" along with land, sea, sea_ice, and open_sea.  I've seen, for example, model output with cloud water averaged over the entire grid cell and just over the cloud covered portion of the grid cell. This is common enough to warrant not having to define a scalar dimension (following the first convention in this section).
</p>
</blockquote>
<p>
I sympathise, but I'm not convinced. I think we should try to limit the proliferation of area types that could receive this favoured treatment. Actually I had considered not allowing the shorthands (of the kind "area: mean over land") at all, but I thought that the land/sea/sea_ice/open_sea ones are particularly commonly used because there are submodels for land, ocean and sea ice. For these submodels, all output quantities might have to specify the area type, so it seems a worthwhile convenience to allow it to be done in <tt>cell_methods</tt>. In other cases, such as cloud, it is not necessary to define a dimension of size one. It can be done with a scalar coordinate variable, not requiring any dimension (except the length of the string).
 
</p>
<blockquote class="citation">
<p>
4) I think it would be helpful in the Example to expand on the description:  Mean surface temperature over land and sensible heat flux over land and sea. In any case, perhaps the variable name "land_cover2" should be renamed "land_sea" and land_sea should have a standard name attribute with the value "surface_cover" (not "land_cover").
</p>
</blockquote>
<p>
Thanks - good suggestions.
</p>
<blockquote>
<p>
Example. Mean surface temperature over land and sensible heat flux meaned separately over land and sea.
</p>
</blockquote>
<pre class="wiki">
dimensions:
  lat=73;
  lon=96;
  maxlen=20;
  ls=2;
variables:
  float surface_temperature(lat,lon);
    surface_temperature:cell_methods="area: mean where land";
  float surface_upward_sensible_heat_flux(ls,lat,lon);
    surface_upward_sensible_heat_flux:coordinates="land_sea";
    surface_upward_sensible_heat_flux:cell_methods="area: mean";
  char land_sea(ls,maxlen);
    land_sea:standard_name="area_type";
data:
  land_sea="land","sea";

</pre><blockquote class="citation">
<p>
5) In the paragraph following the first example, it would be helpful to mention that although "This is not indicated explicitly in cell_methods", the information can be stored by the use of bounds attached to scalar coordinates for longitude and latitude.
</p>
</blockquote>
<p>
That's not what I meant. The horizontal coordinates and their bounds are independent of level, but the actual area (of non-missing data) of the ocean is a function of level. Hence the "area: mean over sea" is implicitly a mean over an area which varies as a function of level.
</p>
<blockquote class="citation">
<p>
6)  In the paragraph following the first example, I am confused by the statement beginning "As described in Section 7.3.4 ...."  I also think we need to work on section 7.3 itself because it took me a long time to figure out what the point was, even though I knew this at one time (a few years ago).
</p>
</blockquote>
<p>
Perhaps this could be addressed by expanding the examples. I would propose the following text:
</p>
<blockquote>
<p>
The convention of specifying a cell method for a standard name, rather than for the dimension of a coordinate variable, is to allow one to provide an indication that a particular cell method is relevant to the data without having to provide a precise description of the corresponding cell. There are two reasons for doing this.
</p>
</blockquote>
<ul><li>If the cell coordinate range cannot be precisely defined. For example, the Levitus ocean climatology uses any data that exists. It is a time mean but the time range is not well defined, so cannot be stated. This could be indicated by a <tt>cell_methods</tt> entry of <tt>time: mean</tt>, where <tt>time</tt> appears as a <tt>standard_name</tt>, and there is no dimension or coordinate variable with this name.
</li></ul><ul><li>For convenience, if the cell extends over all valid coordinates. This is permitted only for the standard names <tt>longitude</tt> and <tt>latitude</tt>. Methods specified for these standard names are assumed to apply to the complete range of longitude and latitude respectively. If in addition the data variable has a dimension with a corresponding labeled axis that specifies a geographic region Section 6.1.1, "Geographic Regions", the implied range of longitude and latitude is the valid range for each specified region. For example, there could be a <tt>cell_methods</tt> entry of <tt>longitude: mean</tt>, where <tt>longitude</tt> appears as <tt>standard_name</tt> and is not the name of a dimension or coordinate variable. That would indicate a mean over all longitudes. But if in addition the data variable had a scalar coordinate variable with a <tt>standard_name</tt> of <tt>region</tt> and a value of <tt>atlantic_ocean</tt>, it would indicate a mean over longitudes that lie within the Atlantic Ocean, not all longitudes.
</li></ul><blockquote class="citation">
<p>
7)  I think we should add to the "types" allowed in the "over type" construction the following: open_sea, sea_ice, and cloud.  Also, we should note that if the "over type" suffix is omitted, it is assumed to be over the area specified in the "where type" specification.
</p>
</blockquote>
<p>
I'd be happy with <tt>open_sea</tt> and <tt>sea_ice</tt> for consistency with the set of types allowed after <tt>where</tt>. I don't think we should allow <tt>cloud</tt>, as in your point 3.
</p>
<p>
Your second point is what I mean by this text: A cell_methods entry of the form "<em>mean</em> over <em>type</em>" indicates the mean is calculated by summing over the entire cell and dividing by the area of the <em>type</em> portion.
</p>
<blockquote class="citation">
<p>
8)  How would one specify "over cloud-free land"?
</p>
</blockquote>
<p>
At present, values of <tt>area_type</tt> are not standardised, so you could have a scalar coordinate variable with a <tt>standard_name</tt> of <tt>area_type</tt> and a value of <tt>cloud_free_land</tt>. If/when we standardise the area types, we'll have to decide a method for combining them with and/or, I suppose, or introduce further distinctions in standard names between surface types and non-surface types. For the moment, I think the unstandardised mechanism is sufficient to provide useful metadata, though I'm sure particular projects might propose standardisations for their own purposes.
</p>
<p>
Cheers
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7-1197996892000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:7" class="cnum">
    <a href="#comment:7">comment:7</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:8" class="follow-up">↓ 8</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2007-12-18T08%3A54%3A52-08%3A00&amp;precision=second" title="See timeline at 12/18/07 08:54:52">13 years ago</a> by bnl
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Just a few points (so far), I'm broadly in agreement, but finding it hard to digest in detail.
</p>
<ol><li>I think cell_methods as a section title is more useful than any of the proposed alternatives. I'm not convinced this needs changing.
</li><li>But I agree that the subsections would add value.
</li><li>I think the introduction of area_type is a difficult thing to follow. That said, I think it's analogous to a cell_method itself, and we should control the vocabulary from the start. Would it be simpler to have the standard_name indicate what it's for straight away: rather than area_type, have cell_area_type? 
<ul><li>And immediately add to the standard_names, the concept of allowed values (a controlled enumeration). I think the enumerated values themselves need definition (which is to some extent what we had when we had where clauses in the standard names).
</li></ul></li></ol><p>
Then
</p>
<pre class="wiki">dimensions:
  lat=73;
  lon=96;
  maxlen=20;
  ls=2;
variables:
  float surface_temperature(lat,lon);
    surface_temperature:cell_methods="area: mean where land";
  float surface_upward_sensible_heat_flux(ls,lat,lon);
    surface_upward_sensible_heat_flux:coordinates="land_sea";
    surface_upward_sensible_heat_flux:cell_methods="area: mean";
  char land_sea(ls,maxlen);
    land_sea:standard_name="cell_area_type";
data:
  land_sea="land","sea";
</pre><p>
and both "land" and "sea" exist and are defined in a controlled enumeration. 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8-1198000597000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:8" class="cnum">
    <a href="#comment:8">comment:8</a>
  </span>
        in reply to:
    <a href="#comment:7">↑ 7</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2007-12-18T09%3A56%3A37-08%3A00&amp;precision=second" title="See timeline at 12/18/07 09:56:37">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Bryan
</p>
<p>
Thanks for your comments (so far).
</p>
<blockquote class="citation">
<p>
I'm broadly in agreement
</p>
</blockquote>
<p>
Good
</p>
<blockquote class="citation">
<p>
but finding it hard to digest in detail.
</p>
</blockquote>
<p>
Yes, it is not trivial!
</p>
<blockquote class="citation">
<blockquote>
<p>
I think cell_methods as a section title is more useful than any of the proposed alternatives. I'm not convinced this needs changing.
</p>
</blockquote>
</blockquote>
<p>
OK. I don't feel strongly.
</p>
<blockquote class="citation">
<blockquote>
<p>
I think the introduction of area_type is a difficult thing to follow. Would it be simpler to have the standard_name indicate what it's for straight away: rather than area_type, have cell_area_type?
</p>
</blockquote>
</blockquote>
<p>
I don't think that would be quite correct. The <tt>area_type</tt> is a property of <em>part</em> of the cell (that's the point of it when used as a coordinate) not the whole cell.
</p>
<blockquote class="citation">
<p>
We should control the vocabulary from the start. Immediately add to the standard_names, the concept of allowed values (a controlled enumeration). I think the enumerated values themselves need definition.
</p>
</blockquote>
<p>
OK. We could provide an initial list of possible values and accept proposals for new values via the email list, like standard names. For the initial list, I would propose <tt>land</tt>, <tt>sea</tt>, <tt>sea_ice</tt>, <tt>open_sea</tt>, <tt>cloud</tt>, <tt>clear_sky</tt>, <tt>vegetation</tt>, <tt>bare_ground</tt>, <tt>land_ice</tt>.
</p>
<p>
At the moment the standard doesn't say anything about controlled values for standard names, so I propose the following addition to Section 3.3, at the end of the paragraph which begins "The standard name table is located at":
</p>
<blockquote>
<p>
Some standard names (e.g. <tt>region</tt> and <tt>area_type</tt>) are used to indicate quantities which are permitted to take only certain standard values. This is indicated in the definition of the quantity in the standard name table, accompanied by a list or a link to a list of the permitted values.
</p>
</blockquote>
<p>
Cheers
</p>
<p>
Jonathan
 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-9-1198489013000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:9" class="cnum">
    <a href="#comment:9">comment:9</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:10" class="follow-up">↓ 10</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2007-12-24T01%3A36%3A53-08%3A00&amp;precision=second" title="See timeline at 12/24/07 01:36:53">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I wonder whether it would be a good idea to <em>recommend</em> that <tt>cell_methods</tt> always be included, even when the default (<tt>point</tt> for intensive, <tt>sum</tt> for <tt>extensive</tt>) applies? The CF-checker would then produce a warning for any data variable which did not have <tt>cell_methods</tt> for any of its dimensions. Would that be useful or irritating?
</p>
<p>
The advantages of making such a recommendation could include:
</p>
<ol><li>The default might not be obvious, because it takes a bit of thought and knowledge to work out whether a quantity is intensive or extensive.
</li></ol><ol start="2"><li>Many quantities are actually area-means, so <tt>cell_methods</tt> <em>should</em> be included, but often is not.
</li></ol><ol start="3"><li>This is particularly important for quantities applying to only the land, or only the sea, portion of a grid-cell. Such means should routinely include a <tt>cell_methods</tt> entry of <tt>area: mean over land</tt> or <tt>area: mean over sea</tt> to make the intention clear.
</li></ol><p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10-1198490660000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:10" class="cnum">
    <a href="#comment:10">comment:10</a>
  </span>
        in reply to:
    <a href="#comment:9">↑ 9</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2007-12-24T02%3A04%3A20-08%3A00&amp;precision=second" title="See timeline at 12/24/07 02:04:20">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="./17#comment:9" title="Comment 9">jonathan</a>:
</p>
<blockquote class="citation">
<ol start="3"><li>This is particularly important for quantities applying to only the land, or only the sea, portion of a grid-cell. Such means should routinely include a <tt>cell_methods</tt> entry of <tt>area: mean over land</tt> or <tt>area: mean over sea</tt> to make the intention clear.
</li></ol></blockquote>
<p>
Sorry, that should have been <tt>area: mean where land</tt> or <tt>area: mean where sea</tt> i.e. integrate over the land or sea area and then divide by that area. That is the correct description, for example, for the mean surface temperature in the sea portion of a grid-cell. The fact that I made this mistake indicates there's an ambiguity about <tt>where</tt> and <tt>over</tt>, so I'd like to suggest this slightly changed version of the proposed syntax for means:
</p>
<blockquote>
<p>
mean [where <em>type1</em> [over <em>type2</em>]]
</p>
</blockquote>
<blockquote>
<p>
i.e. <tt>over</tt> can appear only if <tt>where</tt> appears. <em>type1</em> and <em>type2</em> can be <tt>land</tt>, <tt>sea</tt>, <tt>sea_ice</tt>, <tt>open_sea</tt> or <tt>all</tt>. A  cell_methods entry of the form "mean where <em>type</em>" indicates the mean is calculated by summing over the <em>type</em> portion of the cell and dividing by the area of this  portion. A <tt>cell_methods</tt> entry of the form "mean where <em>type1</em> over <em>type2</em>" indicates the mean is calculated by summing over the <em>type1</em> portion of the cell and dividing by the area of the <em>type2</em> portion. A cell_methods entry of the form "mean where all over <em>type</em>" indicates the mean is calculated by summing over the entire cell and dividing by the area of the <em>type</em> portion.
</p>
</blockquote>
<p>
I hope that is clearer. I believe that all three forms are needed, though the last is less common.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11-1200042120000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:11" class="cnum">
    <a href="#comment:11">comment:11</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:13" class="follow-up">↓ 13</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-01-11T01%3A02%3A00-08%3A00&amp;precision=second" title="See timeline at 01/11/08 01:02:00">13 years ago</a> by Heinke
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Jonathan,
thank you for this proposal.
This looks very good but I like to add some
valid values for type1.
snow (e.g. surface_temperature where snow)
glaciers (e.g. surface albedo where glaciers)
canopy (e.g. snow_depth where canopy or C-Pool for fastly respirated soil organic material where canopy)
lake (or is sea=open_sea+lakes?)
</p>
<p>
Best whishes 
Heinke
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12-1201098304000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:12" class="cnum">
    <a href="#comment:12">comment:12</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:14" class="follow-up">↓ 14</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-01-23T06%3A25%3A04-08%3A00&amp;precision=second" title="See timeline at 01/23/08 06:25:04">13 years ago</a> by apamment
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I support this proposal.  The current convention of using where-phrases in standard names is ambiguous and a more precise method of describing subgrid statistical processing is needed.
</p>
<p>
The numbering in the following comments refers to the numbering in the original proposal.
</p>
<p>
4.2 I think the standard name aliases can be introduced without problem provided the explanations of the names without where-phrases are expanded to cover the use of the where-phrase in any existing data.  In the case of precipitation_flux_onto_canopy_where_land a new name, precipitation_flux_onto_canopy, would first need to be introduced so that the alias can be created.  That can easily be done.
</p>
<p>
4.3 There will be a number of standard names - surface_cover, land_cover and the proposed area_type - all essentially performing the same function, i.e. to identify a character or flag variable describing the nature of a portion of a grid_cell.  Surface_cover is already a generalisation of land_cover and it seems to me that area_type is a further generalisation of the same concept.  I suggest deleting surface_cover and land_cover and making them both aliases of area_type.  Having one standard name for this type of information seems less confusing.
</p>
<p>
4.5 I agree with the suggestion to introduce the name of 'area' into cell methods to indicate horizontal area.  I think it is clearer than the existing convention of specifying the  dimensions separately and that it should become the recommended way of specifying the information.  Thus I suggest changing the wording of the proposal from "To indicate variation over a horizontal area a special name of 'area' is permitted as an alternative ..." to "To indicate variation over a horizontal area it is recommended that a special name of 'area' is used ...".
</p>
<p>
4.6 I agree with Bryan's comment that it would be better to retain the section heading of "Cell methods" and that the introduction of sub-headings is useful.
</p>
<p>
4.7 In the second convention the use of 'where' and 'over' to specify which portions of the cell are being summed over and divided by is very clear and useful.  I confess I don't really understand the need to restrict this convention to only the commonest cases of land, sea, sea_ice and open_sea - why not allow it for all area_types, especially if we follow the suggestion of standardising the allowed values of area_type?
</p>
<p>
I don't think that the general (first) convention is as clear as the second.  The area_type is specified in a string-valued coordinate variable or string-valued scalar coordinate variable and I can see that this would be useful if many surface types exist in a single grid cell.  However, is the area_type given in the coordinate variable the area that is being summed over or divided by (or both)?  Unless I have misunderstood, it seems to me that this approach suffers from the same ambiguities as the existing standard names.
</p>
<p>
I agree with your proposal to recommend the use of cell_methods.  My experience is that people don't find the distinction between intensive and extensive variables to be particularly obvious.
</p>
<p>
Alison
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13-1201879412000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:13" class="cnum">
    <a href="#comment:13">comment:13</a>
  </span>
        in reply to:
    <a href="#comment:11">↑ 11</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-02-01T07%3A23%3A32-08%3A00&amp;precision=second" title="See timeline at 02/01/08 07:23:32">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Heinke
</p>
<blockquote class="citation">
<p>
I like to add some valid values for type1
</p>
</blockquote>
<p>
I would like to limit the number of "special" types that are allowed to appear in "<tt>where</tt> <em>type</em>" as I think this is just a shorthand for the commonest types. The shorthand is provided in order to avoid the need for a coordinate variable in those cases. Instead, I would suggest adding <tt>snow</tt> to the list of possible values of an <tt>area_type</tt> variable. I have already suggested <tt>land_ice</tt> in that list, which should be OK for glaciers (or do you want to distinguish glaciers from ice-sheets?).
</p>
<p>
I am not sure about "canopy". I think that for lying snow, we would distinguish between "surface snow" and "snow on canopy". You can have both in the same spot, so arguably these are not distinguished by area type. In your example of soil respiration, do you mean that the respiration rate may be distinguished between areas of ground beneath the canopy, and areas that can see the sky? In that case, I agree, we would need <tt>canopy</tt> as an <tt>area_type</tt>.
</p>
<p>
Rivers and lakes raise another difficulty which has come up before. We do not have standard names for lake water temperature, lake water velocity, lake ice thickness etc. and the same for rivers. In principle all the same quantities are needed for rivers and lakes as for sea, and it would ugly to copy them all, I think, especially as the distinction may not always be clear and could be inconvenient to draw among river, lake and sea. Can we understand "sea" to include river and lake? I can't think of a word which means "sea, river or lake"!
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-14-1201880668000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:14" class="cnum">
    <a href="#comment:14">comment:14</a>
  </span>
        in reply to:
    <a href="#comment:12">↑ 12</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-02-01T07%3A44%3A28-08%3A00&amp;precision=second" title="See timeline at 02/01/08 07:44:28">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Alison
</p>
<blockquote class="citation">
<p>
4.2 I think the standard name aliases can be introduced without problem provided the explanations of the names without where-phrases are expanded to cover the use of the where-phrase in any existing data.  In the case of precipitation_flux_onto_canopy_where_land a new name, precipitation_flux_onto_canopy, would first need to be introduced so that the alias can be created.
</p>
</blockquote>
<p>
Thanks for noting that.
</p>
<blockquote class="citation">
<p>
4.3 There will be a number of standard names - surface_cover, land_cover and the proposed area_type - all essentially performing the same function, i.e. to identify a character or flag variable describing the nature of a portion of a grid_cell.  Surface_cover is already a generalisation of land_cover and it seems to me that area_type is a further generalisation of the same concept.  I suggest deleting surface_cover and land_cover and making them both aliases of area_type.  Having one standard name for this type of information seems less confusing.
</p>
</blockquote>
<p>
OK, good idea.
</p>
<blockquote class="citation">
<p>
4.5 I agree with the suggestion to introduce the name of 'area' into cell methods to indicate horizontal area.  I think it is clearer than the existing convention of specifying the  dimensions separately and that it should become the recommended way of specifying the information.  Thus I suggest changing the wording of the proposal from "To indicate variation over a horizontal area a special name of 'area' is permitted as an alternative ..." to "To indicate variation over a horizontal area it is recommended that a special name of 'area' is used ...".
</p>
</blockquote>
<p>
OK.
 
</p>
<blockquote class="citation">
<p>
4.6 I agree with Bryan's comment that it would be better to retain the section heading of "Cell methods" and that the introduction of sub-headings is useful.
</p>
</blockquote>
<p>
OK. I don't mind.
 
</p>
<blockquote class="citation">
<p>
4.7 In the second convention the use of 'where' and 'over' to specify which portions of the cell are being summed over and divided by is very clear and useful.  I confess I don't really understand the need to restrict this convention to only the commonest cases of land, sea, sea_ice and open_sea - why not allow it for all area_types, especially if we follow the suggestion of standardising the allowed values of area_type?
I don't think that the general (first) convention is as clear as the second.  The area_type is specified in a string-valued coordinate variable or string-valued scalar coordinate variable and I can see that this would be useful if many surface types exist in a single grid cell.  However, is the area_type given in the coordinate variable the area that is being summed over or divided by (or both)?  Unless I have misunderstood, it seems to me that this approach suffers from the same ambiguities as the existing standard names.
</p>
</blockquote>
<p>
The reason I propose to limit the use of the shorthand is that involves listing the possible values of keywords that can appear in <tt>cell_methods</tt>, and we should keep the number of possibilities to a minimum, I feel. All the keywords in the CF standard have a possible set of values which are listed explicitly in the standard. Of course, we could allow a reference to an external list, but the coordinate variable is a more general approach which already has that kind of machinery via the standard name table.
</p>
<p>
However, you are right that the coordinate variable approach doesn't have the same generality for means as the shorthand approach, so I now propose to generalise it thus: In the syntax "<tt>mean</tt> [<tt>where</tt> <em>type1</em> [<tt>over</tt> <em>type2</em>]]", <em>type1</em> and <em>type2</em> can be one of the permitted values or the name of a coordinate or auxiliary coordinate variable with <tt>standard_name</tt> of <tt>area_type</tt>. Then all the same kinds of means can be evaluated, and since coordinate variables can be multivalued, it permits all sorts of combinations of A and B in evaluating the mean as A/B. Is that OK?   
</p>
<blockquote class="citation">
<p>
I agree with your proposal to recommend the use of cell_methods.  My experience is that people don't find the distinction between intensive and extensive variables to be particularly obvious.
</p>
</blockquote>
<p>
OK, good.
</p>
<p>
Cheers
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-15-1201953652000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:15" class="cnum">
    <a href="#comment:15">comment:15</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:25" class="follow-up">↓ 25</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-02-02T04%3A00%3A52-08%3A00&amp;precision=second" title="See timeline at 02/02/08 04:00:52">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Many useful suggestions have been made, so here I restate the current form of the proposed changes to the documents following the discussion in this ticket. This supersedes section 4 (technical statement of the proposal) of the first entry of this ticket. In responding to Alison's suggestion, I have changed the proposal so that there is always a where-phrase in the cell_methods when a method applies to area-types.
</p>
<ol><li>Delete the existing standard names with where-phrases, making them aliases of names without the where-phrases:
</li></ol><pre class="wiki">precipitation_flux_onto_canopy_where_land
surface_net_downward_radiative_flux_where_land
surface_snow_thickness_where_sea_ice
surface_temperature_where_land
surface_temperature_where_open_sea
surface_temperature_where_snow
surface_upward_sensible_heat_flux_where_sea
water_evaporation_flux_from_canopy_where_land
water_evaporation_flux_where_sea_ice
</pre><p>
The standard name <tt>precipitation_flux_onto_canopy</tt> is an addition to the table. The others exist already.
</p>
<ol start="2"><li>In Section 3.3, add the following to the end of the paragraph which begins "The standard name table is located at":
</li></ol><blockquote>
<p>
Some standard names (e.g. <tt>region</tt> and <tt>area_type</tt>) are used to indicate quantities which are permitted to take only certain standard values. This is indicated in the definition of the quantity in the standard name table, accompanied by a list or a link to a list of the permitted values.
</p>
</blockquote>
<ol start="3"><li>Define a new <tt>standard_name</tt> of <tt>area_type</tt>, to indicate distinctions of horizontal area within cells. Make the existing standard names of <tt>land_cover</tt> and <tt>surface_type</tt> into aliases of <tt>area_type</tt>. Variables with <tt>standard_name</tt> of <tt>area_type</tt> must have one of the values listed in a special table. The initial list of values in that table is: <tt>land sea sea_ice open_sea cloud clear_sky vegetation bare_ground land_ice snow</tt>. Additions to this table will be requested on the CF email list.
</li></ol><ol start="4"><li>To provide for greater use of string-valued auxiliary coordinate variables, especially string-valued scalar coordinate variables:
</li></ol><ul><li>To the end of the first paragraph of 6.1, append: Other purposes for string identifiers are also described in Section 6.1.1, "Geographic Regions", and Section 7.3.3, "Statistics applying to portions of cells".
</li></ul><ul><li>To the end of the second paragraph of 6.1, append: If a character variable has only one dimension (the length of the string), it is regarded as a string-valued scalar coordinate variable, analogous to a numeric scalar coordinate variable (Section 5.7).
</li></ul><ul><li>Modify the section on 6.1 in the conformance document to read: A variable of character type that is named by a coordinates attribute is a label variable. This variable must have one or two dimensions. The trailing (CDL order) or sole dimension is for the maximum string length. If there are two dimensions, the leading dimension (CDL order) must match one of those of the data variable.
</li></ul><ol start="5"><li>Append to the second paragraph of 7.3, which begins "The default interpretation ...", as follows: "Usually cell values for intensive quantities are means, and this should be indicated explicitly in <tt>cell_methods</tt>. Because of this, and because the default interpretation, depending on the distinction between intensive and extensive, may not be obvious to the user of the data, it is recommended that every data variable should have a <tt>cell_methods</tt> attribute containing an entry for each of its dimensions and scalar coordinate variables for which it is meaningful. It is especially recommended for spatiotemporal dimensions and scalar coordinate variables."
</li></ol><ol start="6"><li>Modify the paragraph in 7.3 beginning "If a data value is representative of variation over a combination of axes" by changing "a longitude-latitude gridbox would have" to "... could have", and appending the following:
</li></ol><blockquote>
<p>
To indicate variation over horizontal area, it is recommended to use the special name of <tt>area</tt> instead of specifying a combination of dimensions. The common case of an area-mean in longitude-latitude gridboxes can thus be shown by <tt>cell_methods="area: mean"</tt>. If they are not longitude and latitude, the horizontal coordinate variables can be identified with <tt>axis</tt> attributes of <tt>X</tt> and <tt>Y</tt> (see Chapter 4, <em>Coordinate Types</em>).
</p>
</blockquote>
<ol start="7"><li>Insert subsection headings of 7.3.1 <em>Statistics for more than one axis</em> starting with the paragraph "If more than one ...", 7.3.2 <em>Recording the spacing of the original data and other information</em> starting "To indicate more precisely" and 7.3.4 <em>Cell methods specified when there are no coordinates</em> starting "The convention of specifying". (A new subsection on portions of cells will be inserted as 7.3.3 between the second and third existing subsections.)
</li></ol><ol start="8"><li>Insert a new subsection in CF 7.3 entitled <em>Statistics applying to portions of cells</em> before the paragraph beginning "The convention of specifying", as follows:
</li></ol><blockquote>
<p>
By default, the statistical method indicated by <tt>cell_methods</tt> is assumed to have been evaluated over the entire cell. Sometimes it is necessary to evaluate different values of a quantity for different portions of a cell. To indicate this, one of two conventions may be used.
</p>
</blockquote>
<blockquote>
<p>
The first convention is the more general. In this convention, a string-valued auxiliary coordinate variable or string-valued scalar coordinate variable (see Section 6.1, "Labels") with a <tt>standard_name</tt> of <tt>area_type</tt> indicates the portion of the cell. With this approach, a coordinate variable with dimension greater than one would allow values of a quantity to be given for various area types in one data variable, as is often needed in land surface models for example, since they deal with many types within each surface gridbox. In this convention, the <tt>cell_methods</tt> entry is of the form "<em>name</em>: <em>method</em> <tt>where</tt> <em>typevar</em>", where <em>name</em> could be <tt>area</tt> and <em>typevar</em> is the name of the <tt>area_type</tt> variable. The statistical <em>method</em> applies to the selected portion of the cell only e.g. a mean over the sea-ice area.
</p>
</blockquote>
<blockquote>
<p>
The second convention is a shorthand for the commonest cases. In this convention, a <tt>cell_methods</tt> entry may be given of the form "<em>name</em>: <em>method</em> where <em>type</em>", in which <em>type</em> may be <tt>land</tt>, <tt>sea</tt>, <tt>sea_ice</tt>, or <tt>open_sea</tt> (sea area not occupied by sea ice). The phrase "where <em>type</em>" should be interpreted as exactly equivalent to supplying a scalar or size-one coordinate variable of <tt>area_type</tt> with value <em>type</em>. If <em>type</em> is also the name of a variable in the netCDF file, it is nonetheless interpreted as a keyword, i.e. the second convention takes precedence over the first convention.
</p>
</blockquote>
<blockquote>
<p>
Example. Mean surface temperature over land and sensible heat flux meaned separately over land and sea.
</p>
</blockquote>
<pre class="wiki">
dimensions:
  lat=73;
  lon=96;
  maxlen=20;
  ls=2;
variables:
  float surface_temperature(lat,lon);
    surface_temperature:cell_methods="area: mean where land";
  float surface_upward_sensible_heat_flux(ls,lat,lon);
    surface_upward_sensible_heat_flux:coordinates="land_sea";
    surface_upward_sensible_heat_flux:cell_methods="area: mean where ls";
  char land_sea(ls,maxlen);
    land_sea:standard_name="area_type";
data:
  land_sea="land","sea";

</pre><blockquote>
<p>
In any case, other coordinate variables may also implicitly restrict the portion of the cell considered by the statistical method. For example, the horizontal area of the ocean decreases with increasing depth. An area-mean as a function of depth in the ocean is therefore formed over different areas at different depths. This is not indicated explicitly in <tt>cell_methods</tt>. As described in Section 7.3.4 "Cell methods specified when there are no coordinates", a labeled axis of <tt>region</tt> may restrict the portion of a latitude-longitude gridbox to be considered.
</p>
</blockquote>
<blockquote>
<p>
If the <em>method</em> is <tt>mean</tt>, the <tt>cell_methods</tt> entry may take the form "<tt>mean where</tt> <em>type1</em> [<tt>over</tt> <em>type2</em>]", in which each of <em>type1</em> and <em>type2</em> can be either <tt>land</tt>, <tt>sea</tt>, <tt>sea_ice</tt>, <tt>open_sea</tt> or <tt>all</tt>, where <tt>all</tt> means the entire area of the cell, or the name of a string-valued auxiliary coordinate variable or string-valued scalar coordinate variable with <tt>standard_name</tt> of <tt>area_type</tt>. A <tt>cell_methods</tt> entry of the form "<tt>mean where</tt> <em>type1</em>" indicates the mean is calculated by summing over the <em>type1</em> portion of the cell and dividing by the area of this portion. A <tt>cell_methods</tt> entry of the form "<tt>mean where</tt> <em>type1</em> <tt>over</tt> <em>type2</em>" indicates the mean is calculated by summing over the <em>type1</em> portion of the cell and dividing by the area of the <em>type2</em> portion. A cell_methods entry of the form "<tt>mean where all over</tt> <em>type2</em>" indicates the mean is calculated by summing over the entire cell and dividing by the area of the <em>type2</em> portion.
</p>
</blockquote>
<blockquote>
<p>
Example. Thickness of sea-ice and snow on sea-ice averaged over sea area.
</p>
</blockquote>
<pre class="wiki">variables:
  float sea_ice_thickness(lat,lon);
    sea_ice_thickness:cell_methods="area: mean where sea_ice over sea";
    sea_ice_thickness:standard_name="sea_ice_thickness";
    sea_ice_thickness:units="m";
  float snow_thickness(lat,lon);
    snow_thickness:cell_methods="area: mean where sea_ice over sea";
    snow_thickness:standard_name="lwe_thickness_of_surface_snow_amount";
    snow_thickness:units="m";
</pre><blockquote>
<p>
In the case of sea-ice thickness, "<tt>where all</tt>" would have the same effect as "<tt>where sea_ice</tt>", since the integral over all area of sea-ice thickness is obviously the same as the integral over sea-ice area only. In the case of snow thickness, they differ because "<tt>where sea_ice</tt>" excludes snow on land from the average. Omitting the "<tt>over</tt>" phrase would mean that both quantities would be averages over the entire cell, not just the sea area.
</p>
</blockquote>
<ol start="9"><li>Replace the two bullets near the end of the current 7.3, in the newly numbered subsection 7.3.4, introduced by the paragraph beginning "The convention of specifying ...", with the following expanded text:
</li></ol><ul><li>If the cell coordinate range cannot be precisely defined. For example, the Levitus ocean climatology uses any data that exists. It is a time mean but the time range is not well defined, so cannot be stated. This could be indicated by a <tt>cell_methods</tt> entry of <tt>time: mean</tt>, where <tt>time</tt> appears as a <tt>standard_name</tt>, and there is no dimension or coordinate variable with this name. 
</li></ul><ul><li>For convenience, if the cell extends over all valid coordinates. This is permitted only for the standard names <tt>longitude</tt> and <tt>latitude</tt>, and for the word <tt>area</tt>, standing for the combination of longitude and latitude i.e. the horizontal coordinates. Methods specified for longitude and latitude are assumed to apply to the complete range of longitude and latitude respectively. Methods specified for <tt>area</tt> apply to the whole world. Note that these uses of <tt>cell_methods</tt> are allowed <em>only</em> if there are no coordinate or auxiliary coordinate variables of longitude, latitude or horizontal dimensions, respectively. If in addition the data variable has a dimension with a corresponding labeled axis that specifies a geographic region (Section 6.1.1, "Geographic Regions"), the implied range of longitude and latitude is the valid range for each specified region. For example, there could be a <tt>cell_methods</tt> entry of <tt>longitude: mean</tt>, where <tt>longitude</tt> appears as <tt>standard_name</tt> and is not the name of a dimension or coordinate variable. That would indicate a mean over all longitudes. But if in addition the data variable had a scalar coordinate variable with a <tt>standard_name</tt> of <tt>region</tt> and a value of <tt>atlantic_ocean</tt>, it would indicate a mean over longitudes that lie within the Atlantic Ocean, not all longitudes.
</li></ul><ol start="10"><li>Modify the first bullet of the section on 7.3 in the conformance document
</li></ol><p>
as follows:
</p>
<blockquote>
<p>
The type of the <tt>cell_methods</tt> attribute is a string whose value is one or more blank separated word lists, each with the form
</p>
</blockquote>
<blockquote>
<p>
dim1: [dim2: [dim3: ...] ] method [where type1 [over type2]] [within|over days|years] [(comment)]
</p>
</blockquote>
<blockquote>
<p>
where brackets indicate optional words. The valid values for <tt>dim1 [dim2 [dim3 ...] ]</tt> are the names of dimensions of the data variable, names of scalar coordinate variables of the data variable, valid standard names, or the word <tt>area</tt>. The valid values of <tt>method</tt> are contained in Appendix E. The valid values for <tt>type1</tt> and <tt>type2</tt> are <tt>land</tt>, <tt>sea</tt>, <tt>sea_ice</tt>, <tt>open_sea</tt>, <tt>all</tt> or the name of a string-valued auxiliary or scalar coordinate variable with a <tt>standard_name</tt> of <tt>area_type</tt>. When the method refers to a climatological time axis, the suffixes for <tt>within</tt> and <tt>over</tt> may be appended.
</p>
</blockquote>
<ol start="11"><li>Add a recommendation for section 7.3 in the conformance document as follows: "If a data variable has any dimensions or scalar coordinate variables referring to horizontal, vertical or time dimensions, it should have a <tt>cell_methods</tt> attribute with an entry for each of these spatiotemporal dimensions or scalar coordinate variables. (The horizontal dimensions may be covered by an <tt>area</tt> entry.)"
</li></ol>
    </div>

              </div>
              <div class="change" id="trac-change-16-1202115571000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:16" class="cnum">
    <a href="#comment:16">comment:16</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-02-04T00%3A59%3A31-08%3A00&amp;precision=second" title="See timeline at 02/04/08 00:59:31">13 years ago</a> by lowry
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Jonathan,
</p>
<p>
I have been using the term 'water column' in our vocabularies to identify any body of salt or fresh water.  The term 'hydrosphere' has been used for the same purpose elsewhere.  
</p>
<p>
I would welcome CF standard names embracing the concept of 'water column' under any label as it would firm up the mappings between the BODC vocabularies being used by <a class="missing wiki">SeaDataNet?</a> and CF (although it would weaken mappings between CF and GCMD who clearly differentiate between salt and fresh water). However, although using the word 'sea' for this concept would overcome legacy issues I worry about the potential for confusion.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-17-1202288454000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:17" class="cnum">
    <a href="#comment:17">comment:17</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:18" class="follow-up">↓ 18</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-02-06T01%3A00%3A54-08%3A00&amp;precision=second" title="See timeline at 02/06/08 01:00:54">13 years ago</a> by Heinke
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Jonathan,
</p>
<blockquote class="citation">
<p>
I would like to limit the number of "special" types
</p>
</blockquote>
<p>
I agree totally.
 
</p>
<blockquote class="citation">
<p>
(or do you want to distinguish glaciers from ice-sheets?).
</p>
</blockquote>
<p>
Yes, because we need it for the albedo.
</p>
<blockquote class="citation">
<blockquote>
<p>
In your example of soil respiration, do you mean that the respiration rate
</p>
</blockquote>
<p>
may be distinguished between areas of ground beneath the canopy, and areas
that can see the sky? In that case, I agree, we would need <tt>canopy</tt> as an
<tt>area_type</tt>.
</p>
</blockquote>
<p>
This is correct, they distinguished ground and canopy because the canopy 
changes in time and space.
</p>
<blockquote class="citation">
<p>
In principle all the same
quantities are needed for rivers and lakes as for sea, and it would ugly
to copy them all, I think, especially as the distinction may not always be
clear and could be inconvenient to draw among river, lake and sea. Can we
understand "sea" to include river and lake? I can't think of a word which
means "sea, river or lake"!
</p>
</blockquote>
<p>
I think we are at the beginning to model river and lake temperature....
I followed the discussion about hydrosphere. I like to discuss it with some people 
in my institute. May be we have an answer.
</p>
<blockquote>
<p>
Best wishes
</p>
</blockquote>
<blockquote>
<p>
Heinke
</p>
</blockquote>

    </div>

              </div>
              <div class="change" id="trac-change-18-1202290793000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:18" class="cnum">
    <a href="#comment:18">comment:18</a>
  </span>
        in reply to:
    <a href="#comment:17">↑ 17</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-02-06T01%3A39%3A53-08%3A00&amp;precision=second" title="See timeline at 02/06/08 01:39:53">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Heinke
</p>
<blockquote class="citation">
<blockquote class="citation">
<p>
(or do you want to distinguish glaciers from ice-sheets?).
</p>
</blockquote>
<p>
Yes, because we need it for the albedo.
</p>
</blockquote>
<p>
OK: we can have <tt>land_ice</tt>, <tt>glacier</tt>, <tt>ice_sheet</tt>.
 
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
In your example of soil respiration, do you mean that the respiration rate
</p>
</blockquote>
<p>
may be distinguished between areas of ground beneath the canopy, and areas
that can see the sky? In that case, I agree, we would need <tt>canopy</tt> as an
<tt>area_type</tt>.
</p>
</blockquote>
<p>
This is correct, they distinguished ground and canopy because the canopy 
changes in time and space.
</p>
</blockquote>
<p>
OK, we can include <tt>canopy</tt>. I suppose that "canopy" means that leaf area index is not zero - is that right? There is no canopy if there is grass alone. If grass is included too, there is no distinction between areas with vegetation and areas with canopy, and in that case we don't need both.
</p>
<p>
Cheers
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-19-1203669196000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:19" class="cnum">
    <a href="#comment:19">comment:19</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-02-22T00%3A33%3A16-08%3A00&amp;precision=second" title="See timeline at 02/22/08 00:33:16">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I would like to modify the proposal to use the phrase <tt>ice_free_sea</tt> instead of <tt>open_sea</tt> as the "opposite" of <tt>sea_ice</tt>, as I think it would be clearer.
</p>
<p>
We have discussed the issue of how to name "river", "lake" and "sea" together on the email list. This is not resolved. It's not a new issue and it does not affect the logic of the present proposal, so I would suggest that we stick to <tt>sea</tt> for this proposal, and deal with that problem subsequently.
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-20-1203672151000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:20" class="cnum">
    <a href="#comment:20">comment:20</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:21" class="follow-up">↓ 21</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-02-22T01%3A22%3A31-08%3A00&amp;precision=second" title="See timeline at 02/22/08 01:22:31">13 years ago</a> by Heinke
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Jonathan,
</p>
<blockquote class="citation">
<p>
OK, we can include <tt>canopy</tt>. I suppose that "canopy" means that leaf area
</p>
<blockquote>
<p>
index is not zero - is that right? There is no canopy if there is grass
alone. If grass is included too, there is no distinction between areas
with vegetation and areas with canopy, and in that case we don't need
both.
</p>
</blockquote>
</blockquote>
<p>
The model has different types of vegetation. One type is grass.
But for the model output they don't distinguish between grass and the other
types directly. Processes in the model need the different types.
Grass has leaves and are part of the leaf area index.
So, they can live with the term vegetation alone.
</p>
<p>
Cheers
Heinke
</p>

    </div>

              </div>
              <div class="change" id="trac-change-21-1203672966000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:21" class="cnum">
    <a href="#comment:21">comment:21</a>
  </span>
        in reply to:
    <a href="#comment:20">↑ 20</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-02-22T01%3A36%3A06-08%3A00&amp;precision=second" title="See timeline at 02/22/08 01:36:06">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Heinke
</p>
<blockquote class="citation">
<p>
Grass has leaves and are part of the leaf area index.
So, they can live with the term vegetation alone.
</p>
</blockquote>
<p>
OK, thanks for that clarification. However, we can revisit this if necessary. The values of <tt>area_type</tt> are a matter for discussion on the email list as part of a "controlled vocabulary", and don't affect the convention itself.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-22-1212710762000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:22" class="cnum">
    <a href="#comment:22">comment:22</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-05T17%3A06%3A02-07%3A00&amp;precision=second" title="See timeline at 06/05/08 17:06:02">13 years ago</a> by taylor13
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear all,
</p>
<p>
As moderator of this ticket (<a class="closed ticket" href="./17.html" title="enhancement: Remove ambiguity in cell_methods, especially means over subgrid areas (closed: fixed)">#17</a>) and with the intention of closing this ticket, I have finally studied all of the discussion that went on.  The official period for discussion expired long ago, and no strong objections were expressed concerning the final form of the proposal, summarized in Jonathan’s posting of 2/2/08.  I would like Jonathan to consider, however, responding to a few points before we actually adopt the proposal.  Also, I have taken the liberty of editing the text modifications suggested by Jonathan to improve clarity and readability (I hope).  At <a class="ext-link" href="http://cf-pcmdi.llnl.gov/trac/wiki"><span class="icon">​</span>http://cf-pcmdi.llnl.gov/trac/wiki</a> you can find the word document with the marked up text of section 7.3, first with Jonathan’s changes according to his 2/2/08 posting, and then in a different color, my editing .  [The editing was done with “track changes” turned on.  To download click on cell_methods.doc, and then click on "download the file".]  The word document addresses points 4-9 of Jonathan’s posting.  If you have editorial suggestions, please send them to me (or post them). 
</p>
<p>
Jonathan nicely incorporated most of the suggestions that came out of the CF discussion of this ticket.    I think the final proposal is therefore in very good shape.  I only think it would be good to reconsider the merits of Alison’s suggestion to allow use of all the standard values of area_type in the “second convention” discussed in the new section 7.3.3 (instead of restricting these to land, sea, sea_ice, or ice_free_sea).  Jonathan argued that he didn’t want to have to point to an external list from the CF standard document.   We expect the list to grow as new needs are identified, so I have some sympathy.  But I think having different lists apply for the first convention and the second convention complicates things and will more likely lead to user error in recording the information.  I therefore suggest that the current list of permissible values be extended to include: land, sea, sea_ice, ice_free_sea, cloud, clear_sky, vegetation, bare_ground, land_ice, and all.
   
There was discussion of adding at least three other area_type values: canopy, glacier, and ice_sheet.  If we later reach a consensus concerning the need for these, they could be added.  
</p>
<p>
Concerning the other modifications summarized in Jonathan’s 2/2/08 posting, there seems to be no objection.  
</p>
<p>
Best wishes,
Karl
</p>

    </div>

              </div>
              <div class="change" id="trac-change-23-1213011872000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:23" class="cnum">
    <a href="#comment:23">comment:23</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-09T04%3A44%3A32-07%3A00&amp;precision=second" title="See timeline at 06/09/08 04:44:32">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Karl
</p>
<p>
Thanks for reviewing the ticket and studying the proposal. For completeness I note that points 1-4 and 10-11 of my earlier posting should also be included in the changes to be made if this proposal is accepted. Point 2 modifies section 3.3 of the CF standard, point 4 modifies section 6.1, points 10 and 11 modify the conformance document, and points 1 and 3 modify the standard name table. Your word doc covers the other points 5-9, which all modify section 7.3. I have uploaded a modified version of your word doc to <a class="ext-link" href="http://cf-pcmdi.llnl.gov/trac/wiki"><span class="icon">​</span>http://cf-pcmdi.llnl.gov/trac/wiki</a>.
</p>
<p>
I am generally happy with your edits. I have reinstated a couple of bits you deleted, with comments; perhaps you could revisit these. In other places I have tried a different wording to meet the difficulties you pointed out.
</p>
<p>
I included the sentence about identification of horizontal coordinate variables in 7.3.1 because an application may wish to find out which ones they are. Normally cell_methods names the dimensions explicitly, but if cell_methods says "area", the application has to use other rules for identifying horizontal coordinate variables. I have reinstated the sentence you removed, but modified the text a bit more in an attempt to make the purpose of it more obvious. Is it any better?
</p>
<p>
I am still not happy about allowing a longer list for possible area-types in the shorthand convention. If we did that, it would lead to future debates about what should be added to that list. Such debates could be time-consuming and difficult to settle with no clear criterion, and also such a list requires modification of the convention document, which is a harder procedure. The list I proposed of land, sea, sea_ice and ice_free_sea reflects the phrases that are currently used in where-clauses in existing standard names which will be removed under the proposal. However, I see your point about possible confusion between the two conventions. My alternative proposal would be to allow *any* permitted value of the area_type standard name in the shorthand convention. It would not then be just for the commonest area-types, but could be used for any case where a single area-type was required. I am not entirely happy about this alternative because it amounts to including coordinate value information in cell_methods, where I don't think it is really appropriate, but I wonder what you think of it.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change">
                
  <h3 class="change">
    <span class="threading">
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-19T11%3A19%3A04-07%3A00&amp;precision=second" title="See timeline at 06/19/08 11:19:04">13 years ago</a> by taylor13
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-attachment">
      <strong class="trac-field-attachment">Attachment</strong>
        <a href="./attachments/cell_methods_june19.pdf"><em>cell_methods_june19.pdf</em></a><a href="./attachments/cell_methods_june19.pdf" title="Download" class="trac-rawlink">​</a>
          added
    </li>
  </ul>
    <div class="comment searchable">
      <p>
<a class="closed ticket" href="./17.html" title="enhancement: Remove ambiguity in cell_methods, especially means over subgrid areas (closed: fixed)">#17</a> cell_methods text changes (word format)
</p>

    </div>

              </div>
              <div class="change" id="trac-change-24-1213900596000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:24" class="cnum">
    <a href="#comment:24">comment:24</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-19T11%3A36%3A36-07%3A00&amp;precision=second" title="See timeline at 06/19/08 11:36:36">13 years ago</a> by taylor13
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Only Jonathan has responded to my last posting for ticket <a class="closed ticket" href="./17.html" title="enhancement: Remove ambiguity in cell_methods, especially means over subgrid areas (closed: fixed)">#17</a>, but I have been working to improve the wording in several places (with considerable help from Jonathan).  As this rewording hasn’t affected the substance of the proposed changes, I have not posted my correspondences with Jonathan.  The result of this work is available in the form of a marked-up word file, (also turned into a pdf file) at <a class="ext-link" href="http://cf-pcmdi.llnl.gov/trac/wiki"><span class="icon">​</span>http://cf-pcmdi.llnl.gov/trac/wiki</a>.  Changes relative to the current CF standard are shown.  Those highlighted in yellow are needed to implement this ticket.  The other changes are an attempt to improve wording or in a few cases correct obvious mistakes in the original text.  If there are no objections posted by July 10, the proposed changes will be accepted and this ticket will be closed.
</p>
<p>
There is one substantive change from the previous posted version -- namely that for the common case of data for a single area_type (e.g., surface temperature for land only), the proposal is to allow any of the valid area types be specified in the construction “name: method where type”, rather than limiting type to “land”, “sea”, “sea_ice”, or “ice_free_sea”, which was in the most recent version of the proposal.  Alison originally proposed this extension, and Jonathan and I are now convinced that this will make it less confusing for the data writers.  
</p>
<p>
Another somewhat important change is that I suggest that “all_area_types”, rather than “all”, should be used to indicate that all types of area have been included in the analysis.  The reason for replacing “all” with a more specific descriptor (i.e., “all_area_types”) is to anticipate that we might in the future want to extend the cell_methods convention to describe other types of partial cells [perhaps, e.g., geographic regions (like “where atlantic ocean”), or certain “flag” types (like “where quality_good”)] .    In these cases, we might also like to indicate “where all”, but this would be confusing if “all” could refer also to area_type.  To distinguish among potentially several different “where” constructs, I propose that we use “all_area_types” now (which will  allow us to distinguish it unambiguously from “all_regions” or “all_flags”, if we want to add options like these in the future).  This will make any future extensions less problematic.  [Jonathan’s views may differ on this.]
</p>
<p>
Finally, I would prefer that we carefully consider the initial list of valid values for the official types of area (like “land”, “sea”, “vegetation”, etc.).  These are not standard_names but a restricted list of strings that can be assigned to a variable identified by the standard_name, “area_type”.   Since new valid strings of this sort can be added through the standard name procedure (which isn’t too onerous), I suggest we be conservative and only initially approve here the following list: “land”, “sea”, “sea_ice”, “ice_free_sea”, land_ice, “snow”, “cloud”, “clear_sky”, “vegetation”, and “bare_ground”, and “all_area_types”.  This list omits “glacier”, “ice_sheet”, and “canopy”.  The distinction between glacier, ice_sheet, and land_ice seems pretty subtle.  This is just a conservative suggestion, which I don’t feel that strongly about.  In any case, it shouldn’t hold up the implementation of this ticket if there is disagreement.
</p>
<p>
For completeness, I note that points 1-4 and 10-11 of Jonathan’s earlier posting should also be included in the changes to be made if this proposal is accepted. Point 2 modifies section 3.3 of the CF standard, point 4 modifies section 6.1, points 10 and 11 modify the conformance document, and points 1 and 3 modify the standard name table.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-25-1213955894000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:25" class="cnum">
    <a href="#comment:25">comment:25</a>
  </span>
        in reply to:
    <a href="#comment:15">↑ 15</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-20T02%3A58%3A14-07%3A00&amp;precision=second" title="See timeline at 06/20/08 02:58:14">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear all
</p>
<p>
I am grateful to Karl for working on this proposal. I have posted a slightly altered version at <a class="ext-link" href="http://cf-pcmdi.llnl.gov/trac/wiki"><span class="icon">​</span>http://cf-pcmdi.llnl.gov/trac/wiki</a>, in which I have
</p>
<ul><li>corrected a typo.
</li><li>changed 7.3.4 so that it is not highlighted, except for the parts about the new <tt>area</tt> syntax, because that is the only substantive change to the subsection; the rest is a rewriting of the existing convention.
</li></ul><p>
In the pdf version (both Karl's and mine) some underscores in yellow parts are not evident, but they are there in the doc version.
</p>
<p>
I propose that if this change is adopted, only the highlighted parts should appear as provisional in the new edition of the CF conventions document. As Karl explains, the rest are not substantive changes. They could have been proposed in a separate ticket as a "defect" rather than an "enhancement", in which case they would take immediate effect, as they don't change the standard in effect.
</p>
<p>
Karl has proposed to omit <tt>glacier</tt> and <tt>ice_sheet</tt> from the initial list of <tt>area_type</tt> values. I included them at Heinke's request, and Heinke might comment. But I agree with Karl that we shouldn't hold up the implementation whether or not we include them, because they are a vocabulary change, not a change to the convention.
</p>
<p>
In the original proposal I had <tt>all</tt>, which Karl has changed to <tt>all_area_types</tt>. I still prefer <tt>all</tt> on grounds of simplicity. I think that if we decided the broaden the use of <tt>where</tt> later, we could rename <tt>all</tt> if necessary. However I am more concerned to have an agreement as soon as we can than to hold out over this detail!
</p>
<p>
Mostly for completeness and convenience, I repeat the rest of the changes below. The last two points below, on the changes to the conformance document, are different from the earlier versions, because of the changes to the proposal.
</p>
<p>
Cheers
</p>
<p>
Jonathan
</p>
<ol><li>Delete the existing standard names with where-phrases, making them aliases of names without the where-phrases:
</li></ol><pre class="wiki">precipitation_flux_onto_canopy_where_land
surface_net_downward_radiative_flux_where_land
surface_snow_thickness_where_sea_ice
surface_temperature_where_land
surface_temperature_where_open_sea
surface_temperature_where_snow
surface_upward_sensible_heat_flux_where_sea
water_evaporation_flux_from_canopy_where_land
water_evaporation_flux_where_sea_ice
</pre><p>
The standard name <tt>precipitation_flux_onto_canopy</tt> is an addition to the table. The others exist already.
</p>
<ol start="2"><li>In Section 3.3, add the following to the end of the paragraph which begins "The standard name table is located at":
</li></ol><blockquote>
<p>
Some standard names (e.g. <tt>region</tt> and <tt>area_type</tt>) are used to indicate quantities which are permitted to take only certain standard values. This is indicated in the definition of the quantity in the standard name table, accompanied by a list or a link to a list of the permitted values.
</p>
</blockquote>
<ol start="3"><li>Define a new <tt>standard_name</tt> of <tt>area_type</tt>, to indicate distinctions of horizontal area within cells. Make the existing standard names of <tt>land_cover</tt> and <tt>surface_type</tt> into aliases of <tt>area_type</tt>. Variables with <tt>standard_name</tt> of <tt>area_type</tt> must have one of the values listed in a special table. The initial list of values in that table is: <tt>land sea sea_ice ice_free_sea land_ice snow cloud clear_sky vegetation bare_ground all_area_types</tt>. Additions to this table will be requested on the CF email list.
</li></ol><ol start="4"><li>To provide for greater use of string-valued auxiliary coordinate variables, especially string-valued scalar coordinate variables:
</li></ol><ul><li>To the end of the first paragraph of 6.1, append: Other purposes for string identifiers are also described in Section 6.1.1, "Geographic Regions", and Section 7.3.3, "Statistics applying to portions of cells".
</li></ul><ul><li>To the end of the second paragraph of 6.1, append: If a character variable has only one dimension (the length of the string), it is regarded as a string-valued scalar coordinate variable, analogous to a numeric scalar coordinate variable (Section 5.7).
</li></ul><ul><li>Modify the section on 6.1 in the conformance document to read: A variable of character type that is named by a coordinates attribute is a label variable. This variable must have one or two dimensions. The trailing (CDL order) or sole dimension is for the maximum string length. If there are two dimensions, the leading dimension (CDL order) must match one of those of the data variable.
</li></ul><ol start="10"><li>Modify the first bullet of the section on 7.3 in the conformance document
</li></ol><p>
as follows:
</p>
<blockquote>
<p>
The type of the <tt>cell_methods</tt> attribute is a string whose value is one or more blank separated word lists, each with the form
</p>
</blockquote>
<blockquote>
<p>
dim1: [dim2: [dim3: ...] ] method [where type1 [over type2]] [within|over days|years] [(comment)]
</p>
</blockquote>
<blockquote>
<p>
where brackets indicate optional words. The valid values for <tt>dim1 [dim2 [dim3 ...] ]</tt> are the names of dimensions of the data variable, names of scalar coordinate variables of the data variable, valid standard names, or the word <tt>area</tt>. The valid values of <tt>method</tt> are contained in Appendix E. The valid values for <tt>type1</tt> are the name of a string-valued auxiliary or scalar coordinate variable with a <tt>standard_name</tt> of <tt>area_type</tt>, or any string value allowed for a variable of <tt>standard_name</tt> of <tt>area_type</tt>. If <tt>type2</tt> is a string-valued auxiliary coordinate variable, it is not allowed to have a leading dimension (the number of strings) of more than one. When the method refers to a climatological time axis, the suffixes for <tt>within</tt> and <tt>over</tt> may be appended.
</p>
</blockquote>
<ol start="11"><li>Add recommendations for section 7.3 in the conformance document as follows
</li></ol><blockquote>
<p>
If a data variable has any dimensions or scalar coordinate variables referring to horizontal, vertical or time dimensions, it should have a <tt>cell_methods</tt> attribute with an entry for each of these spatiotemporal dimensions or scalar coordinate variables. (The horizontal dimensions may be covered by an <tt>area</tt> entry.)
</p>
</blockquote>
<blockquote>
<p>
Except for entries whose cell method is <tt>point</tt>, all numeric coordinate variables and scalar coordinate variables named by <tt>cell_methods</tt> should have <tt>bounds</tt> or <tt>climatology</tt> attributes.
</p>
</blockquote>

    </div>

              </div>
              <div class="change" id="trac-change-26-1214238124000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:26" class="cnum">
    <a href="#comment:26">comment:26</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-23T09%3A22%3A04-07%3A00&amp;precision=second" title="See timeline at 06/23/08 09:22:04">13 years ago</a> by taylor13
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Thanks to Jonathan for proposing how to modify the "conformance" document to conform with the proposal.
</p>
<p>
Concerning the keyword "all" as opposed to "all_area_types".  Jonathan stated: "I think that if we decided t[o] broaden the use of "where" later, we could rename "all" if necessary."  I think this could only be done if we didn't want to use "all" for a more general purpose in the future.  For example, if we were to generalize "where" to support individual regions as well as area_types, then we might want to support both "all_regions" and "all_area_types, and then allow logical constructions like "all_area_types and all_regions".  It would be confusing to see "all and all_regions", and in fact one might want to designate "all = all_area_types and all_regions". This is why I prefer the more specific designation for "all_area_types". 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-27-1214290971000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:27" class="cnum">
    <a href="#comment:27">comment:27</a>
  </span>
          <span>follow-up:</span>
    <a href="#comment:28" class="follow-up">↓ 28</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-24T00%3A02%3A51-07%3A00&amp;precision=second" title="See timeline at 06/24/08 00:02:51">13 years ago</a> by Heinke
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Jonathan,
</p>
<blockquote class="citation">
<p>
 
</p>
<blockquote>
<p>
Karl has proposed to omit <tt>glacier</tt> and <tt>ice_sheet</tt> from the initial list
of <tt>area_type</tt> values. I included them at Heinke's request, and Heinke
might comment. But I agree with Karl that we shouldn't hold up the
implementation whether or not we include them, because they are a
vocabulary change, not a change to the convention.
</p>
</blockquote>
</blockquote>
<p>
I agree with.you. Let's discuss this later.
</p>
<p>
remarks to 7.3.3
</p>
<p>
should we use subheadings
</p>
<p>
name: method where type
</p>
<p>
name: method where type_var
</p>
<p>
area: mean where type1 [over type2]
</p>
<p>
Do we like to comment the situation e.g the portion of sea-ice is 0%.
The mean should not be '0'. We need a special value for this situation.
</p>
<p>
What do you think ?
</p>
<p>
Best regards
Heinke
</p>

    </div>

              </div>
              <div class="change" id="trac-change-28-1214342312000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:28" class="cnum">
    <a href="#comment:28">comment:28</a>
  </span>
        in reply to:
    <a href="#comment:27">↑ 27</a>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-24T14%3A18%3A32-07%3A00&amp;precision=second" title="See timeline at 06/24/08 14:18:32">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Heinke
</p>
<blockquote class="citation">
<p>
should we use subheadings [in 7.3.3]
</p>
</blockquote>
<p>
I find it clear enough without subheadings myself. I don't think that we use fourth level headings elsewhere.
</p>
<blockquote class="citation">
<p>
Do we like to comment the situation e.g the portion of sea-ice is 0%.
The mean should not be '0'. We need a special value for this situation.
</p>
</blockquote>
<p>
I agree the mean might not be meaningful in such a situation, but I would suggest that this is not necessarily a problem. You can imagine situations where this could happen. Suppose, for instance, that a land-surface model has a variable (area_type,lat,lon) which specifies some property of the surface e.g. albedo, or a vegetation parameter, for different area types as a function of geographical position, in a model with interactive vegetation. In such a model at any given time some of the possible area_types might actually have zero area in a given gridbox, but it is still meaningful to define what properties they would have if present.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>
<blockquote class="citation">
<p>
What do you think ?
</p>
<p>
Best regards
Heinke
</p>
</blockquote>

    </div>

              </div>
              <div class="change" id="trac-change-29-1214356792000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:29" class="cnum">
    <a href="#comment:29">comment:29</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-24T18%3A19%3A52-07%3A00&amp;precision=second" title="See timeline at 06/24/08 18:19:52">13 years ago</a> by taylor13
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I agree with Jonathan that sometimes even though some quantity might never be associated with a certain surface type, it still might be appropriate to set the quantity to 0.0 over that surface.
</p>
<p>
For example, for the CMIP3 archive, we advised the modeling groups that:
soil_moisture_content might be either set to 0.0 or flagged as "unavailable" (i.e., missing) over grid cells with ocean.    Either of these would accurately reflect the situation.  Similarly, we suggested that surface_snow_thickness should be set to 0. in the absence of any snow, regardless of surface type (even though snow depth could never by non-zero over ice-free ocean.)
</p>
<p>
In contrast, one might require that soil_temperature be flagged as "unavailable" (i.e., missing) over oceans (rather than setting it to 0.0), since soil_temperature cannot be defined in a region where there is no soil.
</p>

    </div>

              </div>
              <div class="change" id="trac-change-30-1214383622000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:30" class="cnum">
    <a href="#comment:30">comment:30</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-25T01%3A47%3A02-07%3A00&amp;precision=second" title="See timeline at 06/25/08 01:47:02">13 years ago</a> by Heinke
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Sorry, I think that my sea-ice example was not so clear.
How can we distinguish between 'real' mean '0' for example for
eastward_sea_water_velocity (values are negative and positiv) and
the value is unavailable and set to '0'.
This is not a problem for exclusive positiv values (e.g. surface_snow_thickness).
For further statistics (global mean ...) this must be distinguishable.
Our modeller are aware of this problem, but should we accomplish
this in our description.
May be this is to mathematical for the documentation. I only want to
discuss this problem.
</p>
<p>
Best regards
Heinke
</p>

    </div>

              </div>
              <div class="change" id="trac-change-31-1214413480000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:31" class="cnum">
    <a href="#comment:31">comment:31</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-25T10%3A04%3A40-07%3A00&amp;precision=second" title="See timeline at 06/25/08 10:04:40">13 years ago</a> by taylor13
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Yes, this is potentially confusing.  eastward_sea_water_velocity is somewhat similar to my example of soil_temperature.  Sea_water velocity cannot be defined for cells without any sea, so I would recommend it be flagged as "missing".  Nevertheless, if one had the land-sea mask available for the model, then the mask could be used to eliminate land values no matter what value was assigned to them before computing, say, a global mean. 
</p>
<p>
I'm not sure we should legislate it, but I would hope that where a variable is undefined (because the area type it refers to is missing), then it should be identified as "missing" (rather than storing a 0.)
</p>

    </div>

              </div>
              <div class="change" id="trac-change-32-1214826776000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:32" class="cnum">
    <a href="#comment:32">comment:32</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-30T04%3A52%3A56-07%3A00&amp;precision=second" title="See timeline at 06/30/08 04:52:56">13 years ago</a> by apamment
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Jonathan, Karl and Heinke
</p>
<p>
I have finally caught up with the discussion of this ticket and I'd like to add a few further comments.  I think the expanded text of section 7.3 goes a long way towards improving the clarity and understandability of this part of the conventions.  Also, I welcome the proposal to introduce a  standardized list of area_types.  This is something that has been raised in standard names discussions in the past and I think there is a definite need for it.  I tend to agree with Karl's proposal to use the "all_area_types" string rather than simply "all".  I think that changing the meaning of "all" at a later date may give rise to a lot of confusion.
</p>
<p>
I have some specific comments on Jonathan's latest version of the document at <a class="ext-link" href="http://cf-pcmdi.llnl.gov/trac/wiki"><span class="icon">​</span>http://cf-pcmdi.llnl.gov/trac/wiki</a>.
</p>
<p>
1) Example 7.4.  It is proposed to add a new paragraph immediately before example 7.4 which recommends that cell_methods be specified explicitly, even where the default interpretation applies.  However, in the example the p and precip variables use the default cell_methods without stating them.  Do you think that the example should be updated to reflect the new recommendation?
</p>
<p>
2) Subsection 7.3.2, paragraph 2.  In the new subsection 7.3.1 it is proposed that the new name of "area" be introduced as the recommended way of indicating variation over a combination of horizontal axes.  Indeed it was my suggestion to make it a recommendation, but I am now wondering if this is the best thing to do.  In 7.3.2 para 2 the text goes on to say that original intervals, say in lon and lat, can be matched to the relevant axes by position.  However, I think that's no longer possible using the "area" name.  I suggest that this needs some clarification, for example, perhaps "area" should be the recommended name <em>except</em> when intervals need to be specified.  Alternatively, we could drop the recommendation to use "area" and go back to Jonathan's original proposal which introduced it as a convenient, optional shorthand.
</p>
<p>
3) Subsection 7.3.2, paragraph 3.  The first sentence says "... the non-standardized follows the standardized information <em>and</em> the keyword comment:&#34; but the examples in the next sentence seem to imply that &#34;comment:" only needs to be included when standardized information is present.  Perhaps the text should point this out a bit more explicitly.
</p>
<p>
4) Subsection 7.3.3, paragraphs  2, 3 and 4.  As already mentioned, I like the proposal to standardize the area_type strings.
</p>
<p>
Paragraph 2, sentence 2, says that "type" <em>may</em> be any of the strings permitted in a variable with standard name of area_type.  Does this imply that "type" may also take other values and, if so, what are they?
</p>
<p>
I can't help wondering if there is really a need to state the main thrust of this proposal as two separate conventions.  I think they could be drawn together into a single convention, albeit with a special case for area means.  The cell_methods string for <strong>all</strong> methods could be written as: "name: <em>method</em> where <em>type</em>" and <em>type</em> would be either (a) a standardized area_type string or (b) an auxiliary coordinate variable or scalar coordinate variable with the standard_name of area_type.  If and only if the method is "mean" and if and only if the mean is calculated using a different portion of the grid cell in the numerator and denominator the cell_methods syntax would be: "'mean where <em>type1</em> over <em>type2</em>" where, again, <em>type1</em> and <em>type 2</em> are either a standardized string or a variable with standard_name of area_type.  I realize that to state the convention in this way might require some re-ordering of the text and examples, but to me it seems to be a clearer and more concise description of the proposal.
</p>
<p>
Best wishes<br />
Alison
</p>

    </div>

              </div>
              <div class="change" id="trac-change-33-1214872340000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:33" class="cnum">
    <a href="#comment:33">comment:33</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-06-30T17%3A32%3A20-07%3A00&amp;precision=second" title="See timeline at 06/30/08 17:32:20">13 years ago</a> by taylor13
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Alison,
</p>
<p>
Thanks for your careful reading and comments concerning the proposed document.  I respond to your enumerated points below:
</p>
<ol><li> I like this suggestion (to modify the example to reflect the recommendation).
</li></ol><ol start="2"><li> I think a user will not be unduly influenced by our recommendation if he really wanted to specify the interval.  So I'm not sure it is necessary to explicitly include the exception you point out.
</li></ol><ol start="3"><li> Following your suggestion, I would propose that this paragraph be modified to read:
</li></ol><p>
"Non-standardized information can also be included within parentheses.  For instance, an area-weighted mean over latitude could be indicated as lat: mean (area weighted).  If there is both standardized and non-standardized information, the non-standardized information is immediately preceded by the keyword comment:, which should follow the standardized information.  For instance, to indicate both the sampling interval and the weighting method, a mean over latitude is indicated as lat: mean (interval: 1 degree_north comment: area-weighted)."
</p>
<ol start="4"><li>The proposal is that "type" must be one of the strings permitted for area_type.  To make this clear, I propose to revise the sentence to read:
</li></ol><p>
"Here name could, for example, be area, and type must be one of the strings permitted in a variable with a standard_name of area_type."
</p>
<p>
Concerning the possibility of combining the two conventions into one, why don't you wait until we hear from at least Jonathan, but I think there is some merit in your suggestion.  Of course the actual text would have be written before deciding whether or not it simplified things.
</p>
<p>
As an alternative toward possible simplification, I have recently thought about whether or not we shouldn't treat "area_type" more like "region".  That is, currently a cell method  for area is assumed to apply to the entire cell unless an auxiliary coordinate variable (or a scalar coordinate variable) with standard_name "region" has been defined, in which case the cell method applies to only that specified region.  Note that in this case the cell_method does not explicitly indicate the "region" subdomain.  Without much complication, we could generalize the present convention to apply to area_types.  Thus, an auxiliary coordinate variable (or a scalar coordinate variable) with standard_name of "area_type" could also limit the domain to which the cell_method is applied (without noting that fact in the cell_method).  This would completely duplicate the purpose of the "second convention" (which we would therefore not bother with).  Concerning the "first convention", we could also choose to eliminate it as an option, again for consistency with the treatment of "region".  A difficulty with this idea is that the information about the cell method might be less obvious to a human.  But I don't think "area_type" and "region" are fundamentally different concepts, so why should they be treated so differently under the conventions?
</p>
<p>
Even if we unified the treatment of "region" and "area_type" in this way, we would still have to find a way to treat the case of "mean where type1 over type2". One idea would be simplifying the construction by omitting "where type1", since this could be specified through the coordinates attribute , as described in the previous paragraph.  We could require that type2 be any one of the strings allowed for area_type.  [There would be no advanatage to allowing type2 to be alternatively specified by an auxiliary coordinate variable or a scalar coordinate because it cannot be dimensioned greater than one.] The specification of "mean over type2" (for a horizontal area) would indicate that the mean is calculated by summing the quantity (weighted by area) over the portion of the cell determined by the cell_bounds and possibly also by coordinates attributes (that specify a "region" and/or an "area_type"), and then dividing by the area of the type2 portion of the cell.
</p>
<p>
Best regards,
Karl
</p>
<p>
 
</p>

    </div>

              </div>
              <div class="change" id="trac-change-34-1214914665000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:34" class="cnum">
    <a href="#comment:34">comment:34</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-07-01T05%3A17%3A45-07%3A00&amp;precision=second" title="See timeline at 07/01/08 05:17:45">13 years ago</a> by apamment
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Karl
</p>
<p>
I hadn't noticed the parallel between region and area_type until you pointed it out, but I can see the logic of your argument.  However, I also agree with your comment that the information may be less obvious to a human reader if it is moved away from the cell_methods attribute.  In particular, I am worried that splitting the 'mean where type1 over type2' information between cell_methods and a coordinate variable makes it less clear what is going on.
</p>
<p>
Having said that, I think that both your suggestion of using coordinate variables and Jonathan's original proposal to use cell_methods would work, so I could live with either.
</p>
<p>
Best wishes
</p>
<p>
Alison
</p>

    </div>

              </div>
              <div class="change" id="trac-change-35-1215020539000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:35" class="cnum">
    <a href="#comment:35">comment:35</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-07-02T10%3A42%3A19-07%3A00&amp;precision=second" title="See timeline at 07/02/08 10:42:19">13 years ago</a> by jonathan
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Dear Alison and Karl
</p>
<ol><li>I have modified the example as suggested.
</li></ol><ol start="2"><li>I would prefer to follow Karl's recommendation and not change this part. It is problematic as it stands. For instance, what if you had a combination of axes but wanted to specify the original intervals of only some of them? The existing convention is unsatisfactory and if someone has time they could propose how to tidy it up, but these problems are not caused by the present proposal, so I think that should be done in a separate ticket.
</li></ol><ol start="3"><li>Following Alison's suggestion, I have explicitly indicated that <tt>comment:</tt> should be omitted (that is what we say in the conformance document) if there is no standardised information. I note that this point too is a clarification, but not related to the purpose of the present proposal.
</li></ol><ol start="4"><li>I agree that the two conventions could be described at once, as different versions of the same thing for different purposes and with different restrictions. However, I don't think that would be clearer for the reader. I tend to feel that it is clearer to spell out the two distinct situations. They are only one paragraph each, so it is easy to see them together on the screen, and notice that are analogous.
</li></ol><p>
I have uploaded a new version to <a class="ext-link" href="http://cf-pcmdi.llnl.gov/trac/wiki"><span class="icon">​</span>http://cf-pcmdi.llnl.gov/trac/wiki</a>.
</p>
<p>
I agree that we could describe dependence on <tt>area_type</tt> purely by means of coordinate variables. In some ways it is analogous to the restriction of the domain imposed by any other coordinate information. However I think that the use of <tt>where</tt> in <tt>cell_methods</tt> is a good idea because
</p>
<ul><li>It draws the user's attention to this very important information.
</li></ul><ul><li>The first convention (naming the area type in <tt>cell_methods</tt>) is a significant convenience (not needing a coordinate variable), and the analogy between the first and second conventions is attractive (as discussed above).
</li></ul><ul><li>It puts <tt>where</tt> and <tt>over</tt> together, which I think is valuable, because there is much scope for confusion about the definition of means.
</li></ul><p>
Hence I would like to leave it as it is. Changing now to removing <tt>where</tt> would be a substantially different proposal from the one we have been discussing all these months. I agree there is some analogy with <tt>region</tt>. If they are to be made more similar, I would prefer to put <tt>region</tt> in <tt>cell_methods</tt> too, as Karl has suggested. It would be useful to draw the user's attention to that as well. They are not entirely analogous, however, because
</p>
<ul><li><tt>region</tt> can be used without any other horizontal coordinate information, while <tt>area_type</tt> specifies subsets of horizontal domains that must be indicated in some other way.
</li></ul><ul><li><tt>region</tt> can be larger or smaller than horizontal gridcells, whereas <tt>area_type</tt> always refers to a variation within horizontal gridcells.
</li></ul><p>
This proposal is not about <tt>region</tt>, however, so please could we leave that to another ticket.
</p>
<p>
Best wishes
</p>
<p>
Jonathan
</p>

    </div>

              </div>
              <div class="change" id="trac-change-36-1224625998000000">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:36" class="cnum">
    <a href="#comment:36">comment:36</a>
  </span>
    </span>
        Changed <a class="timeline" href="/trac/timeline?from=2008-10-21T14%3A53%3A18-07%3A00&amp;precision=second" title="See timeline at 10/21/08 14:53:18">13 years ago</a> by taylor13
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-resolution">
      <strong class="trac-field-resolution">Resolution</strong>
        set to <em>fixed</em>
    </li><li class="trac-field-status">
      <strong class="trac-field-status">Status</strong>
        changed from <em>new</em> to <em>closed</em>
    </li>
  </ul>
    <div class="comment searchable">
      <p>
Dear all,
</p>
<p>
There has been no further discussion on this ticket for several months, so I declare it closed.  Velimir, please could you make the changes required? There are changes in in the standard document (to be marked as provisional) and the conformance document; the version number should be incremented.  The changes to section 7.3 of the standards document can be copied from the latest document (July 2) accessible from:
</p>
<p>
<a class="ext-link" href="http://cf-pcmdi.llnl.gov/trac/wiki"><span class="icon">​</span>http://cf-pcmdi.llnl.gov/trac/wiki</a>.
</p>
<p>
Download the .doc (not the .pdf) because some of the highlighting got lost in translation.
</p>
<p>
Only the highlighted parts should appear as provisional in the new edition of the CF coventions document; the rest are corrections of defects.
</p>
<p>
Other changes that need to be made are [note: items 10 &amp; 11 are changes that need to be made to the conformance document]:
</p>
<ol><li>Delete the existing standard names with where-phrases, making them aliases of names without the where-phrases:
</li></ol><p>
precipitation_flux_onto_canopy_where_land
surface_net_downward_radiative_flux_where_land
surface_snow_thickness_where_sea_ice
surface_temperature_where_land
surface_temperature_where_open_sea
surface_temperature_where_snow
surface_upward_sensible_heat_flux_where_sea
water_evaporation_flux_from_canopy_where_land
water_evaporation_flux_where_sea_ice
</p>
<p>
The standard name precipitation_flux_onto_canopy is an addition to the table. The others exist already.
</p>
<ol start="2"><li>In Section 3.3, add the following to the end of the paragraph which begins "The standard name table is located at":
</li></ol><blockquote>
<p>
Some standard names (e.g. region and area_type) are used to indicate quantities which are permitted to take only certain standard values. This is indicated in the definition of the quantity in the standard name table, accompanied by a list or a link to a list of the permitted values.
</p>
</blockquote>
<ol start="3"><li>Define a new standard_name of area_type, to indicate distinctions of horizontal area within cells. Make the existing standard names of land_cover and surface_type into aliases of area_type. Variables with standard_name of area_type must have one of the values listed in a special table. The initial list of values in that table is: land sea sea_ice ice_free_sea land_ice snow cloud clear_sky vegetation bare_ground all_area_types. Additions to this table will be requested on the CF email list.
</li></ol><ol start="4"><li>To provide for greater use of string-valued auxiliary coordinate variables, especially string-valued scalar coordinate variables:
</li></ol><ul><li>To the end of the first paragraph of 6.1, append: Other purposes for string identifiers are also described in Section 6.1.1, "Geographic Regions", and Section 7.3.3, "Statistics applying to portions of cells". 
</li></ul><ul><li>To the end of the second paragraph of 6.1, append: If a character variable has only one dimension (the length of the string), it is regarded as a string-valued scalar coordinate variable, analogous to a numeric scalar coordinate variable (Section 5.7). 
</li></ul><ul><li>Modify the section on 6.1 in the conformance document to read: A variable of character type that is named by a coordinates attribute is a label variable. This variable must have one or two dimensions. The trailing (CDL order) or sole dimension is for the maximum string length. If there are two dimensions, the leading dimension (CDL order) must match one of those of the data variable. 
</li></ul><ol start="10"><li>Modify the first bullet of the section on 7.3 in the conformance document as follows:
</li></ol><blockquote>
<p>
The type of the cell_methods attribute is a string whose value is one or more blank separated word lists, each with the form
</p>
</blockquote>
<blockquote>
<p>
dim1: [dim2: [dim3: ...] ] method [where type1 [over type2]] [within|over days|years] [(comment)]
</p>
</blockquote>
<blockquote>
<p>
where brackets indicate optional words. The valid values for dim1 [dim2 [dim3 ...] ] are the names of dimensions of the data variable, names of scalar coordinate variables of the data variable, valid standard names, or the word area. The valid values of method are contained in Appendix E. The valid values for type1 are the name of a string-valued auxiliary or scalar coordinate variable with a standard_name of area_type, or any string value allowed for a variable of standard_name of area_type. If type2 is a string-valued auxiliary coordinate variable, it is not allowed to have a leading dimension (the number of strings) of more than one. When the method refers to a climatological time axis, the suffixes for within and over may be appended.
</p>
</blockquote>
<ol start="11"><li>Add recommendations for section 7.3 in the conformance document as follows
</li></ol><blockquote>
<p>
If a data variable has any dimensions or scalar coordinate variables referring to horizontal, vertical or time dimensions, it should have a cell_methods attribute with an entry for each of these spatiotemporal dimensions or scalar coordinate variables. (The horizontal dimensions may be covered by an area entry.)
</p>
</blockquote>
<blockquote>
<p>
Except for entries whose cell method is point, all numeric coordinate variables and scalar coordinate variables named by cell_methods should have bounds or climatology attributes.
</p>
</blockquote>
<p>
That's it!
</p>
<blockquote>
<p>
Thanks to all concerned for your work on this one. 
</p>
</blockquote>
<p>
Karl
</p>

    </div>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="/trac/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="./17?format=rss" class="rss">RSS Feed</a>
        </li><li>
          <a rel="nofollow" href="./17?format=csv" class="csv">Comma-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="./17?format=tab" class="tab">Tab-delimited Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="https://trac.edgewall.org/"><img src="/trac/chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="/trac/about"><strong>Trac 1.0.20</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the CF Metadata home page at<br /><a href="http://cf-convention.github.io">http://cf-convention.github.io</a><br><font color="#0000ff" size="3"><b>The CF Metadata Trac issue tracker is read-only and will soon be shut down permanently</b></font></p>
    </div>
  </body>
</html>
